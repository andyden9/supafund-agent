(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(78200)}])},96369:function(e,t,n){"use strict";n.d(t,{Kt:function(){return s},go:function(){return a},v$:function(){return i},vj:function(){return l}});var r=n(14146);let a={color:r.r.TEXT_LIGHT},s={color:r.r.WARNING},i={color:r.r.SUCCESS},l={color:r.r.RED}},92209:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n(67294),a=n(61320);let s=()=>{let e=(0,r.useContext)(a.A);if(!e)throw Error("useOnRampContext must be used within OnRampProvider");return e}},78200:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return uq}});var r,a,s,i,l,o,d,c,u=n(85893),p=n(67294),h=n(14007),m=n(25305),x=n(2516),g=n(70020),f=n(85551),y=n(25675),v=n.n(y),j=n(24095),b=n(73020),w=n(45451),S=n(393),k=n(75982),T=n(75009),C=n(64055),Z=n(82220),E=n(21804),N=n.n(E),P=n(14146),I=n(85544),M=n(16327);let{Text:_}=m.default,A=e=>{let{chainName:t}=e;return(0,u.jsxs)(x.Z,{gap:8,align:"center",children:[(0,u.jsx)(v(),{src:"/chains/".concat(N()((0,I.KP)(t).name),"-chain.png"),width:20,height:20,alt:"chain logo"}),(0,u.jsx)(_,{children:(0,I.KP)(t).displayName})]})},L=()=>(0,u.jsx)(Z.Z.Item,{children:(0,u.jsxs)(x.Z,{justify:"space-between",className:"w-full",children:[(0,u.jsx)(_,{type:"secondary",children:"Transferring"}),(0,u.jsx)(_,{type:"secondary",children:"Receiving"})]})}),F=e=>{let{transfer:t}=e,{fromAmount:n,fromSymbol:r,toSymbol:a,toAmount:s,decimals:i}=t;return(0,u.jsx)(Z.Z.Item,{children:(0,u.jsxs)(x.Z,{justify:"space-between",className:"w-full",children:[(0,u.jsxs)(_,{children:[(0,M.Bs)(n,i,5)," ",r]}),(0,u.jsxs)(_,{children:[(0,M.Bs)(s,i,5)," ",a]})]})})},O=e=>{let{fromChain:t,toChain:n,transfers:r}=e;return(0,u.jsx)(Z.Z,{dataSource:r,header:(0,u.jsxs)(x.Z,{gap:16,align:"center",className:"w-full",children:[(0,u.jsx)(A,{chainName:t}),(0,u.jsx)(C.Z,{style:{fontSize:14,color:P.r.TEXT_LIGHT}}),(0,u.jsx)(A,{chainName:n})]}),renderItem:(e,t)=>(0,u.jsxs)(u.Fragment,{children:[0===t&&(0,u.jsx)(L,{}),(0,u.jsx)(F,{transfer:e})]}),bordered:!0,size:"small"})};var R=n(23560),D=n.n(R);let B=e=>{let{title:t,backButtonCallback:n}=e;return(0,u.jsxs)(x.Z,{justify:"start",align:"center",gap:12,children:[D()(n)&&(0,u.jsx)(f.ZP,{onClick:n,icon:(0,u.jsx)(h.Z,{})}),(0,u.jsx)(m.default.Title,{className:"m-0",level:4,children:t})]})};var z=n(69156);let W=()=>{let{goto:e}=(0,S.a)();return(0,u.jsx)(f.ZP,{size:"large",icon:(0,u.jsx)(z.Z,{}),onClick:()=>e(b.i.Main)})};var H=n(82729),q=n(23721),U=n(41686);function Y(){let e=(0,H._)(["\n  ","\n\n  .ant-card-body {\n    ","\n  }\n"]);return Y=function(){return e},e}let G=(0,U.ZP)(q.Z).withConfig({shouldForwardProp:e=>!["gap","noBodyPadding","noBorder"].includes(e)})(Y(),e=>!!(e.noBorder||e.$noBorder)&&"border: none;",e=>{let{gap:t,$gap:n,noBodyPadding:r,$noBodyPadding:a}=e,s=t||n,i="true"===r||a?"padding: 0;":e.$padding&&"padding: ".concat(e.$padding,";")||"";return"\n        display: flex; \n        flex-direction: column; \n        ".concat(s?"gap: ".concat(s,"px;"):""," \n        ").concat(i,"\n      ")}),Q=e=>{let{fromChain:t,toChain:n,transfers:r,completionMessage:a}=e,{goto:s}=(0,S.a)();return(0,u.jsx)(G,{bordered:!1,title:(0,u.jsx)(B,{title:"Bridge Completed"}),extra:(0,u.jsx)(W,{}),children:(0,u.jsx)(T.ZP,{status:"success",subTitle:a||"Funds have been bridged successfully.",extra:[(0,u.jsxs)(x.Z,{gap:24,vertical:!0,style:{paddingTop:8},children:[(0,u.jsx)(O,{fromChain:t,toChain:n,transfers:r}),(0,u.jsx)(f.ZP,{onClick:()=>s(b.i.ManageWallet),size:"large",style:{alignSelf:"center"},children:"See wallet balance"})]},"bridge-completed")],style:{padding:"24px 0"}})})};var $=n(60141),K=n(84443),X=n(81125),V=n(56732);let J={primary:(0,u.jsx)($.Z,{}),info:(0,u.jsx)($.Z,{}),warning:(0,u.jsx)(K.Z,{}),error:(0,u.jsx)(X.Z,{})},ee=e=>{let{type:t,fullWidth:n,className:r,...a}=e;return(0,u.jsx)(V.Z,{type:"primary"===t?void 0:t,className:"custom-alert custom-alert--".concat(t," ").concat(n?"custom-alert--full-width":""," ").concat(r),icon:a.showIcon?J[t]:void 0,...a})};var et=n(72034),en=n(51447),er=n(42086),ea=n(26026),es=n(42083),ei=n(62051),el=n(93473),eo=n(74166),ed=n(88144),ec=n(77294),eu=n(75104),ep=n(41609),eh=n.n(ep),em=n(14293),ex=n.n(em);let eg=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"}],name:"AddedOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"approvedHash",type:"bytes32"},{indexed:!0,internalType:"address",name:"owner",type:"address"}],name:"ApproveHash",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"handler",type:"address"}],name:"ChangedFallbackHandler",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"guard",type:"address"}],name:"ChangedGuard",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"threshold",type:"uint256"}],name:"ChangedThreshold",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"module",type:"address"}],name:"DisabledModule",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"module",type:"address"}],name:"EnabledModule",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"txHash",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"payment",type:"uint256"}],name:"ExecutionFailure",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"module",type:"address"}],name:"ExecutionFromModuleFailure",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"module",type:"address"}],name:"ExecutionFromModuleSuccess",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"txHash",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"payment",type:"uint256"}],name:"ExecutionSuccess",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"}],name:"RemovedOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"SafeReceived",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"initiator",type:"address"},{indexed:!1,internalType:"address[]",name:"owners",type:"address[]"},{indexed:!1,internalType:"uint256",name:"threshold",type:"uint256"},{indexed:!1,internalType:"address",name:"initializer",type:"address"},{indexed:!1,internalType:"address",name:"fallbackHandler",type:"address"}],name:"SafeSetup",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"msgHash",type:"bytes32"}],name:"SignMsg",type:"event"},{stateMutability:"nonpayable",type:"fallback"},{inputs:[],name:"VERSION",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"_threshold",type:"uint256"}],name:"addOwnerWithThreshold",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"hashToApprove",type:"bytes32"}],name:"approveHash",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"bytes32",name:"",type:"bytes32"}],name:"approvedHashes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_threshold",type:"uint256"}],name:"changeThreshold",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"dataHash",type:"bytes32"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"bytes",name:"signatures",type:"bytes"},{internalType:"uint256",name:"requiredSignatures",type:"uint256"}],name:"checkNSignatures",outputs:[],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"dataHash",type:"bytes32"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"bytes",name:"signatures",type:"bytes"}],name:"checkSignatures",outputs:[],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"prevModule",type:"address"},{internalType:"address",name:"module",type:"address"}],name:"disableModule",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"domainSeparator",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"module",type:"address"}],name:"enableModule",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"enum Enum.Operation",name:"operation",type:"uint8"},{internalType:"uint256",name:"safeTxGas",type:"uint256"},{internalType:"uint256",name:"baseGas",type:"uint256"},{internalType:"uint256",name:"gasPrice",type:"uint256"},{internalType:"address",name:"gasToken",type:"address"},{internalType:"address",name:"refundReceiver",type:"address"},{internalType:"uint256",name:"_nonce",type:"uint256"}],name:"encodeTransactionData",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"enum Enum.Operation",name:"operation",type:"uint8"},{internalType:"uint256",name:"safeTxGas",type:"uint256"},{internalType:"uint256",name:"baseGas",type:"uint256"},{internalType:"uint256",name:"gasPrice",type:"uint256"},{internalType:"address",name:"gasToken",type:"address"},{internalType:"address payable",name:"refundReceiver",type:"address"},{internalType:"bytes",name:"signatures",type:"bytes"}],name:"execTransaction",outputs:[{internalType:"bool",name:"success",type:"bool"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"enum Enum.Operation",name:"operation",type:"uint8"}],name:"execTransactionFromModule",outputs:[{internalType:"bool",name:"success",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"enum Enum.Operation",name:"operation",type:"uint8"}],name:"execTransactionFromModuleReturnData",outputs:[{internalType:"bool",name:"success",type:"bool"},{internalType:"bytes",name:"returnData",type:"bytes"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getChainId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"start",type:"address"},{internalType:"uint256",name:"pageSize",type:"uint256"}],name:"getModulesPaginated",outputs:[{internalType:"address[]",name:"array",type:"address[]"},{internalType:"address",name:"next",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getOwners",outputs:[{internalType:"address[]",name:"",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"offset",type:"uint256"},{internalType:"uint256",name:"length",type:"uint256"}],name:"getStorageAt",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[],name:"getThreshold",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"enum Enum.Operation",name:"operation",type:"uint8"},{internalType:"uint256",name:"safeTxGas",type:"uint256"},{internalType:"uint256",name:"baseGas",type:"uint256"},{internalType:"uint256",name:"gasPrice",type:"uint256"},{internalType:"address",name:"gasToken",type:"address"},{internalType:"address",name:"refundReceiver",type:"address"},{internalType:"uint256",name:"_nonce",type:"uint256"}],name:"getTransactionHash",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"module",type:"address"}],name:"isModuleEnabled",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"isOwner",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"nonce",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"prevOwner",type:"address"},{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"_threshold",type:"uint256"}],name:"removeOwner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"enum Enum.Operation",name:"operation",type:"uint8"}],name:"requiredTxGas",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"handler",type:"address"}],name:"setFallbackHandler",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"guard",type:"address"}],name:"setGuard",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"_owners",type:"address[]"},{internalType:"uint256",name:"_threshold",type:"uint256"},{internalType:"address",name:"to",type:"address"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"address",name:"fallbackHandler",type:"address"},{internalType:"address",name:"paymentToken",type:"address"},{internalType:"uint256",name:"payment",type:"uint256"},{internalType:"address payable",name:"paymentReceiver",type:"address"}],name:"setup",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"signedMessages",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"targetContract",type:"address"},{internalType:"bytes",name:"calldataPayload",type:"bytes"}],name:"simulateAndRevert",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"prevOwner",type:"address"},{internalType:"address",name:"oldOwner",type:"address"},{internalType:"address",name:"newOwner",type:"address"}],name:"swapOwner",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}];var ef=n(44521),ey=n(84497),ev=n(66683),ej=n(61784),eb=n(46046);let ew=e=>{let{masterEoa:t}=(0,eb.Q)(),{data:n,isFetched:r}=(0,ed.a)({enabled:!ex()(e),queryKey:e?ev.p.MULTISIG_GET_OWNERS_KEY(e):[],queryFn:async()=>e?new ec.Contract(e.address,eg,ey.a[e.evmChainId].provider).getOwners():[],refetchInterval:ex()(e)?0:ef.gA}),a=null==n?void 0:n.filter(e=>e.toLowerCase()!==(null==t?void 0:t.address.toLowerCase()));return{owners:n,ownersIsFetched:r,backupOwners:a}},eS=e=>{let{masterEoa:t}=(0,eb.Q)(),{data:n,isFetched:r,isPending:a,isLoading:s}=(0,ed.a)({enabled:!ex()(e)&&!eh()(e),queryKey:e?ev.p.MULTISIGS_GET_OWNERS_KEY(e):[],queryFn:async()=>{if(!e||eh()(e))return[];let t={};for(let[n]of Object.entries(ey.a)){let r=e.filter(e=>e.evmChainId===+n);0!==r.length&&(t[+n]=r.map(e=>({safeAddress:e.address,contractCall:new eu.CH(e.address,(0,ej.L)(eg)).getOwners()})))}let n=[];for(let[e,a]of Object.entries(t)){var r;let t=+e,s=null===(r=ey.a[t])||void 0===r?void 0:r.multicallProvider;if(!s){console.error("No provider found for chainId ".concat(t));continue}(await s.all(a.map(e=>e.contractCall))).forEach((e,r)=>{let s=a[r].safeAddress;n.push({safeAddress:s,evmChainId:t,owners:e})})}return n},refetchInterval:ef.gA}),i=(0,p.useMemo)(()=>null==n?void 0:n.reduce((e,n)=>{let{evmChainId:r,owners:a}=n;return e[r]=[...new Set(a.filter(e=>e!==(null==t?void 0:t.address)).map(e=>e))],e},{}),[null==t?void 0:t.address,n]);return{allBackupAddresses:(0,p.useMemo)(()=>[...new Set(null==n?void 0:n.map(e=>{let{owners:t}=e;return t}).flat().filter(e=>e!==(null==t?void 0:t.address)))],[null==t?void 0:t.address,n]),allBackupAddressesByChainId:i,masterSafesOwners:n,masterSafesOwnersIsFetched:r,masterSafesOwnersIsPending:a,masterSafesOwnersIsLoading:s}};var ek=n(49431);let eT=()=>{let{masterSafes:e,masterEoa:t,isFetched:n}=(0,eb.Q)(),{masterSafesOwners:r,masterSafesOwnersIsFetched:a}=eS(e),s=(0,p.useMemo)(()=>{if(t&&r)return r.map(e=>{let{owners:n,safeAddress:r,evmChainId:a}=e;return n.filter(e=>e!==t.address).map(e=>({address:e,type:el.S.EOA,safeAddress:r,evmChainId:a}))}).flat()},[r,t]);return{isLoaded:n&&a,data:[{masterEoa:null!=t?t:"undefined"},{masterSafe:null!=e?e:"undefined"},{masterSafeBackups:null!=s?s:"undefined"}]}},eC=()=>{let{masterWallets:e}=(0,eb.Q)(),{isLoaded:t,totalEthBalance:n,totalOlasBalance:r,walletBalances:a,totalStakedOlasBalance:s}=(0,eo.AE)();return{isLoaded:t,data:[{masterWallets:null!=e?e:"undefined"},{walletBalances:null!=a?a:"undefined"},{totalOlasStakedBalance:null!=s?s:"undefined"},{totalEthBalance:null!=n?n:"undefined"},{totalOlasBalance:null!=r?r:"undefined"}]}},eZ=()=>{let{services:e,isFetched:t,selectedService:n}=(0,k.S)(),r=(0,p.useMemo)(()=>null==e?void 0:e.map(e=>{var t;let r=(null==n?void 0:n.service_config_id)===e.service_config_id;return{...e,keys:null==e?void 0:null===(t=e.keys)||void 0===t?void 0:t.map(e=>e.address),deploymentStatus:r?n.deploymentStatus:e.deploymentStatus}}),[e,n]);return{isLoaded:t,data:{services:null!=r?r:"undefined"}}},eE=()=>{let{storeState:e}=(0,ek.o)(),{isLoaded:t,data:n}=eZ(),{isLoaded:r,data:a}=eC(),{isLoaded:s,data:i}=eT();return(0,p.useMemo)(()=>({store:e,debugData:{services:t?n:null,addresses:s?i:null,balances:r?a:null}}),[s,r,t,i,a,n,e])},eN=e=>{let{onClick:t}=e;return(0,u.jsxs)("span",{children:["Logs saved",(0,u.jsx)(f.ZP,{type:"link",size:"small",onClick:t,children:"Open folder"})]})},eP=e=>{let{size:t}=e,{openPath:n,saveLogs:r}=(0,ei.Z)(),a=eE(),[s,i]=(0,p.useState)(!1),[l,o]=(0,p.useState)(!1),d=(0,p.useCallback)(()=>o(!0),[]);return(0,p.useEffect)(()=>{!s&&a&&l&&(i(!0),null==r||r(a).then(e=>{e.success?es.ZP.success({content:(0,u.jsx)(eN,{onClick:()=>null==n?void 0:n(e.dirPath)}),duration:10}):es.ZP.error("Save logs failed or cancelled")}).finally(()=>{i(!1),o(!1)}))},[l,s,a,n,r]),(0,u.jsx)(f.ZP,{loading:s||l,onClick:d,size:t||"large",type:"primary",ghost:!0,children:"Export logs"})},{Text:eI}=m.default,eM=e=>{let{onRetry:t,onRetryProps:n,showRestartMessage:r}=e;return(0,u.jsxs)(x.Z,{vertical:!0,gap:8,align:"flex-start",className:"mt-12 text-sm",children:[(0,u.jsxs)(x.Z,{gap:8,children:[t&&(0,u.jsx)(f.ZP,{loading:null==n?void 0:n.isLoading,onClick:t,type:"primary",size:"small",children:"Retry"}),(0,u.jsx)(eP,{size:"small"})]}),(0,u.jsx)(eI,{className:"text-sm text-lighter",children:"Don't worry, your funds remain safe. You can access them by importing your Pearl seed phrase into a compatible wallet, like MetaMask or Coinbase."}),(0,u.jsxs)(eI,{className:"text-sm text-lighter",children:["Ask for help in"," ",(0,u.jsxs)("a",{href:ea.av,target:"_blank",rel:"noopener noreferrer",children:["the Olas community Discord server ",er.$.EXTERNAL_LINK]})]}),r&&(0,u.jsx)(eI,{className:"text-sm text-lighter",children:"You can also try restarting the app!"})]})};function e_(){let e=(0,H._)(["\n  line-height: normal;\n"]);return e_=function(){return e},e}let{Text:eA}=m.default,eL=U.ZP.div(e_()),eF=e=>{let{text:t}=e;return(0,u.jsx)(eA,{className:"text-sm text-lighter",style:{lineHeight:"normal"},children:t})},eO=e=>{let{link:t}=e;return(0,u.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"pl-4",children:(0,u.jsxs)(eA,{className:"text-sm text-primary",children:["Txn details ",er.$.EXTERNAL_LINK]})})},eR=(e,t)=>({status:e,computedSubSteps:t.map(e=>{let{symbol:t,status:n,txnLink:r,onRetry:a,onRetryProps:s}=e;return{description:"finish"===n?"Bridging ".concat(t||""," transaction complete."):"error"===n?"Bridging ".concat(t||""," failed."):"Sending transaction...",txnLink:r,isFailed:"error"===n,onRetry:a,onRetryProps:s}})}),eD=(e,t)=>{let n="error"===e,r="finish"===e?"Transaction complete.":"error"===e?"Transaction failed.":"process"===e?"Sending transaction...":null;return{title:"Create Master Safe",status:e,computedSubSteps:t.map(e=>{let{txnLink:t}=e;return{description:r,txnLink:t,isFailed:n}})}},eB=(e,t)=>({title:"Transfer funds to the Master Safe",status:e,computedSubSteps:t.map(e=>{let{symbol:t,status:n,txnLink:r}=e;return{description:"finish"===n?"Transfer ".concat(t," transaction complete."):"process"===n?"Sending transaction...":"error"===n?"Transfer ".concat(t," transaction failed."):null,txnLink:r,isFailed:"error"===n}})}),ez=e=>{let{chainName:t,bridge:n,masterSafeCreation:r,masterSafeTransfer:a}=e,s=(0,p.useMemo)(()=>({title:"Bridge funds to ".concat((0,I.KP)(t).displayName),...eR(n.status,n.subSteps)}),[t,n]),i=(0,p.useMemo)(()=>r?eD(r.status,r.subSteps):null,[r]),l=(0,p.useMemo)(()=>a?eB(a.status,a.subSteps):null,[a]),o=(0,p.useMemo)(()=>[s,i,l].filter(e=>!!e),[s,i,l]);return(0,u.jsx)(en.Z,{size:"small",direction:"vertical",items:o.map(e=>{let{status:t,title:n,computedSubSteps:r}=e;return{status:t,title:n,description:r.map((e,t)=>(0,u.jsxs)(eL,{style:{marginTop:0===t?4:6},children:[e.description&&(0,u.jsx)(eF,{text:e.description}),e.txnLink&&(0,u.jsx)(eO,{link:e.txnLink}),e.isFailed&&(0,u.jsx)(eM,{onRetry:e.onRetry,onRetryProps:e.onRetryProps,showRestartMessage:!0})]},t)),icon:"process"===t?(0,u.jsx)(et.Z,{}):void 0}})})};var eW=n(21306),eH=n(97845),eq=n(27484),eU=n.n(eq),eY=n(1646),eG=n.n(eY);function eQ(){let e=(0,H._)(["\n  .ant-statistic .ant-statistic-content .ant-statistic-content-prefix {\n    margin-inline-end: 0 !important;\n  }\n  .ant-statistic .ant-statistic-content .ant-statistic-content-suffix {\n    margin-inline-start: 0 !important;\n  }\n"]);return eQ=function(){return e},e}let{Text:e$}=m.default;eU().extend(eG());let eK=(0,U.ZP)(x.Z)(eQ()),eX=()=>{let[e,t]=(0,p.useState)(0);(0,p.useEffect)(()=>{let e=setInterval(()=>{t(e=>e+1)},1e3);return()=>clearInterval(e)},[]);let n=eU().duration(e,"seconds").format("HH:mm:ss");return(0,u.jsx)(eW.Z,{value:n,valueRender:e=>(0,u.jsx)(e$,{type:"secondary",children:e}),prefix:"(",suffix:")",valueStyle:{fontSize:"16px"}})},eV=e=>{let{isLoading:t,timeInSeconds:n}=e,r=(0,p.useMemo)(()=>Math.max(0,Math.floor(n/60)),[n]);return(0,u.jsxs)(eK,{gap:8,align:"center",children:[(0,u.jsx)(e$,{type:"secondary",children:"Estimated completion time:"}),t?(0,u.jsx)(eH.Z.Input,{active:!0,size:"small",style:{width:100}}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(e$,{strong:!0,children:["~ ",r," minute",1===r?"":"s"]}),(0,u.jsx)(eX,{})]})]})};var eJ=n(10227),e0=n(78021);let e1=e=>{let{onPrev:t}=e;return(0,u.jsxs)(eJ.Z,{children:[(0,u.jsx)(e0.Z,{span:8,children:t&&(0,u.jsx)(f.ZP,{onClick:()=>t(),icon:(0,u.jsx)(h.Z,{}),size:"large"})}),(0,u.jsx)(e0.Z,{span:8,children:(0,u.jsx)(x.Z,{justify:"center",children:(0,u.jsx)(v(),{src:"/onboarding-robot.svg",alt:"logo",width:80,height:80})})}),(0,u.jsx)(e0.Z,{span:8})]})};var e2=n(80537),e6=n(68553);let e4={getBridgeRefillRequirements:async(e,t)=>fetch("".concat(ea.z0,"/bridge/bridge_refill_requirements"),{method:"POST",headers:{...e6.z},body:JSON.stringify(e),signal:t}).then(t=>{if(t.ok)return t.json();throw Error("Failed to get bridge refill requirements for the following params: ".concat(e))}),executeBridge:async(e,t)=>fetch("".concat(ea.z0,"/bridge/execute"),{method:"POST",headers:{...e6.z},body:JSON.stringify({id:e}),signal:t}).then(t=>{if(t.ok)return t.json();throw Error("Failed to execute bridge quote for the following quote id: ".concat(e))}),getBridgeStatus:async(e,t)=>fetch("".concat(ea.z0,"/bridge/status/").concat(e),{method:"GET",headers:{...e6.z},signal:t}).then(t=>{if(t.ok)return t.json();throw Error("Failed to get bridge status for the following quote id: ".concat(e))})};var e5=n(58892);let e8=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return!!e&&e.some(e=>"EXECUTION_FAILED"===e.status)},e3=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.every(e=>"EXECUTION_DONE"===e.status)},e9=e=>{let{stats:t,tokenSymbols:n}=e;return t.map((e,t)=>{let r="EXECUTION_DONE"===e.status?"finish":"EXECUTION_FAILED"===e.status?"error":(e.status,"process");return{symbol:n[t],status:r,txnLink:e.explorer_link}})},e7=(e,t)=>{let{isOnline:n}=(0,e2.y)(),{isLoading:r,isFetching:a,isError:s,data:i}=(0,ed.a)({queryKey:ev.p.BRIDGE_EXECUTE_KEY(t),queryFn:async e=>{let{signal:n}=e;if(!t){window.console.warn("No quoteId provided to execute bridge");return}await (0,e5.a)(1);try{return await e4.executeBridge(t,n)}catch(e){throw console.error("Error executing bridge",e),e}},enabled:!!t&&n,retry:!1,refetchOnWindowFocus:!1,refetchInterval:!1}),l=(0,p.useMemo)(()=>!!s||!!i&&e8(i.bridge_request_status),[s,i]),o=(0,p.useMemo)(()=>!!i&&e3(i.bridge_request_status),[i]),{isLoading:d,isError:c,data:u}=(0,ed.a)({queryKey:ev.p.BRIDGE_STATUS_BY_QUOTE_ID_KEY(t),queryFn:async()=>{if(!t){window.console.warn("No quoteId provided to fetch bridge status");return}try{return await e4.getBridgeStatus(t)}catch(e){throw console.error("Error fetching bridge status",e),e}},refetchInterval:!l&&!o&&ef.gA,enabled:n&&!!t&&!a&&!r&&!!i,refetchOnWindowFocus:!1}),h=r||d,m=(0,p.useMemo)(()=>!!o||!!u&&e3(u.bridge_request_status),[o,u]),x=(0,p.useMemo)(()=>l||e8(null==u?void 0:u.bridge_request_status),[l,u]),g=(0,p.useMemo)(()=>!!s||!!c||!!x,[s,c,x]),f=(0,p.useMemo)(()=>{if(!r&&!a&&!s&&i)return e9({stats:i.bridge_request_status,tokenSymbols:e})},[r,a,s,i,e]),y=(0,p.useMemo)(()=>{if(!d&&!c&&u)return e9({stats:u.bridge_request_status,tokenSymbols:e})},[d,c,u,e]);return{isBridging:h,isBridgingFailed:g,isBridgingCompleted:m,bridgeStatus:(0,p.useMemo)(()=>o?f:y,[o,f,y])}};var te=n(98029),tt=n(64347);let tn=()=>{let{setupObject:e,setSetupObject:t}=(0,p.useContext)(tt.U),{store:n}=(0,ei.Z)(),{storeState:r}=(0,ek.o)(),a=(0,p.useCallback)(e=>{t(t=>({...t,state:e,prevState:t.state}))},[t]),s=(0,p.useCallback)(e=>{t(t=>Object.assign(t,{mnemonic:e}))},[t]),i=(0,p.useCallback)(e=>{var t;let{address:r,type:a}=e;null==n||null===(t=n.set)||void 0===t||t.call(n,"lastProvidedBackupWallet",{address:r,type:a})},[n]);return(0,p.useEffect)(()=>{var e,n;let a=null==r?void 0:null===(e=r.lastProvidedBackupWallet)||void 0===e?void 0:e.address,s=null==r?void 0:null===(n=r.lastProvidedBackupWallet)||void 0===n?void 0:n.type;a&&s&&t(e=>Object.assign(e,{backupSigner:{address:a,type:s}}))},[t,null==r?void 0:r.lastProvidedBackupWallet]),{...e,setMnemonic:s,setBackupSigner:i,goto:a}},tr=()=>{var e;let{backupSigner:t}=tn(),{masterSafes:n}=(0,eb.Q)(),{allBackupAddresses:r}=eS(n);return null!==(e=null==t?void 0:t.address)&&void 0!==e?e:r[0]};var ta=n(78782);let ts=e=>{let t=(0,ei.Z)(),n=tr(),{selectedAgentType:r,selectedAgentConfig:a}=(0,k.S)(),s=a.middlewareHomeChainId;return(0,te.D)({mutationFn:async()=>{try{let t=await ta.X.createSafe(s,n);return{isSafeCreated:!0,txnLink:"".concat(ea.Tz[s],"/tx/").concat(t.create_tx),masterSafeTransferStatus:"FINISHED",transfers:e.map(e=>({symbol:e,status:"finish",txnLink:null}))}}catch(e){throw console.error("Safe creation failed:",e),e}},onSuccess:()=>{var e,n;null===(n=t.store)||void 0===n||null===(e=n.set)||void 0===e||e.call(n,"".concat(r,".isInitialFunded"),!0)},onError:e=>{console.error(e)}})},ti=()=>{let{refetch:e}=(0,w.C)();return(0,p.useCallback)(async t=>{if(!e)return;let{data:n}=await e();n&&((null==n?void 0:n.is_refill_required)?t("NEED_REFILL"):es.ZP.open({icon:null,content:"Bridging complete! Please restart the app if you're not redirected automatically."}))},[e])},{Text:tl,Title:to}=m.default,td=()=>(0,u.jsx)(ee,{type:"warning",fullWidth:!0,showIcon:!0,message:(0,u.jsx)(tl,{className:"text-sm",children:"Keep the app open until bridging is complete."})}),tc=()=>(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(G,{$noBorder:!0,$gap:20,$padding:"0 24px",children:[(0,u.jsx)(e1,{}),(0,u.jsx)(to,{level:3,className:"m-0",children:"Bridging in progress"})]}),(0,u.jsx)(td,{})]}),tu=e=>{let{quoteId:t,fromChain:n,toChain:r,eta:a,transfers:s,bridgeRetryOutcome:i,onBridgeRetryOutcome:l,enabledStepsAfterBridging:o=[],onNext:d}=e,{goto:c}=(0,S.a)(),h=s.map(e=>e.toSymbol),[m,x]=(0,p.useState)(!1),g=ti(),{isBridging:f,isBridgingFailed:y,isBridgingCompleted:v,bridgeStatus:j}=e7(h,t),{isPending:w,isError:k,data:T,mutateAsync:C}=ts(h),Z=o.includes("masterSafeCreationAndTransfer"),E=null==T?void 0:T.isSafeCreated,N=(null==T?void 0:T.masterSafeTransferStatus)==="FINISHED";(0,p.useEffect)(()=>{!Z||"NEED_REFILL"===i||f||y||!v||w||k||null!=T&&T.isSafeCreated||C()},[Z,o,i,v,f,y,w,T,k,C]),(0,p.useEffect)(()=>{if("NEED_REFILL"===i||f||y||!v)return;if(!Z){d();return}if(w||!E||!N)return;let e=setTimeout(()=>c(b.i.Main),3e3);return()=>clearTimeout(e)},[Z,i,f,y,v,w,E,N,c,d]);let P=(0,p.useCallback)(()=>{x(!0),g(e=>l(e)).finally(()=>{x(!1)})},[g,l]),I=(0,p.useMemo)(()=>{let e="NEED_REFILL"===i?"wait":y?"error":f?"process":j?v?"finish":"process":"wait";return{status:e,subSteps:(j||[]).map(t=>({...t,onRetry:P,onRetryProps:{isLoading:"process"===e||m}}))}},[i,f,y,v,j,m,P]),M=(0,p.useMemo)(()=>{if(!Z)return;let e="NEED_REFILL"===i||f||!v?"wait":k?"error":w?"process":E?"finish":"process";return{status:e,subSteps:[{txnLink:null,onRetry:C,onRetryProps:{isLoading:"process"===e}}]}},[Z,i,f,v,E,w,k,C]),_=(0,p.useMemo)(()=>{if(Z&&M)return{status:"NEED_REFILL"===i?"wait":k?"error":!f&&v&&E&&N?"finish":"wait",subSteps:((null==T?void 0:T.transfers)||[]).map(e=>({...e,onRetry:C,onRetryProps:{isLoading:"process"===M.status}}))}},[Z,i,k,E,f,v,N,M,null==T?void 0:T.transfers,C]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(tc,{}),(0,u.jsxs)(G,{$noBorder:!0,$gap:16,$padding:"0 24px",children:[a&&(0,u.jsx)(eV,{timeInSeconds:a}),(0,u.jsx)(O,{fromChain:n,toChain:r,transfers:s}),!!I&&(0,u.jsx)(ez,{chainName:r,bridge:I,masterSafeCreation:M,masterSafeTransfer:_})]})]})};function tp(){let e=(0,H._)(["\n  ","\n\n  border-collapse: collapse;\n  margin-left: -24px;\n  margin-right: -24px;\n"]);return tp=function(){return e},e}let th=(0,U.ZP)(x.Z)(tp(),e=>{var t;let{padding:n,borderbottom:r,bordertop:a,vertical:s,$borderBottom:i,$borderTop:l,$padding:o}=e,d="padding: ".concat(null!==(t=n||o)&&void 0!==t?t:"0px",";"),c="true"===a||l?"border-top: 1px solid ".concat(P.r.BORDER_GRAY,";"):"border-top: none;",u="true"===r||i?"border-bottom: 1px solid ".concat(P.r.BORDER_GRAY,";"):"border-bottom: none;";return"\n      ".concat(d,"\n      ").concat(c,"\n      ").concat(u,"\n      ").concat(s?"flex-direction: column;":"","\n    ")});var tm=n(89119),tx=n(33789),tg=n(87672),tf=n(11700),ty=n.n(tf),tv=n(75529),tj=n(96369),tb=n(66577),tw=n(50746),tS=n(71954),tk=n(80895);let tT=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{isOnline:r}=(0,p.useContext)(tk.F);return(0,ed.a)({queryKey:ev.p.BRIDGE_REFILL_REQUIREMENTS_KEY(e),queryFn:async r=>{let{signal:a}=r;return e?n||t?await e4.getBridgeRefillRequirements(e,a):null:(window.console.warn("No parameters provided for bridge refill requirements"),null)},refetchInterval:!!n&&!!t&&ef.hz,refetchOnWindowFocus:!1,enabled:r&&!!e&&!!n,staleTime:0,refetchOnMount:"always",refetchOnReconnect:"always",refetchIntervalInBackground:!0})};var tC=n(43133),tZ=n(64484),tE=n(52155);let tN=async e=>navigator.clipboard.writeText(e),{Text:tP}=m.default,tI=()=>{let{masterEoa:e}=(0,eb.Q)(),t=null==e?void 0:e.address,n=(0,p.useCallback)(()=>{t&&tN(t).then(()=>es.ZP.success("Address copied!"))},[t]);return(0,u.jsxs)(x.Z,{gap:8,vertical:!0,className:"p-16 w-full border-box",children:[(0,u.jsxs)(x.Z,{justify:"space-between",align:"center",children:[(0,u.jsx)(tP,{className:"text-sm",type:"secondary",children:"Deposit address"}),(0,u.jsx)(x.Z,{gap:10,children:(0,u.jsx)(tE.Z,{title:"Copy to clipboard",placement:"left",children:(0,u.jsx)(f.ZP,{onClick:n,size:"small",icon:(0,u.jsx)(tZ.Z,{style:tj.go})})})})]}),(0,u.jsx)("span",{className:"can-select-text break-word",children:"".concat(t)})]})};var tM=n(97075),t_=n(26649);let tA=e=>{let{placement:t="topLeft",children:n,...r}=e;return(0,u.jsx)(tE.Z,{arrow:!1,title:n,placement:t,...r,children:(0,u.jsx)($.Z,{style:{color:P.r.TEXT_LIGHT}})})},{Text:tL}=m.default,tF=e=>{let{symbol:t,totalRequiredInWei:n,currentBalanceInWei:r,areFundsReceived:a,decimals:s,isNative:i,precision:l=2}=e,o=n-r;return(0,u.jsxs)(x.Z,{gap:8,align:"center",children:[a?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(tM.Z,{style:tj.v$}),(0,u.jsx)(tL,{strong:!0,children:t})," funds received!"]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(t_.Z,{style:tj.Kt}),(0,u.jsxs)(tL,{className:"loading-ellipses",children:["Waiting for"," ",(0,u.jsxs)(tL,{strong:!0,children:[(0,M.Bs)(o,s,l),"\xa0",t]})]})]}),(0,u.jsx)(tA,{overlayInnerStyle:{width:320},placement:"top",children:(0,u.jsxs)(x.Z,{vertical:!0,gap:8,className:"p-8",children:[(0,u.jsxs)(x.Z,{justify:"space-between",children:[(0,u.jsx)(tL,{type:"secondary",className:"text-sm",children:"Total amount required"}),(0,u.jsx)(tL,{className:"text-sm",strong:!0,children:"".concat((0,M.Bs)(n,s,l)," ").concat(t)})]}),(0,u.jsxs)(x.Z,{justify:"space-between",children:[(0,u.jsx)(tL,{type:"secondary",className:"text-sm",children:"Balance at deposit address"}),(0,u.jsx)(tL,{className:"text-sm",strong:!0,children:"".concat((0,M.Bs)(r,s,l)," ").concat(t)})]}),(0,u.jsx)(tg.Z,{className:"m-0"}),(0,u.jsxs)(x.Z,{justify:"space-between",children:[(0,u.jsx)(tL,{className:"text-sm",strong:!0,children:"Deposit required"}),(0,u.jsx)(tL,{className:"text-sm",strong:!0,children:"".concat((0,M.Bs)(o,s,l)," ").concat(t)})]}),i&&(0,u.jsx)(tL,{type:"secondary",className:"text-sm",children:"The total amount may fluctuate due to periodic quote updates."})]})})]})};function tO(){let e=(0,H._)(["\n  align-items: start;\n  border-radius: 12px;\n  border: 1px solid ",";\n"]);return tO=function(){return e},e}let{Text:tR}=m.default,tD="deposited-funds",tB=(0,U.ZP)(x.Z)(tO(),P.r.BORDER_GRAY),tz=e=>{let{chainName:t}=e;return(0,u.jsxs)(x.Z,{gap:8,align:"center",className:"p-16",children:[(0,u.jsx)(v(),{src:"/chains/".concat(N()(t),"-chain.png"),width:20,height:20,alt:"".concat(t," logo")}),(0,u.jsx)(tR,{children:ty()(t)})]})},tW=()=>(0,u.jsxs)(x.Z,{gap:8,className:"p-16",children:[(0,u.jsx)(g.Z,{indicator:(0,u.jsx)(et.Z,{spin:!0,style:tj.go})}),(0,u.jsx)(tR,{children:"Requesting quote..."})]}),tH=e=>{let{onTryAgain:t}=e;return(0,u.jsxs)(x.Z,{gap:8,className:"p-16 border-box w-full",align:"center",justify:"space-between",children:[(0,u.jsxs)(x.Z,{gap:8,align:"center",children:[(0,u.jsx)(tm.Z,{style:tj.vj}),(0,u.jsx)(tR,{children:"Quote request failed"})]}),(0,u.jsx)(f.ZP,{onClick:t,icon:(0,u.jsx)(tx.Z,{}),size:"small",children:"Try again"})]})},tq=e=>{let{chainName:t,getBridgeRequirementsParams:n,updateQuoteId:r,updateCrossChainTransferDetails:a,onNext:s}=e,{isLoading:i,selectedAgentConfig:l}=(0,k.S)(),o=l.middlewareHomeChainId,{masterEoa:d}=(0,eb.Q)(),{isBalancesAndFundingRequirementsLoading:c}=(0,w.C)(),[h,m]=(0,p.useState)(!1),[g,f]=(0,p.useState)(!0),[y,v]=(0,p.useState)(!0),[j,b]=(0,p.useState)(!1),S=(0,p.useMemo)(()=>n?n(h):null,[h,n]),{data:T,isLoading:C,isError:Z,isFetching:E,refetch:N}=tT(S,y);(0,p.useEffect)(()=>{g&&N().finally(()=>{f(!1)})},[g,N,f]);let P=c||g||C||i||j,M=(0,p.useMemo)(()=>!P&&(!!Z||(null==T?void 0:T.bridge_request_status.some(e=>"QUOTE_FAILED"===e.status))),[P,Z,T]),_=(0,p.useMemo)(()=>{if(P||M||!T)return;let e=T.bridge_request_status.filter(e=>"QUOTE_DONE"===e.status);if(0!==e.length)return Math.max(...e.map(e=>e.eta||0))},[P,M,T]);(0,p.useEffect)(()=>{M&&v(!1)},[M]);let A=(0,p.useMemo)(()=>{var e,t;if(!T||!d)return[];let n=tv.o.ETHEREUM,r=null===(e=T.bridge_total_requirements[n])||void 0===e?void 0:e[d.address],a=null===(t=T.bridge_refill_requirements[n])||void 0===t?void 0:t[d.address];return r&&a?Object.entries(r).map(e=>{let[t,n]=e,r=BigInt(n),s=r-BigInt(a[t]||0),i=Object.values(tb.hE).find(e=>t===tw.d&&!e.address||(0,tC.J)(e.address,t));if(!i)throw Error("Failed to get the token info for the following token address: ".concat(t));return{address:t,symbol:i.symbol,totalRequiredInWei:r,currentBalanceInWei:s,areFundsReceived:r-s<=0,decimals:i.decimals,isNative:i.tokenType===tb.iv.NativeGas}}):[]},[T,d]);(0,p.useEffect)(()=>{!P&&!E&&T&&0!==A.length&&!M&&(null==d?void 0:d.address)&&_&&A.every(e=>e.areFundsReceived)&&!T.is_refill_required&&(r(T.id),a({fromChain:tv.o.ETHEREUM,toChain:o,eta:_,transfers:A.map(e=>{let t=(()=>{var t;let n=tb.vP[(0,I.DH)(o)][e.symbol],r=e.symbol===tS.W.ETH?e.address:n.address;if(!r)return BigInt(0);let a=null==S?void 0:null===(t=S.bridge_requests)||void 0===t?void 0:t.find(e=>{let{to:t}=e;return(0,tC.J)(t.token,r)});return a?BigInt(a.to.amount):BigInt(0)})();return{fromSymbol:e.symbol,fromAmount:e.currentBalanceInWei.toString(),toSymbol:e.isNative?(0,I.KP)(o).symbol:e.symbol,toAmount:t.toString(),decimals:e.decimals}})}),es.ZP.success({content:"Funds received, proceeding to next step...",key:tD}),(0,e5.a)(2).then(()=>{es.ZP.destroy(tD),s()}))},[P,E,M,o,T,d,A,S,_,s,r,a]);let L=(0,p.useCallback)(async()=>{m(!0),b(!0),v(!1),await (0,e5.a)(1),N().then(()=>{m(!1),v(!0)}).finally(()=>{b(!1)})},[N]);return(0,u.jsxs)(tB,{vertical:!0,children:[(0,u.jsx)(tz,{chainName:t}),(0,u.jsx)(tg.Z,{className:"m-0"}),P?(0,u.jsx)(tW,{}):M?(0,u.jsx)(tH,{onTryAgain:L}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(x.Z,{gap:8,align:"start",vertical:!0,className:"p-16",children:0===A.length?(0,u.jsx)(x.Z,{gap:8,align:"center",children:"No tokens to deposit!"}):A.map(e=>(0,u.jsx)(tF,{...e,precision:e.isNative?5:2},e.symbol))}),(0,u.jsx)(tg.Z,{className:"m-0"}),(0,u.jsx)(tI,{})]})]})},{Text:tU,Title:tY}=m.default,tG="Ethereum",tQ=()=>(0,u.jsx)(th,{children:(0,u.jsx)(ee,{fullWidth:!0,type:"warning",showIcon:!0,message:(0,u.jsxs)(x.Z,{vertical:!0,gap:5,children:[(0,u.jsx)(tU,{strong:!0,children:"Only send funds on Ethereum!"}),(0,u.jsx)(tU,{children:"Full amount of funds is required to initiate the bridging."})]})})}),t$=e=>{let{bridgeFromDescription:t,onPrev:n,onNext:r,getBridgeRequirementsParams:a,updateQuoteId:s,updateCrossChainTransferDetails:i}=e;return(0,u.jsxs)(G,{$noBorder:!0,children:[(0,u.jsx)(e1,{onPrev:n}),(0,u.jsxs)(th,{vertical:!0,gap:24,className:"m-0 pt-24",children:[(0,u.jsxs)(x.Z,{vertical:!0,gap:8,children:[(0,u.jsxs)(tY,{level:3,className:"m-0",children:["Bridge from ",tG]}),(0,u.jsx)(tU,{className:"text-base text-lighter",children:t})]}),(0,u.jsx)(tQ,{}),(0,u.jsx)(tq,{chainName:tG,getBridgeRequirementsParams:a,updateQuoteId:s,updateCrossChainTransferDetails:i,onNext:r})]})]})},tK="Transfer and receiving amounts are required for in progress state",tX=e=>{let{showCompleteScreen:t,getBridgeRequirementsParams:n,bridgeFromDescription:r,enabledStepsAfterBridging:a,onPrevBeforeBridging:s}=e,{goto:i}=(0,S.a)(),[l,o]=(0,p.useState)("depositing"),[d,c]=(0,p.useState)(null),[h,m]=(0,p.useState)(null),[x,g]=(0,p.useState)(null);(0,p.useEffect)(()=>{x&&"NEED_REFILL"===x&&(o("depositing"),c(null),m(null),g(null))},[x]);let f=(0,p.useCallback)(e=>c(e),[c]),y=(0,p.useCallback)(e=>m(e),[m]),v=(0,p.useCallback)(()=>{switch(l){case"depositing":o("in_progress");break;case"in_progress":t?o("completed"):i(b.i.Main);break;case"completed":i(b.i.Main);break;default:throw Error("Invalid bridge state")}},[t,l,i]);switch(l){case"depositing":return(0,u.jsx)(t$,{bridgeFromDescription:r,getBridgeRequirementsParams:n,updateQuoteId:f,updateCrossChainTransferDetails:y,onPrev:s,onNext:v});case"in_progress":if(!d)throw Error("Quote ID is required for in progress state");if(!h)throw Error(tK);return(0,u.jsx)(tu,{quoteId:d,...h,bridgeRetryOutcome:x,onBridgeRetryOutcome:e=>g(e),enabledStepsAfterBridging:a,onNext:v});case"completed":if(!h)throw Error(tK);if(!t||!t.completionMessage)throw Error("Completion message is required for completed state");return(0,u.jsx)(Q,{...h,completionMessage:t.completionMessage});default:throw Error("Invalid bridge state!")}};var tV=n(4087);let tJ=e=>{let t=(e.ctrlKey||e.metaKey)&&"c"===e.key,n=(e.ctrlKey||e.metaKey)&&"v"===e.key,r=(e.ctrlKey||e.metaKey)&&"x"===e.key,a=(e.ctrlKey||e.metaKey)&&"a"===e.key;/[0-9]/.test(e.key)||"Backspace"===e.key||"Delete"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key||"Tab"===e.key||"."===e.key||t||n||r||a||e.preventDefault();let s=e.currentTarget.value;"."===e.key&&s.includes(".")&&e.preventDefault()},t0=e=>{let{value:t,...n}=e;return(0,u.jsx)(tV.Z,{...n,value:"string"==typeof t?parseFloat(t):t,formatter:e=>{let[t,n]="".concat(e).split("."),r=t.replace(/\B(?=(\d{3})+(?!\d))/g,",");return void 0!==n?"".concat(r,".").concat(n):r},onKeyDown:tJ})};var t1=n(44908),t2=n.n(t1);function t6(e,t){if(null==e)throw Error("Failed, value is either null or undefined. Incorrect assumption: ".concat(t))}let t4=e=>{if("object"!=typeof e||null===e)throw TypeError("Expected an object");return Object.keys(e)},t5=(e,t)=>{if((0,tC.J)(e,tw.d)){var n,r;let e=Object.values(t).find(e=>"native"===e.tokenType);return{symbol:null!==(n=null==e?void 0:e.symbol)&&void 0!==n?n:"ETH",decimals:null!==(r=null==e?void 0:e.decimals)&&void 0!==r?r:18}}return Object.values(t).find(t=>(0,tC.J)(t.address,e))},t8=(e,t)=>{var n;return null===(n=t5(e,t))||void 0===n?void 0:n.symbol},t3=(e,t)=>{var n;return null===(n=t5(e,t))||void 0===n?void 0:n.decimals},t9=(e,t,n)=>{var r;if((0,tC.J)(e,tw.d))return tw.d;let a=t8(e,n);if(!a||!(null===(r=t[a])||void 0===r?void 0:r.address))throw Error("Failed to get source token for the destination token: ".concat(e));return t[a].address},t7=tb.hE,ne=e=>{let{masterEoa:t,masterSafes:n}=(0,eb.Q)(),{selectedAgentConfig:r}=(0,k.S)(),a=r.middlewareHomeChainId,s=tb.vP[(0,I.DH)(a)],i=null==n?void 0:n.find(e=>{let{evmChainId:t}=e;return r.evmHomeChainId===t});return(0,p.useCallback)((n,r)=>{if(!t)throw Error("Master EOA is not available");if(!i)throw Error("Master Safe is not available");let l=t9(n,t7,s),o=t3(n,s);return{from:{chain:tv.o.ETHEREUM,address:t.address,token:l},to:{chain:a,address:null!=e?e:i.address,token:n,amount:(0,M.vz)(r,o)}}},[a,s,t,i,e])},nt=e=>{let{requirements:t,defaultTokenAmounts:n,destinationAddress:r,onlyNativeToken:a=!1}=e,{selectedAgentConfig:s}=(0,k.S)(),i=s.middlewareHomeChainId,l=ne(r),o=t4(t).reduce((e,n)=>{let r=t[n];if(!r)return e;let s=t4(r).filter(e=>!a||e===tw.d);return e.push(...s),e},[]),d=(0,p.useMemo)(()=>t2()(o).map(e=>{var t,r;let{symbol:a,decimals:s}=(0,I.Q5)(i,e),l=null!==(r=null==n?void 0:null===(t=n.find(e=>e.symbol===a))||void 0===t?void 0:t.amount)&&void 0!==r?r:0;return{tokenAddress:e,symbol:a,decimals:s,amount:l}}),[o,i,n]),[c,u]=(0,p.useState)(d.reduce((e,t)=>{let{symbol:n,amount:r}=t;return{...e,[n]:r}},{})),h=(0,p.useCallback)((e,t)=>{var n;let r=d.find(t=>t.symbol===e),a=null!==(n=null==r?void 0:r.decimals)&&void 0!==n?n:18;("number"!=typeof t||Number.isNaN(t)||!((t.toString().split(".")[1]||"").length>a))&&u(n=>({...n,[e]:t}))},[d]),m=(0,p.useMemo)(()=>d.reduce((e,t)=>{let n=c[t.symbol];if(!n)return e;let r=l(t.tokenAddress,n);return e.push(r),e},[]),[d,c,l]),x=(0,p.useMemo)(()=>Object.values(c).every(e=>!e||e<=0),[c]);return{inputsToDisplay:(0,p.useMemo)(()=>Object.entries(c).map(e=>{let[t,n]=e;return{symbol:t,amount:null!=n?n:0}}),[c]),isInputEmpty:x,onInputChange:h,bridgeRequirementsParams:m}},{Title:nn,Text:nr}=m.default,na=()=>(0,u.jsx)(x.Z,{justify:"center",align:"center",style:{height:240},children:(0,u.jsx)(g.Z,{})}),ns=()=>{let{goto:e}=(0,S.a)();return(0,u.jsxs)(x.Z,{gap:16,align:"center",children:[(0,u.jsx)(f.ZP,{onClick:()=>e(b.i.Main),icon:(0,u.jsx)(h.Z,{})}),(0,u.jsx)(nn,{level:5,className:"m-0",children:"Bridge from Ethereum"})]})},ni=e=>{let{symbol:t}=e;return(0,u.jsxs)(x.Z,{align:"center",justify:"flex-start",gap:8,style:{width:78},children:[(0,u.jsx)(v(),{src:j.F[t].image,alt:t,width:20,height:20}),t]})},nl=e=>{let{defaultTokenAmounts:t,requirements:n,onlyNativeToken:r,destinationAddress:a,onBridgeFunds:s}=e,{onInputChange:i,inputsToDisplay:l,isInputEmpty:o,bridgeRequirementsParams:d}=nt({requirements:n,defaultTokenAmounts:t,destinationAddress:a,onlyNativeToken:r}),c=(0,p.useCallback)(()=>s(d),[s,d]);return(0,u.jsxs)(x.Z,{gap:8,vertical:!0,children:[(0,u.jsx)(nr,{className:"font-xs",type:"secondary",children:"Amount to receive"}),(0,u.jsxs)(x.Z,{gap:16,vertical:!0,children:[l.map(e=>{let{symbol:t,amount:n}=e;return(0,u.jsx)(t0,{value:n,addonBefore:(0,u.jsx)(ni,{symbol:t}),placeholder:"0.00",size:"large",min:0,onChange:e=>i(t,e)},t)}),(0,u.jsx)(f.ZP,{disabled:o,onClick:c,type:"primary",size:"large",children:"Bridge funds"})]})]})},no=e=>{let{defaultTokenAmounts:t,destinationAddress:n,onlyNativeToken:r=!1,completionMessage:a}=e,{isBalancesAndFundingRequirementsLoading:s,totalRequirements:i}=(0,w.C)(),{selectedService:l}=(0,k.S)(),{goto:o}=(0,S.a)(),[d,c]=(0,p.useState)(),[h,m]=(0,p.useState)("funding"),g=(0,p.useMemo)(()=>{if(a)return{completionMessage:a}},[a]),y=(0,p.useCallback)(e=>{c({bridge_requests:e,force_update:!1}),m("bridging")},[c,m]),v=(0,p.useCallback)(e=>{if(!d)throw Error("Bridge requirements are not set.");return{...d,force_update:null!=e&&e}},[d]),j=(0,p.useCallback)(()=>{m("funding")},[]);switch(h){case"funding":return(0,u.jsxs)(G,{$gap:20,$noBorder:!0,title:(0,u.jsx)(ns,{}),styles:{header:{minHeight:56},body:{padding:"0 24px"}},children:[(0,u.jsx)(nr,{children:"Specify the amount of tokens you'd like to receive to your Pearl Safe."}),(null==l?void 0:l.service_config_id)?s||!i?(0,u.jsx)(na,{}):(0,u.jsx)(nl,{defaultTokenAmounts:t,onlyNativeToken:r,destinationAddress:n,requirements:i,onBridgeFunds:y}):(0,u.jsxs)(x.Z,{vertical:!0,align:"center",gap:16,children:[(0,u.jsx)(nr,{type:"secondary",children:"No agent configured. Please set up an agent first to use the bridge feature."}),(0,u.jsx)(f.ZP,{type:"primary",onClick:()=>o(b.i.Setup),children:"Set up Agent"})]})]});case"bridging":return(0,u.jsx)(tX,{bridgeFromDescription:"Bridging amount includes fees.",showCompleteScreen:g,getBridgeRequirementsParams:v,onPrevBeforeBridging:j});default:throw Error("Invalid add funds state")}},nd=()=>(0,u.jsx)(no,{completionMessage:"Funds have been bridged to your Pearl Safe."});var nc=n(95852);let nu=()=>{let{masterSafeNativeGasRequirement:e}=(0,eo.PU)(),{selectedAgentConfig:t}=(0,k.S)(),n=t.evmHomeChainId,r=nc.NJ[n].nativeToken.symbol;return(0,u.jsx)(no,{defaultTokenAmounts:[{symbol:r,amount:null!=e?e:0}],completionMessage:"Funds have been bridged to your Pearl Safe."})},np=()=>{let{masterEoaGasRequirement:e}=(0,eo.PU)(),{masterEoa:t}=(0,eb.Q)(),{selectedAgentConfig:n}=(0,k.S)(),r=n.evmHomeChainId,a=nc.NJ[r].nativeToken.symbol;return(0,u.jsx)(no,{defaultTokenAmounts:[{symbol:a,amount:null!=e?e:0}],destinationAddress:null==t?void 0:t.address,onlyNativeToken:!0,completionMessage:"Funds have been bridged to your Pearl Safe Signer."})};var nh=n(31749),nm=n(83859),nx=n(65378),ng=n(45220),nf=n.n(ng),ny=n(37651);let{Text:nv}=m.default,nj={fontSize:48,color:P.r.TEXT_LIGHT},nb={background:"linear-gradient(180deg, #FCFCFD 0%, #EEF0F7 100%)"},nw=e=>{let{children:t}=e;return(0,u.jsx)(x.Z,{vertical:!0,gap:16,align:"center",justify:"center",style:{height:400},children:t})},nS=()=>(0,u.jsx)(nw,{children:(0,u.jsx)(g.Z,{})}),nk=e=>{let{refetch:t}=e;return(0,u.jsxs)(nw,{children:[(0,u.jsx)(nh.Z,{style:nj}),(0,u.jsx)(nv,{type:"secondary",children:"Error loading data"}),(0,u.jsx)(f.ZP,{onClick:t,children:"Try again"})]})},nT=()=>(0,u.jsxs)(nw,{children:[(0,u.jsx)(nm.Z,{style:nj}),(0,u.jsx)(nv,{type:"secondary",children:"There's no previous agent activity recorded yet"})]}),nC=()=>{let e=(0,ei.Z)(),{isOnline:t}=(0,p.useContext)(tk.F),{selectedService:n}=(0,k.S)(),{isServiceRunning:r}=(0,ny.G)(null==n?void 0:n.service_config_id),a=null==n?void 0:n.service_config_id,s=null==e?void 0:e.healthCheck,i=(0,p.useCallback)(async()=>{if(!a)return{response:null};let e=await fetch("".concat(ea.lC,"/service/").concat(a,"/deployment"));if(!e.ok)throw Error("Failed to fetch healthcheck");let t=await e.json();return{response:t&&"healthcheck"in t?t.healthcheck:null}},[a]),{data:l,isLoading:o,isError:d,refetch:c}=(0,ed.a)({queryKey:ev.p.AGENT_ACTIVITY(a),queryFn:async()=>{if(!s)return i();let e=await s();if(e&&"error"in e)throw Error(e.error);return e},select:e=>{var t,n;return e&&"response"in e&&e.response?{rounds:[...(null===(t=e.response)||void 0===t?void 0:t.rounds)||[]].reverse(),roundsInfo:null===(n=e.response)||void 0===n?void 0:n.rounds_info}:null},enabled:r&&!!a&&(!!s||t),refetchOnWindowFocus:!1,refetchInterval:e=>!e.state.error&&(s?ef.gA:!!t&&ef.gA)}),h=(0,p.useMemo)(()=>{if(o)return(0,u.jsx)(nS,{});if(d)return(0,u.jsx)(nk,{refetch:c});if(!r||nf()(l)||eh()(l))return(0,u.jsx)(nT,{});let e=l.rounds.map((e,t)=>{var n,r,a,s;let i=0===t,o=(null===(r=l.roundsInfo)||void 0===r?void 0:null===(n=r[e])||void 0===n?void 0:n.name)||e,d=(null===(s=l.roundsInfo)||void 0===s?void 0:null===(a=s[e])||void 0===a?void 0:a.description)||er.NA;return{key:"".concat(e,"-").concat(t),label:i?(0,u.jsxs)(x.Z,{vertical:!0,gap:4,children:[(0,u.jsx)(nv,{type:"secondary",className:"text-xs",children:"Current activity"}),(0,u.jsx)(nv,{className:"text-sm loading-ellipses fit-content",children:o})]}):(0,u.jsx)(nv,{className:"text-sm",children:o}),children:(0,u.jsx)(nv,{type:"secondary",className:"text-sm",style:{marginLeft:"26px"},children:d}),style:i?nb:void 0}});return(0,u.jsx)(nx.Z,{items:e,bordered:!1,style:{background:"transparent"}})},[l,d,o,r,c]);return(0,u.jsx)(q.Z,{title:(0,u.jsx)(B,{title:"Agent activity"}),bordered:!1,styles:{body:{padding:"1px 0 24px"}},extra:(0,u.jsx)(W,{}),children:h})};var nZ=n(72798),nE=n(42533),nN=n(46134),nP=n(20259);let{Title:nI,Paragraph:nM}=m.default,n_=e=>{var t,n,r;let{open:a,onClose:s}=e,{selectedAgentConfig:i}=(0,k.S)(),{evmHomeChainId:l}=i,{activeStakingProgramId:o}=(0,nP.x)();if(!a||!o)return null;let d=null===(t=nE.Z5[l])||void 0===t?void 0:t[o],c=null!==(r=null==d?void 0:null===(n=d.stakingRequirements)||void 0===n?void 0:n[tS.W.OLAS])&&void 0!==r?r:0;return(0,u.jsxs)(nZ.Z,{open:a,width:nN.iF,onCancel:s,footer:[(0,u.jsx)(f.ZP,{type:"primary",block:!0,size:"large",className:"mt-8",onClick:s,children:"Got it"},"ok")],children:[(0,u.jsx)(x.Z,{align:"center",justify:"center",children:(0,u.jsx)(v(),{src:"/splash-robot-head.png",width:100,height:100,alt:"OLAS logo"})}),(0,u.jsx)(nI,{level:5,className:"mt-12 text-center",children:"Your agent is running and you've staked ".concat(c," OLAS!")}),(0,u.jsx)(nM,{children:"Your agent is working towards earning rewards."}),(0,u.jsx)(nM,{children:"Supafund "})]})};var nA=n(56937),nL=n(13492),nF=n(77874),nO=n(81763),nR=n.n(nO);let nD=e=>{if(!nR()(e))return null;let t=Math.floor(Math.floor((new Date().getTime()-new Date(1e3*e).getTime())/1e3)/60),n=Math.floor(t/60),r=Math.floor(n/24);return r>0?1===r?"1 day ago":"".concat(r," days ago"):n>0?1===n?"1 hour ago":"".concat(n," hours ago"):t>0?1===t?"1 min ago":"".concat(t," mins ago"):"Few secs ago"},nB=e=>nR()(e)?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",timeZone:"UTC"}):"--",nz=e=>nR()(e)?new Date(e).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0,timeZone:"UTC"}):"--",nW=e=>nR()(e)?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0,timeZone:"UTC"}):"--",nH=e=>{let t=Math.floor(e/86400),n=Math.floor((e%=86400)/3600),r=Math.floor((e%=3600)/60),a=e%60,s=String(n).padStart(2,"0"),i=String(r).padStart(2,"0"),l=String(a).padStart(2,"0"),o="".concat(t," day").concat(1!==t?"s":""),d="".concat(s," hour").concat(1!==n?"s":""),c="".concat(i," minute").concat(1!==r?"s":""),u="".concat(l," second").concat(1!==a?"s":"");return"".concat(o," ").concat(d," ").concat(c," ").concat(u).trim()},{Paragraph:nq,Text:nU}=m.default,nY=(0,u.jsxs)(nU,{style:{color:P.r.RED},children:["Cannot start agent\xa0",(0,u.jsx)($.Z,{})]}),nG={arrow:!1,placement:"bottomRight"},nQ=()=>(0,u.jsx)(nF.Z,{...nG,title:"Unexpected error",content:(0,u.jsxs)("div",{style:{maxWidth:340},children:[(0,u.jsx)(nq,{children:"Try to restart the app. If the issue persists, join the Olas community Discord server to report or stay up to date on the issue."}),(0,u.jsxs)("a",{href:ea.av,target:"_blank",rel:"noreferrer",children:["Olas community Discord server ",er.$.EXTERNAL_LINK]})]}),children:nY}),n$=()=>{let{isAllStakingContractDetailsRecordLoaded:e}=(0,nL.n9)(),{evictionExpiresAt:t}=(0,nL.S9)();return e?(0,u.jsx)(nF.Z,{...nG,title:"Your agent is evicted",content:(0,u.jsxs)(x.Z,{vertical:!0,gap:8,className:"text-sm-all",style:{maxWidth:340},children:[(0,u.jsx)(nq,{className:"text-sm m-0",children:"You didn't run your agent enough and it missed its targets multiple times. You can run the agent again when the eviction period ends."}),t&&(0,u.jsxs)(nq,{className:"m-0",children:[(0,u.jsx)(nU,{className:"text-sm",children:"Eviction ends at"})," ",(0,u.jsxs)(nU,{strong:!0,className:"text-sm",children:[nW(1e3*t)," (UTC)"]})]})]}),children:nY}):null},nK=()=>(0,u.jsxs)("div",{style:{maxWidth:340},children:[(0,u.jsx)(nq,{children:"Join the Olas community Discord server to report or stay up to date on the issue."}),(0,u.jsxs)("a",{href:ea.av,target:"_blank",rel:"noreferrer",children:["Olas community Discord server ",er.$.EXTERNAL_LINK]})]}),nX=()=>(0,u.jsx)(nF.Z,{...nG,title:"No rewards available",content:(0,u.jsx)(nK,{}),children:nY}),nV=()=>(0,u.jsx)(nF.Z,{...nG,title:"No jobs available",content:(0,u.jsx)(nK,{}),children:nY}),nJ=()=>{let{isAllStakingContractDetailsRecordLoaded:e}=(0,nL.n9)(),{activeStakingProgramId:t}=(0,nP.x)(),{isAgentEvicted:n,isEligibleForStaking:r}=(0,nL.S9)(),{hasEnoughServiceSlots:a,isRewardsAvailable:s}=(0,nL.c5)(t);if(!e||r)return null;if(!a)return(0,u.jsx)(nV,{});if(!s)return(0,u.jsx)(nX,{});if(n)return(0,u.jsx)(n$,{});throw Error("Cannot start agent, please contact support")};var n0=n(68756),n1=n(3361),n2=n(56371);let n6=e=>{var t;let{storeState:n}=(0,ek.o)(),{selectedAgentType:r,selectedAgentConfig:a}=(0,k.S)(),s=n1.J9.find(e=>e.agentType===r),{selectedStakingProgramId:i}=(0,nP.x)(),{isLoaded:l}=(0,eo.AE)(),{masterSafeBalances:o}=(0,eo.PU)(),d=null==n?void 0:null===(t=n[r])||void 0===t?void 0:t.isInitialFunded,c=(0,p.useMemo)(()=>{if(ex()(s))return{};let t={};return Object.entries(s.configurations).forEach(n=>{var r,s,l,o,d;let[c,u]=n,p=(0,I.DH)(c),h=null!=e?e:i;if(!h)return;let m=u.monthly_gas_estimate,x=Number((0,n2.formatUnits)("".concat(m),18)),g=(0,tb.Ro)(p),f=(null===(l=nE.Z5[p])||void 0===l?void 0:null===(s=l[h])||void 0===s?void 0:null===(r=s.stakingRequirements)||void 0===r?void 0:r[tS.W.OLAS])||0,y=null!==(d=null===(o=a.additionalRequirements)||void 0===o?void 0:o[p])&&void 0!==d?d:{};t[p]={[tS.W.OLAS]:f,[g]:x,...y}}),t},[a.additionalRequirements,i,s,e]),u=(0,p.useMemo)(()=>{if(!(ex()(o)||eh()(o)))return o.reduce((e,t)=>{let{symbol:n,balance:r,evmChainId:a}=t;return e[a]||(e[a]={[n]:0}),e[a][n]||(e[a][n]=0),e[a][n]+=r,e},{})},[o]),h=(0,p.useMemo)(()=>{if(!ex()(c))return Object.keys(c).map(e=>e)},[c]),m=(0,p.useMemo)(()=>{if(!ex()(h)&&!eh()(u))return h.every(e=>{var t,n;let r=(0,tb.Ro)(e);return((null===(t=u[e])||void 0===t?void 0:t[r])||0)>=((null===(n=c[e])||void 0===n?void 0:n[r])||0)})},[h,c,u]),x=(0,p.useMemo)(()=>{if(!ex()(h)&&!eh()(u))return h.every(e=>{var t,n;return((null===(t=u[e])||void 0===t?void 0:t[tS.W.OLAS])||0)>=((null===(n=c[e])||void 0===n?void 0:n[tS.W.OLAS])||0)})},[h,c,u]),g=(0,p.useMemo)(()=>{if(!ex()(h)&&!eh()(u))return h.every(e=>{let t=(0,tb.Ro)(e),n=Object.keys(c[e]).filter(e=>e!==tS.W.OLAS&&e!==t);return 0===n.length||n.every(t=>{var n,r;return((null===(n=u[e])||void 0===n?void 0:n[t])||0)>=((null===(r=c[e])||void 0===r?void 0:r[t])||0)})})},[h,c,u]),f=(0,p.useMemo)(()=>!d&&!!l&&(!m||!x||!g),[g,m,x,l,d]);return{hasEnoughNativeTokenForInitialFunding:m,hasEnoughOlasForInitialFunding:x,hasEnoughAdditionalTokensForInitialFunding:g,balancesByChain:u,serviceFundRequirements:c,isInitialFunded:d,needsInitialFunding:f}};var n4=n(18209);let n5=()=>{let e=(0,p.useContext)(n4.w);if(!e)throw Error("useSharedContext must be used within SharedContext");return e};var n8=n(95423),n3=n(19537);let n9=()=>{let{showNotification:e}=(0,ei.Z)(),{isAgentsFunFieldUpdateRequired:t}=n5(),{goto:n}=(0,S.a)(),{masterWallets:r,masterSafes:a,masterEoa:s}=(0,eb.Q)(),{selectedService:i,setPaused:l,refetch:o,isLoading:d,selectedAgentConfig:c,selectedAgentType:u,overrideSelectedServiceStatus:h}=(0,k.S)(),m=null==i?void 0:i.service_config_id,{canStartAgent:x,isBalancesAndFundingRequirementsLoading:g}=(0,w.C)(),{service:f,isServiceRunning:y}=(0,ny.G)(m),{setIsPaused:v,updateBalances:j}=(0,eo.AE)(),{isAllStakingContractDetailsRecordLoaded:T,setIsPaused:C,refetchSelectedStakingContractDetails:Z}=(0,nL.n9)(),{selectedStakingProgramId:E,selectedStakingProgramMeta:N}=(0,nP.x)(),{isEligibleForStaking:P,isAgentEvicted:I,isServiceStaked:M,hasEnoughServiceSlots:_}=(0,nL.S9)(),{masterSafesOwners:A}=eS(a),{isInitialFunded:L,needsInitialFunding:F}=n6(E),O=(0,p.useMemo)(()=>!g&&!d&&!y&&!!T&&(!c.isUnderConstruction||!!c.hasExternalFunds)&&(null==N||!N.deprecated)&&(!!ex()(_)||!!_||!!M)&&(!I||!!P)&&(!i&&L?!F:!t&&x),[g,d,y,T,c.isUnderConstruction,c.hasExternalFunds,null==N?void 0:N.deprecated,_,M,I,P,i,L,F,t,x]),R=(0,p.useCallback)(()=>{l(!0),v(!0),C(!0)},[l,v,C]),D=(0,p.useCallback)(()=>{l(!1),v(!1),C(!1)},[l,v,C]),B=(0,p.useCallback)(async()=>{let t;if(!E)return;let n=n1.J9.find(e=>e.agentType===u);if(!n)throw Error("Service template not found for ".concat(u));if(!f)try{var r;let e=null===(r=nE.Z5[c.evmHomeChainId])||void 0===r?void 0:r[E];t=await n8.ServicesService.createService({stakingProgramId:E,serviceTemplate:n,deploy:!1,useMechMarketplace:(null==e?void 0:e.mechType)===n0.T.Marketplace})}catch(t){throw console.error("Failed to create service:",t),null==e||e("Failed to create service."),t}!t&&f&&await (0,n3.xc)(f,u);try{let e=null!=f?f:t;await n8.ServicesService.startService(e.service_config_id)}catch(t){throw console.error("Error while starting the service:",t),null==e||e("Failed to start service."),t}},[c.evmHomeChainId,u,E,f,e]),z=(0,p.useCallback)(async()=>{await (null==o?void 0:o()),await Z(),await j()},[o,Z,j]);return{isDeployable:O,handleStart:(0,p.useCallback)(async()=>{if(null==r?void 0:r[0]){if(!E)throw Error("Staking program ID required");if(!n1.J9.find(e=>e.agentType===u))throw Error("Service template required");R(),h(tv.E.DEPLOYING);try{await n7({masterSafes:a,masterSafesOwners:A,masterEoa:s,selectedAgentConfig:c,gotoSettings:()=>n(b.i.Settings)}),await B()}catch(t){throw console.error("Error during start:",t),null==e||e("An error occurred while starting. Please try again."),h(null),D(),t}try{await z()}catch(t){console.error("Failed to update states:",t),null==e||e("Failed to update state.")}h(tv.E.DEPLOYED),D(),await (0,e5.a)(5),h(null)}},[r,E,R,h,D,a,A,s,c,B,n,e,z,u]),buttonText:"Start agent ".concat(M?"":"& stake")}},n7=async e=>{let{masterSafes:t,masterSafesOwners:n,masterEoa:r,selectedAgentConfig:a,gotoSettings:s}=e;if(null==t?void 0:t.some(e=>{let{evmChainId:t}=e;return t===a.evmHomeChainId}))return;let i=new Set(null==n?void 0:n.filter(e=>{let{evmChainId:t}=e;return t!==a.evmHomeChainId}).map(e=>e.owners).flat());if(r&&i.delete(null==r?void 0:r.address),i.size<=0)throw es.ZP.error("A backup signer is required to create a new safe on the home chain. Please add a backup signer."),s(),Error("No backup signers found");if(1!==i.size)throw es.ZP.error("The same backup signer address must be used on all chains. Please remove any extra backup signers."),s(),Error("Multiple backup signers found");await ta.X.createSafe(a.middlewareHomeChainId,[...i][0])},re=()=>{let{isDeployable:e,handleStart:t,buttonText:n}=n9();return(0,u.jsx)(f.ZP,{type:"primary",size:"large",disabled:!e,onClick:e?t:void 0,children:n})};var rt=n(63448),rn=n(31934);let rr=rt.Km(["manage-wallet","withdraw-funds","last-transactions","rewards-streak","staking-contract-section","agent-activity","backup-via-safe","agent-settings","bridge-onboarding","bridge-add-funds","on-ramp"]),ra=rt.IM(rt.jb(rn.b),rt.IM(rr,rt.O7())).parse({[rn.b.Supafund]:{"manage-wallet":!0,"withdraw-funds":!0,"last-transactions":!0,"rewards-streak":!0,"staking-contract-section":!0,"agent-activity":!0,"backup-via-safe":!0,"agent-settings":!1,"bridge-onboarding":!0,"bridge-add-funds":!0,"on-ramp":!1}});function rs(e){var t;let{selectedAgentType:n}=(0,k.S)();t6(n,"Feature Flag must be used within a ServicesProvider");let r=ra[n];return(t6(r,"Agent type ".concat(n," is not supported.")),Array.isArray(e))?e.map(e=>{var t;return null!==(t=r[e])&&void 0!==t&&t}):null!==(t=r[e])&&void 0!==t&&t}var ri=n(40552),rl=n(79661),ro=n(35553);let rd=async(e,t,n,r,a)=>{let s=ey.a[a].provider;if(0===r)return[];let i=await s.getLogs({address:e,fromBlock:t,toBlock:n});return i.length>0?i:rd(e,t-9e3,t,r-1,a)},rc=async(e,t)=>{let n=ey.a[t].provider,r=await n.getBlockNumber(),a=await rd(e,r-9e3,r,5,t);if(0===a.length)return null;let s=a[a.length-1].transactionHash,i=await n.getTransactionReceipt(s);return{hash:s,timestamp:(await n.getBlock(i.blockNumber)).timestamp}};function ru(){let e=(0,H._)(["\n  line-height: 1;\n  span {\n    height: 12px !important;\n    margin-top: 2px !important;\n  }\n"]);return ru=function(){return e},e}let{Text:rp}=m.default,rh=(0,U.ZP)(eH.Z.Input)(ru()),rm=e=>{let{serviceConfigId:t}=e,{activeStakingProgramMeta:n}=(0,nP.x)(),{serviceSafes:r}=(0,ny.G)(t),a=null==r?void 0:r[0],s=null==n?void 0:n.chainId,[i,l]=(0,p.useState)(!0),[o,d]=(0,p.useState)(null),c=(0,p.useCallback)(async()=>{(null==a?void 0:a.address)&&s&&rc(a.address,s).then(e=>d(e)).catch(e=>console.error("Failed to get latest transaction",e)).finally(()=>l(!1))},[a,s]);return((0,rl.Yz)(()=>c(),ef.g7),(0,p.useEffect)(()=>{c()},[c]),i)?(0,u.jsx)(rh,{active:!0,size:"small"}):o?(0,u.jsxs)(rp,{type:"secondary",className:"text-xs",style:{whiteSpace:"nowrap"},children:["Tx:\xa0",(0,u.jsx)(rp,{type:"secondary",className:"text-xs pointer hover-underline",style:{whiteSpace:"nowrap"},onClick:()=>window.open("".concat(ea.Tz[(0,I.fG)(s)],"/tx/").concat(o.hash)),children:nD(o.timestamp)}),"\xa0",er.$.EXTERNAL_LINK]}):(0,u.jsx)(rp,{type:"secondary",className:"text-xs",children:"No txs recently!"})},{Text:rx}=m.default,rg=()=>(0,u.jsx)(tE.Z,{placement:"bottom",arrow:!1,overlayInnerStyle:{lineHeight:"normal"},title:(0,u.jsx)(rx,{className:"text-sm",children:"Your agent earned rewards for this epoch, so decided to stop working until the next epoch."}),children:(0,u.jsx)($.Z,{})}),rf=()=>{let{goto:e}=(0,S.a)();return(0,u.jsx)(f.ZP,{type:"link",className:"p-0 text-xs",style:{height:"auto",border:"none"},onClick:()=>e(b.i.AgentActivity),children:"What's my agent doing?"})},ry=()=>{let[e,t]=rs(["last-transactions","agent-activity"]),{showNotification:n}=(0,ei.Z)(),{isPageLoadedAndOneMinutePassed:r}=(0,S.a)(),{isEligibleForRewards:a}=(0,ri.D)(),{selectedService:s,isFetched:i,setPaused:l,overrideSelectedServiceStatus:o}=(0,k.S)(),d=i&&(null==s?void 0:s.service_config_id)?s.service_config_id:"",{service:c}=(0,ny.G)(d),h=(0,p.useCallback)(async()=>{if(c){o(tv.E.STOPPING);try{await n8.ServicesService.stopDeployment(c.service_config_id)}catch(e){console.error(e),null==n||n("Error while stopping agent")}finally{l(!1),o(null)}}},[o,c,l,n]),m=e&&r;return(0,u.jsxs)(x.Z,{gap:8,align:"center",children:[(0,u.jsx)(f.ZP,{type:"default",size:"large",onClick:h,children:"Pause"}),(0,u.jsxs)(x.Z,{vertical:!0,align:"start",children:[(0,u.jsxs)(x.Z,{style:{flexWrap:"nowrap",alignItems:"baseline",minWidth:0},children:[a?(0,u.jsxs)(rx,{type:"secondary",className:"text-xs",style:{whiteSpace:"nowrap",flex:"0 0 auto"},children:[(0,u.jsx)(rg,{}),"\xa0Idle"]}):(0,u.jsx)(rx,{type:"secondary",className:"text-xs ".concat(m?"":"loading-ellipses "),style:{whiteSpace:"nowrap",flex:"0 0 auto"},children:"Working"}),m&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(rx,{style:{lineHeight:1,flex:"0 0 auto"},children:["\xa0",er.$.SMALL_BULLET,"\xa0"]}),(0,u.jsx)("span",{style:{display:"inline-block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0,maxWidth:180,verticalAlign:"bottom"},children:(0,u.jsx)(rm,{serviceConfigId:d})})]})]}),t&&(0,u.jsx)(rf,{})]})]})},rv=()=>(0,u.jsx)(nF.Z,{trigger:["hover","click"],placement:"bottomLeft",showArrow:!1,content:(0,u.jsxs)(x.Z,{vertical:!1,gap:8,style:{maxWidth:260},children:[(0,u.jsx)(m.default.Text,{children:(0,u.jsx)($.Z,{style:{color:P.r.BLUE}})}),(0,u.jsx)(m.default.Text,{children:"Starting the agent may take a while, so feel free to minimize the app. We'll notify you once it's running. Please, don't quit the app."})]}),children:(0,u.jsx)(f.ZP,{type:"default",size:"large",ghost:!0,disabled:!0,loading:!0,children:"Starting..."})}),rj=()=>(0,u.jsx)(f.ZP,{type:"default",size:"large",ghost:!0,disabled:!0,loading:!0,children:"Stopping..."}),rb=()=>(0,u.jsx)("strong",{children:"Something went wrong"}),rw=()=>{let{isLoading:e,isSelectedServiceDeploymentStatusLoading:t,selectedService:n,selectedServiceStatusOverride:r}=(0,k.S)(),{selectedStakingProgramId:a}=(0,nP.x)(),{isEligibleForStaking:s,isAgentEvicted:i,isSelectedStakingContractDetailsLoading:l}=(0,nL.S9)(),o=null!=r?r:null==n?void 0:n.deploymentStatus,d=(0,p.useMemo)(()=>e||l||t||!a?(0,u.jsx)(f.ZP,{type:"primary",size:"large",disabled:!0,loading:!0,children:"Loading..."}):o===tv.E.STOPPING?(0,u.jsx)(rj,{}):o===tv.E.DEPLOYING?(0,u.jsx)(rv,{}):o===tv.E.DEPLOYED?(0,u.jsx)(ry,{}):!s&&i?(0,u.jsx)(nJ,{}):n&&o!==tv.E.STOPPED&&o!==tv.E.CREATED&&o!==tv.E.BUILT&&o!==tv.E.DELETED?(0,u.jsx)(nQ,{}):(0,u.jsx)(re,{}),[a,e,l,t,o,n,s,i]);return(0,u.jsx)(nA.ErrorBoundary,{errorComponent:rb,children:d})};var rS=n(73484);function rk(){let e=(0,H._)(["\n  position: relative;\n  top: -4px;\n  width: 42px;\n  height: 42px;\n  padding: 2px 0;\n  > div {\n    width: 100%;\n    height: 100%;\n  }\n"]);return rk=function(){return e},e}let rT=[-5,32.5],rC=U.ZP.div(rk()),rZ=e=>{let{isSupafund:t}=e;return(0,u.jsx)(rS.Z,{status:"processing",color:"orange",dot:!0,offset:rT,children:(0,u.jsx)(v(),{src:t?"/supafund-robot.svg":"/happy-robot.svg",alt:t?"Supafund Robot":"Happy Robot",width:40,height:40})})},rE=e=>{let{isSupafund:t}=e,[r,a]=(0,p.useState)(!1),[s,i]=(0,p.useState)(null);return((0,p.useEffect)(()=>{let e=!1;return a(!0),(async()=>{try{var t;let[{useLottie:r},a]=await Promise.all([Promise.all([n.e(296),n.e(260)]).then(n.t.bind(n,69260,23)),n.e(459).then(n.t.bind(n,60459,19))]),s=null!==(t=a.default)&&void 0!==t?t:a;e||i((0,u.jsx)(()=>{let{View:e}=r({animationData:s,loop:!0,autoplay:!0});return e},{}))}catch(e){console.error("Failed to load agent head animation:",e)}})(),()=>{e=!0}},[]),r&&s)?t?(0,u.jsx)(rC,{children:(0,u.jsx)(v(),{src:"/supafund-robot.svg",alt:"Supafund Robot",width:40,height:40})}):(0,u.jsx)(rC,{children:s}):(0,u.jsx)(rC,{children:(0,u.jsx)(v(),{src:t?"/supafund-robot.svg":"/happy-robot.svg",alt:t?"Supafund Robot":"Happy Robot",width:40,height:40})})},rN=e=>{let{isSupafund:t}=e;return(0,u.jsx)(rS.Z,{dot:!0,color:"red",offset:rT,children:(0,u.jsx)(v(),{src:t?"/supafund-robot.svg":"/sad-robot.svg",alt:t?"Supafund Robot":"Sad Robot",width:40,height:40})})},rP=e=>{let{isSupafund:t}=e;return(0,u.jsx)(rS.Z,{dot:!0,status:"processing",color:"green",offset:rT,children:(0,u.jsx)(v(),{src:t?"/supafund-robot.svg":"/idle-robot.svg",alt:t?"Supafund Robot":"Idle Robot",width:40,height:40})})},rI=()=>{let{selectedService:e,selectedAgentType:t}=(0,k.S)(),{isEligibleForRewards:n}=(0,ri.D)(),r=null==e?void 0:e.deploymentStatus,a=(0,p.useMemo)(()=>t===rn.b.Supafund,[t]);return r===tv.E.DEPLOYING||r===tv.E.STOPPING?(0,u.jsx)(rZ,{isSupafund:a}):r===tv.E.DEPLOYED?n?(0,u.jsx)(rP,{isSupafund:a}):(0,u.jsx)(rE,{isSupafund:a}):(0,u.jsx)(rN,{isSupafund:a})},rM=()=>{let{isLowBalance:e}=(0,eo.AE)(),{selectedService:t}=(0,k.S)(),{deploymentStatus:n}=(0,ny.G)(null==t?void 0:t.service_config_id),{setTrayIcon:r}=(0,ei.Z)();return(0,p.useEffect)(()=>{e?null==r||r("low-gas"):n===tv.E.DEPLOYED?null==r||r("running"):n===tv.E.STOPPED?null==r||r("paused"):n===tv.E.BUILT&&(null==r||r("logged-out"))},[e,n,r]),null},r_=()=>{let[e,t]=(0,p.useState)(!1),n=(0,p.useCallback)(()=>t(!1),[]);return rM(),(0,u.jsx)(th,{gap:6,padding:"12px 20px",children:(0,u.jsx)(x.Z,{justify:"space-between",align:"center",style:{minHeight:"32px"},children:(0,u.jsxs)(x.Z,{justify:"start",align:"center",gap:12,children:[(0,u.jsx)(rI,{}),(0,u.jsx)(rw,{}),(0,u.jsx)(n_,{open:e,onClose:n})]})})})},{Text:rA}=m.default,rL={marginBottom:"-1px"},rF=()=>{let{storeState:e}=(0,ek.o)(),{selectedService:t}=(0,k.S)(),{deploymentStatus:n}=(0,ny.G)(null==t?void 0:t.service_config_id);return(null==e?void 0:e.firstStakingRewardAchieved)||n!==tv.E.DEPLOYED?null:(0,u.jsx)(th,{style:rL,children:(0,u.jsx)(ee,{type:"info",fullWidth:!0,showIcon:!0,message:(0,u.jsxs)(x.Z,{vertical:!0,children:[(0,u.jsx)(rA,{children:"Your agent has not hit its target yet."}),(0,u.jsx)(rA,{children:"Keep the agent running to earn today's rewards."})]})})})};var rO=n(75685),rR=n(41664),rD=n.n(rR),rB=n(26250),rz=n(96104);let{Text:rW}=m.default,rH=()=>{let{selectedAgentConfig:e}=(0,k.S)(),{evmHomeChainId:t}=e;return(0,u.jsx)(th,{children:(0,u.jsx)(ee,{type:"warning",fullWidth:!0,showIcon:!0,message:(0,u.jsxs)(x.Z,{vertical:!0,gap:2.5,children:[(0,u.jsxs)(rW,{className:"text-base",strong:!0,children:["Only send funds on ",nc.NJ[t].name," Chain!"]}),(0,u.jsx)(rW,{className:"text-base",children:"You will lose any assets you send on other chains."})]})})})},rq=e=>{let{fundingAddress:t,truncatedFundingAddress:n,handleCopy:r}=e;return(0,u.jsxs)(th,{gap:10,justify:"center",align:"center",padding:"16px 24px",children:[(0,u.jsx)(tE.Z,{title:(0,u.jsx)("span",{className:"can-select-text flex",children:null!=t?t:"Unable to load address"}),children:(0,u.jsx)(rW,{title:t,children:null!=n?n:er.NA})}),(0,u.jsx)(f.ZP,{onClick:r,icon:(0,u.jsx)(tZ.Z,{}),size:"large"})]})},rU=()=>{let{selectedAgentConfig:e}=(0,k.S)(),{evmHomeChainId:t}=e;return(0,u.jsx)(th,{justify:"center",bordertop:"true",padding:"16px 24px",children:(0,u.jsxs)(rD(),{target:"_blank",href:ea.BV[t],children:["Get OLAS + ",nc.NJ[t].nativeToken.symbol," on"," ",nc.NJ[t].name," ",er.$.EXTERNAL_LINK]})})},rY=(0,p.forwardRef)((e,t)=>{let{selectedAgentConfig:n}=(0,k.S)(),{evmHomeChainId:r}=n,{masterSafes:a}=(0,eb.Q)(),s=(0,p.useMemo)(()=>{var e;return null==a?void 0:null===(e=a.find(e=>e.evmChainId===r))||void 0===e?void 0:e.address},[r,a]),i=(0,p.useMemo)(()=>s&&(0,rz.F)(s,4),[s]),l=(0,p.useCallback)(()=>s&&tN(s).then(()=>es.ZP.success("Copied successfully!")),[s]);return(0,u.jsxs)(x.Z,{vertical:!0,ref:t,children:[(0,u.jsx)(rH,{}),(0,u.jsx)(rq,{truncatedFundingAddress:i,fundingAddress:s,handleCopy:l}),(0,u.jsx)(rU,{})]})});rY.displayName="OpenAddFundsSection";let rG=(0,p.forwardRef)((e,t)=>{let[n,r]=rs(["bridge-onboarding","bridge-add-funds"]),{selectedAgentConfig:a}=(0,k.S)(),{goto:s}=(0,S.a)(),[i,l]=(0,p.useState)("transfer"),{evmHomeChainId:o}=a,d=nc.NJ[o];return(0,u.jsxs)(u.Fragment,{children:[n&&(0,u.jsx)(th,{gap:12,$padding:"24px",$borderTop:!0,children:(0,u.jsx)(rO.Z,{options:[{label:"Send on ".concat(d.name),value:"transfer"},{label:"Bridge from Ethereum",value:"bridge"}],onChange:l,value:i,block:!0,className:"w-full"})}),"bridge"===i?(0,u.jsxs)(th,{gap:12,justify:"center",align:"center",$padding:"16px 24px",$borderTop:!0,vertical:!0,children:[(0,u.jsxs)(rW,{className:"text-base",children:["Bridge funds from Ethereum directly to your Pearl Safe on"," ",rB.qD[o]," chain."]}),(0,u.jsx)(tE.Z,{title:r?"":"Available soon",children:(0,u.jsx)(f.ZP,{type:"primary",size:"large",block:!0,onClick:()=>s(b.i.AddFundsToMasterSafeThroughBridge),disabled:!r,children:"Bridge funds"})})]}):(0,u.jsx)(rY,{ref:t})]})});rG.displayName="AddFundsBy";let rQ=()=>{let{selectedAgentConfig:e}=(0,k.S)(),t=(0,p.useRef)(null),[n,r]=(0,p.useState)(!1),a=(0,p.useCallback)(async()=>{var e;r(!0),await (0,e5.a)(.1),null==t||null===(e=t.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[]),s=(0,p.useCallback)(()=>r(!1),[]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(th,{gap:12,padding:"24px",children:(0,u.jsx)(f.ZP,{type:"primary",size:"large",ghost:!e.isUnderConstruction,block:!0,disabled:!!e.isUnderConstruction,onClick:n?s:a,children:n?"Close instructions":"Add funds"})}),n&&(0,u.jsx)(rG,{ref:t})]})},{Text:r$}=m.default,rK=()=>{let{goto:e}=(0,S.a)(),{selectedAgentConfig:t}=(0,k.S)(),{masterSafes:n,masterEoa:r}=(0,eb.Q)(),{ownersIsFetched:a,backupOwners:s}=ew(null==n?void 0:n.find(e=>e.evmChainId===t.evmHomeChainId));return!a||t.isUnderConstruction||ex()(s)||eh()(s.filter(e=>!ex()(r)&&e===r.address))?null:(0,u.jsx)(ee,{type:"warning",fullWidth:!0,showIcon:!0,message:(0,u.jsxs)(x.Z,{align:"center",justify:"space-between",gap:2,children:[(0,u.jsx)("span",{children:"Add backup wallet"}),(0,u.jsx)(r$,{className:"pointer hover-underline text-primary",onClick:()=>e(b.i.AddBackupWalletViaSafe),children:"See instructions"})]})})},{Text:rX,Title:rV}=m.default,rJ=()=>{let{store:e}=(0,ei.Z)(),{storeState:t}=(0,ek.o)(),{selectedAgentConfig:n}=(0,k.S)(),[r,a]=(0,p.useState)(!1),[s,i]=(0,p.useState)(!1);(0,p.useEffect)(()=>{(null==t?void 0:t.agentEvictionAlertShown)&&a(!0)},[null==t?void 0:t.agentEvictionAlertShown]);let l=(0,p.useMemo)(()=>!!t&&(null==t?void 0:t.firstRewardNotificationShown)&&!(null==t?void 0:t.agentEvictionAlertShown),[t]),o=(0,p.useCallback)(async()=>{if(!s){i(!0);try{(null==e?void 0:e.set)&&await e.set("agentEvictionAlertShown",!0)}catch(e){console.error("Failed to update agentEvictionAlertShown flag",e)}finally{i(!1),a(!0)}}},[s,e]);return!l||r||n.isUnderConstruction?null:(0,u.jsx)(ee,{fullWidth:!0,type:"info",showIcon:!0,message:(0,u.jsxs)(x.Z,{vertical:!0,gap:8,align:"flex-start",children:[(0,u.jsx)(rV,{level:5,style:{margin:0},children:"Avoid suspension!"}),(0,u.jsx)(rX,{children:"Run your agent for at least half an hour a day to avoid missing targets. If it misses its targets 2 days in a row, it'll be suspended. You won't be able to run it or earn rewards for several days."}),(0,u.jsx)(f.ZP,{type:"primary",ghost:!0,loading:s,onClick:o,style:{marginTop:4},children:"Understood"})]})})},{Text:r0}=m.default,r1=()=>{let{selectedAgentConfig:e}=(0,k.S)(),{goto:t}=(0,S.a)(),{isActiveStakingProgramLoaded:n,selectedStakingProgramMeta:r}=(0,nP.x)(),{isSelectedStakingContractDetailsLoading:a}=(0,nL.S9)();return n&&!a&&r&&r.deprecated&&!e.isUnderConstruction?(0,u.jsx)(ee,{type:"error",fullWidth:!0,showIcon:!0,message:(0,u.jsxs)(x.Z,{justify:"space-between",gap:4,vertical:!0,children:[(0,u.jsxs)(r0,{className:"font-weight-600",children:[r.name||er.NA," contract is deprecated"]}),(0,u.jsx)("span",{className:"text-sm",children:"Switch to one of the available contracts to start your agent."}),(0,u.jsx)(r0,{className:"pointer hover-underline text-primary text-sm",onClick:()=>t(b.i.ManageStaking),children:"Change staking contract"})]})}):null};var r2=n(59854),r6=n.n(r2),r4=n(22447);function r5(){let e=(0,H._)(["\n  width: 100%;\n  margin-top: 8px;\n  background-color: ",";\n  color: ",";\n  border-radius: 8px;\n  box-sizing: border-box;\n  box-shadow:\n    0px 1px 2px 0px rgba(0, 0, 0, 0.03),\n    0px 1px 6px -1px rgba(0, 0, 0, 0.02),\n    0px 2px 4px 0px rgba(0, 0, 0, 0.02);\n"]);return r5=function(){return e},e}let{Text:r8}=m.default,r3=(0,U.ZP)(x.Z)(r5(),P.r.WHITE,P.r.TEXT),r9={padding:"8px 12px"},r7=e=>{let{text:t,address:n,extra:r,bridgeFunds:a}=e;return(0,u.jsxs)(r3,{vertical:!0,children:[(0,u.jsxs)(x.Z,{justify:"space-between",align:"center",style:r9,children:[(0,u.jsx)(r8,{strong:!0,children:t}),(0,u.jsxs)(x.Z,{gap:12,children:[(0,u.jsx)(r8,{children:(0,rz.F)(n)}),(0,u.jsx)(f.ZP,{size:"small",onClick:()=>tN(n),children:(0,u.jsx)(tZ.Z,{})})]})]}),r&&(0,u.jsx)(x.Z,{justify:"space-between",style:{borderTop:"1px solid ".concat(P.r.BORDER_GRAY),...r9},children:r}),a&&(0,u.jsxs)(x.Z,{justify:"space-between",style:{borderTop:"1px solid ".concat(P.r.BORDER_GRAY),...r9},children:[(0,u.jsx)(r8,{children:"Dont have assets on ".concat(a.chainName,"?")}),(0,u.jsx)(f.ZP,{size:"small",onClick:a.goto,children:"Bridge funds"})]})]})},ae=()=>{let{selectedAgentConfig:e}=(0,k.S)(),t=e.evmHomeChainId,{masterEoa:n,masterSafes:r}=(0,eb.Q)(),a=(0,p.useMemo)(()=>{if(r&&t)return r.find(e=>e.evmChainId===t)},[r,t]),{name:s,nativeToken:i}=nc.NJ[t];return{chainName:s,tokenSymbol:i.symbol,masterSafeAddress:null==a?void 0:a.address,masterEoaAddress:null==n?void 0:n.address}},{Text:at}=m.default,an={[rn.b.Supafund]:"for prediction market trading"},ar=e=>{let{stakingFundsRequired:t=!0,nativeFundsRequired:n=!0,additionalFundsRequired:r=!0}=e,{selectedStakingProgramId:a}=(0,nP.x)(),{serviceFundRequirements:s}=n6(a),{selectedAgentConfig:i,selectedAgentType:l}=(0,k.S)(),{evmHomeChainId:o}=i,d=(0,tb.Ro)(o),{chainName:c,masterSafeAddress:h}=ae(),m=(0,p.useMemo)(()=>{if(!s[o])return;let e=s[o][tS.W.OLAS];return"".concat(er.$.OLAS).concat(e," OLAS ")},[o,s]),g=(0,p.useMemo)(()=>{if(!s[o])return;let e=s[o][d];return"".concat(e," ").concat(d)},[o,s,d]),f=(0,p.useMemo)(()=>{if(!s[o])return[];let e=Object.keys(s[o]).filter(e=>e!==tS.W.OLAS&&e!==d);return 0===e.length?[]:e.map(e=>{var t;let n=null===(t=s[o])||void 0===t?void 0:t[e];return"".concat(n," ").concat(e)})},[o,s,d]),y=(0,p.useMemo)(()=>{let e=nc.NJ[o].name;return o===r4.C.Mode||o===r4.C.Optimism?"Get OLAS + USDC on ".concat(e):"Get OLAS on ".concat(e)},[o]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(at,{children:["To activate your agent, add these amounts on ",c," chain to your safe:"]}),(0,u.jsxs)(x.Z,{gap:0,vertical:!0,children:[t&&(0,u.jsxs)("div",{children:[er.$.BULLET," ",(0,u.jsx)(at,{strong:!0,children:m})," - for staking."]}),n&&(0,u.jsxs)("div",{children:[er.$.BULLET," ",(0,u.jsx)(at,{strong:!0,children:g})," -"," ".concat(an[l],".")]}),r&&f.map(e=>(0,u.jsxs)("div",{children:[er.$.BULLET," ",(0,u.jsx)(at,{strong:!0,children:e})," -"," ".concat(an[l],".")]},e))]}),h&&(0,u.jsx)(r7,{text:"Your safe address",address:h,extra:(0,u.jsxs)(rD(),{target:"_blank",href:ea.BV[o],children:[y," ",er.$.EXTERNAL_LINK]})})]})},{Text:aa,Title:as}=m.default,ai=()=>(0,u.jsx)(tg.Z,{style:{margin:"12px 0 8px 0",background:P.r.PURPLE_LIGHT}}),al=e=>{let{requiredSignerFunds:t}=e,{chainName:n,tokenSymbol:r,masterEoaAddress:a}=ae();return(0,u.jsx)(ee,{fullWidth:!0,showIcon:!0,message:(0,u.jsxs)(x.Z,{vertical:!0,gap:8,align:"flex-start",children:[(0,u.jsx)(as,{level:5,style:{margin:0},children:"Fund your agent"}),(0,u.jsxs)(aa,{children:["To keep your agent operational, add",(0,u.jsx)(aa,{strong:!0,children:" ".concat(t," ").concat(r," ")}),"on ",n," chain to the safe signer."]}),a&&(0,u.jsx)(r7,{text:"Your safe address",address:a}),(0,u.jsx)(ai,{}),(0,u.jsx)(ar,{stakingFundsRequired:!0,nativeFundsRequired:!0})]}),type:"primary"})},{Text:ao,Title:ad}=m.default,ac=()=>{var e;let t=rs("bridge-add-funds"),{goto:n}=(0,S.a)(),{storeState:r}=(0,ek.o)(),{selectedAgentType:a}=(0,k.S)(),{isMasterSafeLowOnNativeGas:s,masterSafeNativeGasRequirement:i}=(0,eo.PU)(),{chainName:l,tokenSymbol:o,masterSafeAddress:d}=ae();if(null==r?void 0:null===(e=r[a])||void 0===e?void 0:e.isInitialFunded)return s?(0,u.jsx)(ee,{fullWidth:!0,type:"error",showIcon:!0,message:(0,u.jsxs)(x.Z,{vertical:!0,gap:8,align:"flex-start",children:[(0,u.jsx)(ad,{level:5,style:{margin:0},children:"Operating balance is too low"}),(0,u.jsxs)(ao,{children:["To run your agent, add at least",(0,u.jsx)(ao,{strong:!0,children:" ".concat(i," ").concat(o," ")}),"on ",l," chain to your safe."]}),(0,u.jsx)(ao,{children:"Your agent is at risk of missing its targets, which would result in several days' suspension."}),d&&(0,u.jsx)(r7,{text:"Your safe address",address:d,bridgeFunds:t?{chainName:l,goto:()=>n(b.i.LowOperatingBalanceBridgeFunds)}:void 0})]})}):null},{Text:au,Title:ap}=m.default,ah=e=>{let{requiredSignerFunds:t}=e,n=rs("bridge-add-funds"),{goto:r}=(0,S.a)(),{chainName:a,tokenSymbol:s,masterEoaAddress:i}=ae();return(0,u.jsx)(ee,{fullWidth:!0,type:"error",showIcon:!0,message:(0,u.jsxs)(x.Z,{vertical:!0,gap:8,align:"flex-start",children:[(0,u.jsx)(ap,{level:5,style:{margin:0},children:"Safe signer balance is too low"}),(0,u.jsxs)(au,{children:["To keep your agent operational, add",(0,u.jsx)(au,{strong:!0,children:" ".concat(t," ").concat(s," ")}),"on ",a," chain to the safe signer."]}),(0,u.jsx)(au,{children:"Your agent is at risk of missing its targets, which would result in several days' suspension."}),i&&(0,u.jsx)(r7,{text:"Safe signer address",address:i,bridgeFunds:n?{chainName:a,goto:()=>r(b.i.LowSafeSignerBalanceBridgeFunds)}:void 0})]})})},{Title:am}=m.default,ax=()=>{let{selectedAgentType:e}=(0,k.S)(),{selectedStakingProgramId:t}=(0,nP.x)(),{hasEnoughNativeTokenForInitialFunding:n,hasEnoughOlasForInitialFunding:r,hasEnoughAdditionalTokensForInitialFunding:a,isInitialFunded:s,needsInitialFunding:i}=n6(t),l=(0,ei.Z)();return((0,p.useEffect)(()=>{if(n&&r&&a&&!s){var t,i;null===(i=l.store)||void 0===i||null===(t=i.set)||void 0===t||t.call(i,"".concat(e,".isInitialFunded"),!0)}},[l.store,e,n,r,a,s]),i)?(0,u.jsx)(ee,{fullWidth:!0,showIcon:!0,message:(0,u.jsxs)(x.Z,{vertical:!0,gap:8,align:"flex-start",children:[(0,u.jsx)(am,{level:5,style:{margin:0},children:"Fund your agent"}),e===rn.b.Supafund&&(0,u.jsx)(m.default.Text,{type:"secondary",children:"Note: 1.5 xDAI was deposited to your EOA to create a Safe, the rest were transferred to your agent wallet. Now fund your Safe with OLAS for staking."}),(0,u.jsx)(ar,{stakingFundsRequired:!r,nativeFundsRequired:!n,additionalFundsRequired:!a})]}),type:"primary"}):null},ag=()=>{let{selectedAgentConfig:e}=(0,k.S)(),{selectedStakingProgramId:t}=(0,nP.x)(),{totalStakedOlasBalance:n}=(0,eo.AE)(),{isMasterEoaLowOnGas:r,masterEoaGasRequirement:a}=(0,eo.PU)(),{balancesByChain:s,isInitialFunded:i}=n6(t),l=e.evmHomeChainId,o=(0,p.useMemo)(()=>{if(eh()(s)||!i)return!1;let e=s[l][tS.W.OLAS];return 0===r6()(s[l][(0,tb.Ro)(l)],4)&&0===r6()(e+(null!=n?n:0),4)&&!!r},[i,l,r,n,s]);return e.isUnderConstruction?null:(0,u.jsxs)(u.Fragment,{children:[o&&(0,u.jsx)(al,{requiredSignerFunds:a}),(0,u.jsx)(ax,{}),(0,u.jsx)(ac,{}),!o&&r&&(0,u.jsx)(ah,{requiredSignerFunds:a})]})},{Text:af}=m.default,ay=()=>{let{goto:e}=(0,S.a)(),{selectedAgentConfig:t}=(0,k.S)(),{isActiveStakingProgramLoaded:n,selectedStakingProgramId:r,selectedStakingProgramMeta:a}=(0,nP.x)(),{isServiceStaked:s,isSelectedStakingContractDetailsLoading:i}=(0,nL.S9)(),{hasEnoughServiceSlots:l}=(0,nL.c5)(r);return!n||i||l||s||t.isUnderConstruction?null:(0,u.jsx)(ee,{type:"warning",fullWidth:!0,showIcon:!0,message:(0,u.jsxs)(x.Z,{justify:"space-between",gap:4,vertical:!0,children:[(0,u.jsxs)(af,{className:"font-weight-600",children:["No available staking slots on"," ",(null==a?void 0:a.name)||er.NA]}),(0,u.jsx)("span",{className:"text-sm",children:"Select a contract with available slots to start your agent."}),(0,u.jsx)(af,{className:"pointer hover-underline text-primary text-sm",onClick:()=>e(b.i.ManageStaking),children:"Change staking contract"})]})})},{Text:av}=m.default,aj=e=>{let{showMoreInfo:t=!1}=e,{selectedAgentConfig:n}=(0,k.S)(),{goto:r}=(0,S.a)(),{mainOlasBalance:a}=n5(),s=n.hasExternalFunds;return n.isUnderConstruction?(0,u.jsx)(ee,{type:"warning",fullWidth:!0,showIcon:!0,message:(0,u.jsxs)(x.Z,{justify:"space-between",gap:4,vertical:!0,children:[(0,u.jsx)(av,{className:"font-weight-600",children:"Agent is under construction"}),(0,u.jsxs)("div",{className:"text-sm",children:["The agent is temporarily unavailable due to technical issues for an unspecified time."," ",t&&(s?"You can withdraw agent funds at any time":"You can start your agent to withdraw its funds at any time."),t&&(0!==a||s)&&(0,u.jsx)("div",{className:"w-fit",children:(0,u.jsx)(f.ZP,{onClick:()=>r(b.i.ManageWallet),size:"small",className:"text-sm mt-8",children:"Withdraw"})})]})]})}):null},{Text:ab}=m.default,aw=()=>{let{goto:e}=(0,S.a)(),{isAgentsFunFieldUpdateRequired:t}=n5(),{selectedAgentConfig:n}=(0,k.S)();return!t||n.isUnderConstruction?null:(0,u.jsx)(ee,{type:"error",fullWidth:!0,showIcon:!0,message:(0,u.jsxs)(x.Z,{justify:"space-between",align:"flex-start",gap:4,vertical:!0,children:[(0,u.jsx)(ab,{className:"font-weight-600",children:"Action required: Update agents configurations"}),(0,u.jsx)(ab,{className:"text-sm",children:"The latest update almost eliminates the possibility of your X account being suspended. To benefit from these improvements, you need to update your agent's configurations."}),(0,u.jsx)(f.ZP,{type:"default",size:"small",onClick:()=>e(b.i.UpdateAgentTemplate),className:"mt-4",children:"Update configurations"})]})})};var aS=n(33161),ak=n(81249),aT=n.n(ak);let aC=e=>(0,u.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,u.jsx)("path",{d:"M16.5858 6L4.29289 18.2929C3.90237 18.6834 3.90237 19.3166 4.29289 19.7071C4.68342 20.0976 5.31658 20.0976 5.70711 19.7071L18 7.41421V11C18 11.5523 18.4477 12 19 12C19.5523 12 20 11.5523 20 11V5.00069L20 4.997C19.9992 4.74208 19.9016 4.48739 19.7071 4.29289C19.6112 4.19702 19.5007 4.12468 19.3828 4.07588C19.2649 4.02699 19.1356 4 19 4H13C12.4477 4 12 4.44772 12 5C12 5.55228 12.4477 6 13 6H16.5858Z"})});(r=l||(l={}))[r.OUTDATED=-1]="OUTDATED",r[r.EQUAL=0]="EQUAL",r[r.UPDATED=1]="UPDATED";let aZ=()=>{let{getAppVersion:e}=(0,ei.Z)(),[,t]=(0,aS.ZP)(),{data:n,isFetched:r}=(0,ed.a)({queryKey:["isPearlOutdated"],queryFn:async()=>{if(!e)return console.error("electronAPI.getAppVersion is not available in Window"),!1;let t=await e();if(!t)return!1;let n=await fetch(ea.GH);if(!n.ok)return!1;let r=(await n.json()).tag_name,a=aT().parse(r),s=aT().parse(null!=t?t:"0.0.0");return!!a&&!!s&&-1===aT().compare(t,a)},refetchInterval:ef.U2});return r&&n?(0,u.jsx)(ee,{type:"info",fullWidth:!0,showIcon:!0,message:(0,u.jsxs)(x.Z,{align:"center",justify:"space-between",gap:2,children:[(0,u.jsx)("span",{children:"A new version of Pearl is available"}),(0,u.jsxs)("a",{href:ea._9,target:"_blank",children:["Download"," ",(0,u.jsx)(aC,{fill:t.colorPrimary,style:{marginBottom:-2}})]})]})}):null};var aE=n(86791);let{Text:aN}=m.default,{useToken:aP}=aE.default,aI=()=>{let{getAppVersion:e,store:t}=(0,ei.Z)(),{token:n}=aP(),[r,a]=(0,p.useState)(!1),[s,i]=(0,p.useState)(null);return((0,p.useEffect)(()=>{(async()=>{if(!e)return;let n=await e();if(n&&aT().valid(n)&&(i(n),null==t?void 0:t.get)){let e=await (null==t?void 0:t.get("knownVersion"));(!e||aT().gt(n,e))&&a(!0)}})()},[e,t]),r&&s)?(0,u.jsx)(ee,{type:"info",fullWidth:!0,showIcon:!0,closable:!0,onClose:()=>{s&&(null==t?void 0:t.set)&&t.set("knownVersion",s),a(!1)},message:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(aN,{children:"Read "}),(0,u.jsxs)("a",{href:"https://github.com/valory-xyz/olas-operate-app/releases/tag/v".concat(s),target:"_blank",rel:"noopener noreferrer",children:["what's new in Pearl"," ",(0,u.jsx)(aC,{fill:n.colorPrimary,style:{marginBottom:-2}})]})," ",(0,u.jsx)(aN,{children:"and discover specific agent updates."})]})}):null},aM=()=>{let e=rs("backup-via-safe");return(0,u.jsxs)(th,{vertical:!0,$borderTop:!0,children:[(0,u.jsx)(aI,{}),(0,u.jsx)(aZ,{}),e&&(0,u.jsx)(rK,{}),(0,u.jsx)(aj,{showMoreInfo:!0}),(0,u.jsx)(r1,{}),(0,u.jsx)(rJ,{}),(0,u.jsx)(aw,{}),(0,u.jsx)(ag,{}),(0,u.jsx)(ay,{})]})};var a_=n(29146);function aA(){let e=(0,H._)(["\n  position: relative;\n  display: inline-block;\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  margin-right: 8px;\n  border: 2px solid #ffffff;\n  box-shadow:\n    rgb(0 0 0 / 7%) 0px 2px 4px 0px,\n    rgb(0 0 0 / 3%) 0px 0px 4px 2px;\n"]);return aA=function(){return e},e}function aL(){let e=(0,H._)(["\n  background-color: ",";\n"]);return aL=function(){return e},e}function aF(){let e=(0,H._)(["\n  background-color: ",";\n"]);return aF=function(){return e},e}function aO(){let e=(0,H._)(["\n  font-size: 77.5%;\n  a {\n    margin-top: 6px;\n    display: inline-block;\n  }\n"]);return aO=function(){return e},e}let{Text:aR}=m.default,aD=U.ZP.span(aA()),aB=(0,U.ZP)(aD)(aL(),P.r.RED),az=(0,U.ZP)(aD)(aF(),P.r.GREEN_2),aW=()=>{let{isLoaded:e}=(0,eo.AE)(),{isFetched:t,selectedAgentType:n,selectedService:r}=(0,k.S)(),{storeState:a}=(0,ek.o)(),{showNotification:s}=(0,ei.Z)(),{isMasterSafeLowOnNativeGas:i}=(0,eo.PU)(),{isServiceSafeLowOnNativeGas:l}=(0,eo.Lz)(null==r?void 0:r.service_config_id),[o,d]=(0,p.useState)(!1),c=(0,p.useMemo)(()=>{let e=!ex()(i),t=!ex()(l);if(!e&&!t)return!1;let n=!!l;return!!i||n},[i,l]);(0,p.useEffect)(()=>{var r;e&&t&&s&&(null==a?void 0:null===(r=a[n])||void 0===r?void 0:r.isInitialFunded)&&(c&&!o&&(s("Operating balance is too low."),d(!0)),!c&&o&&d(!1))},[e,o,c,t,n,s,a]);let{statusName:h,StatusComponent:m}=(0,p.useMemo)(()=>e&&t?c?{statusName:"Too low",StatusComponent:aB}:{statusName:"Fine",StatusComponent:az}:{statusName:"Loading...",StatusComponent:aB},[e,c,t]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(m,{}),(0,u.jsx)(aR,{children:h})]})},aH=U.ZP.div(aO()),aq=()=>{let{selectedAgentConfig:e}=(0,k.S)(),{evmHomeChainId:t}=e,{masterSafes:n}=(0,eb.Q)(),{isLoaded:r}=(0,eo.AE)(),a=(0,p.useMemo)(()=>{if(!ex()(n))return n.find(e=>e.evmChainId===t)},[t,n]),s=(0,p.useMemo)(()=>{if(!a)return;let e=ea.Tz[(0,I.fG)(t)]+"/address/"+a.address;return(0,u.jsxs)("a",{href:e,target:"_blank",children:["Track activity on blockchain explorer"," ",(0,u.jsx)(a_.Z,{style:{rotate:"45deg"}})]})},[a,t]);return(0,u.jsxs)(th,{justify:"space-between",bordertop:"true",borderbottom:"true",padding:"16px 24px",children:[(0,u.jsxs)(aR,{type:"secondary",children:["Operating balance\xa0",a&&(0,u.jsx)(tE.Z,{title:(0,u.jsxs)(aH,{children:["Your agent uses this balance to fund on-chain activity.",(0,u.jsx)("br",{}),s]}),children:(0,u.jsx)($.Z,{})})]}),r?(0,u.jsx)(aR,{strong:!0,children:(0,u.jsx)(aW,{})}):(0,u.jsx)(eH.Z.Button,{active:!0,size:"small",style:{width:96}})]})};var aU=n(13520),aY=n(60802);let aG=e=>{let{value:t,formatter:n=M.mT,triggerAnimation:r=!0,onAnimationChange:a}=e,[s,i]=(0,p.useState)(ex()(t)?0:t),l=(0,aU.q)(0,{stiffness:150,damping:25});return(0,p.useEffect)(()=>{ex()(t)||(r?l.set(t):i(t))},[t,l,r]),(0,p.useEffect)(()=>{if(!r)return;let e=Date.now(),n=l.on("change",n=>{let r=Date.now();r-e>100&&(e=r,i(parseFloat(n.toFixed(2)))),a&&a(Math.abs(n-(null!=t?t:0))>=.01)});return()=>n()},[l,t,r,a]),(0,u.jsx)(aY.E.span,{children:n?n(s):s})};var aQ=n(19685);function a$(){let e=(0,H._)(["\n  letter-spacing: -2px;\n  margin-right: 4px;\n"]);return a$=function(){return e},e}let{Text:aK}=m.default,aX=U.ZP.span(a$()),aV=()=>(0,u.jsx)(eH.Z.Button,{active:!0,size:"large",style:{margin:"8px 4px 0px 0px",width:160}}),aJ=()=>{let e=rs("manage-wallet"),{goto:t}=(0,S.a)(),{isMainOlasBalanceLoading:n,mainOlasBalance:r,hasMainOlasBalanceAnimatedOnLoad:a,setMainOlasBalanceAnimated:s}=n5(),[i,l]=(0,p.useState)(!1),o=(0,aQ.D)(r);(0,p.useEffect)(()=>{!n&&nR()(r)&&!a&&s(!0)},[n,r,a,s]);let d=(0,p.useMemo)(()=>!!i||!n&&!!nR()(r)&&(!a||(!a||!!nR()(o))&&r!==o),[i,n,r,o,a]),c=(0,p.useCallback)(e=>{l(e)},[]);return(0,u.jsx)(th,{vertical:!0,gap:8,$borderTop:!0,$borderBottom:!0,$padding:"16px 24px",children:(0,u.jsxs)(x.Z,{vertical:!0,gap:8,children:[(0,u.jsxs)(x.Z,{align:"center",justify:"space-between",children:[(0,u.jsx)(aK,{type:"secondary",children:"Current balance"}),e&&(0,u.jsx)(f.ZP,{size:"small",disabled:n,onClick:()=>t(b.i.ManageWallet),className:"text-sm",children:"Manage wallet"})]}),(0,u.jsxs)(x.Z,{align:"end",children:[(0,u.jsx)("span",{className:"balance-symbol",children:er.$.OLAS}),n?(0,u.jsx)(aV,{}):(0,u.jsx)(aX,{className:"balance",children:(0,u.jsx)(aG,{value:r,triggerAnimation:i||!!d,onAnimationChange:c})}),(0,u.jsx)("span",{className:"balance-currency",children:"OLAS"})]})]})})};var a0=n(21550),a1=n(13114),a2=n(47309),a6=n(49155),a4=n.n(a6);let a5={position:"fixed",pointerEvents:"none",width:"100%",height:"100%",top:0,left:0},a8=()=>{let e=(0,p.useRef)(null),t=(0,p.useCallback)((t,n)=>{e.current&&e.current({...n,origin:{y:.45},particleCount:Math.floor(200*t)})},[]),n=(0,p.useCallback)(()=>{t(.25,{spread:26,startVelocity:55}),t(.2,{spread:60}),t(.35,{spread:80,decay:.91,scalar:.8}),t(.1,{spread:100,startVelocity:25,decay:.92,scalar:1.2}),t(.1,{spread:100,startVelocity:45})},[t]),r=(0,p.useCallback)(t=>{e.current=t},[]);return(0,rl.Yz)(()=>n(),2500),(0,u.jsx)(a4(),{refConfetti:r,style:a5})},{Text:a3,Title:a9}=m.default,a7=e=>void 0===e?er.NA:"~".concat((0,M.mT)(e,2)),se=()=>{let{isEligibleForRewards:e,availableRewardsForEpochEth:t}=(0,ri.D)(),{mainOlasBalance:n}=(0,a2.K)(),{showNotification:r,store:a}=(0,ei.Z)(),{storeState:s}=(0,ek.o)(),i=(0,p.useRef)(void 0),l=(0,p.useRef)(!1),[o,d]=(0,p.useState)(!1),c=(0,p.useMemo)(()=>(0,M.mT)(n,2),[n]),h=(0,p.useMemo)(()=>(0,M.mT)(t,2),[t]);(0,p.useEffect)(()=>{e&&s&&(null==s||!s.firstRewardNotificationShown)&&t&&(l.current||(i.current=t,d(!0),l.current=!0))},[e,t,s]),(0,p.useEffect)(()=>{if(!o)return;let e=a7(i.current);null==r||r("First rewards earned!","Congratulations! Your agent just got the first reward for you! Your current balance: ".concat(e," OLAS"))},[o,r]);let m=(0,p.useCallback)(()=>{var e;d(!1),null==a||null===(e=a.set)||void 0===e||e.call(a,"firstRewardNotificationShown",!0)},[a]),g=(0,p.useCallback)(()=>{let e=encodeURIComponent(" Supafund \uD83D\uDE80"),t=encodeURIComponent("".concat(ea.fZ,"?supafund=first-reward"));window.open("https://twitter.com/intent/tweet?text=".concat(e,"&url=").concat(t),"_blank")},[]);return o?(0,u.jsxs)(nZ.Z,{open:o,width:400,onCancel:m,footer:[(0,u.jsx)(f.ZP,{type:"primary",block:!0,size:"large",className:"mt-8",onClick:g,children:(0,u.jsxs)(x.Z,{align:"center",justify:"center",gap:2,children:["Share on",(0,u.jsx)(v(),{src:"/twitter.svg",width:24,height:24,alt:"Share on twitter"})]})},"back")],children:[(0,u.jsx)(a8,{}),(0,u.jsx)(x.Z,{align:"center",justify:"center",children:(0,u.jsx)(v(),{src:"/splash-robot-head.png",width:100,height:100,alt:"OLAS logo"})}),(0,u.jsx)(a9,{level:5,className:"mt-12",children:"Your agent just earned the first reward!"}),(0,u.jsxs)(x.Z,{vertical:!0,gap:16,children:[(0,u.jsxs)(a3,{children:["Congratulations! Your agent just earned the first",(0,u.jsx)(a3,{strong:!0,children:" ".concat(h," OLAS ")}),"for you!"]}),(0,u.jsxs)(a3,{children:["Your current balance:",(0,u.jsx)(a3,{strong:!0,children:" ".concat(c," OLAS ")})]}),(0,u.jsx)(a3,{children:"Keep it running to get even more!"})]})]}):null};var st=n(98421),sn=n(67371);let sr=()=>(0,u.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,u.jsx)("path",{d:"M12.5114 23.4582C4.60184 23.4582 2.48853 15.213 3.44379 9.8107C3.48537 9.57557 3.79357 9.50784 3.92787 9.70527C4.34374 10.3165 4.71382 11.1994 5.32699 11.1228C6.2486 11.0076 6.88709 2.8753 12.3492 0.587102C12.5225 0.514492 12.7039 0.652258 12.6849 0.839195C12.4148 3.48918 14.0059 7.28301 16.8247 7.28301C18.4406 7.28301 19.5462 5.99338 20.0986 4.69823C20.2664 4.30481 20.8413 4.3544 20.9375 4.77116C21.9233 9.04063 24.5586 23.4582 12.5114 23.4582Z",fill:"#C2CBD7"}),(0,u.jsx)("path",{d:"M9.73857 15.5074C9.92457 15.3511 10.2069 15.4584 10.2492 15.6976C10.348 16.2575 10.6729 17.2196 11.7388 17.2196C13.0209 17.2196 13.891 13.6916 14.1192 12.654C14.1567 12.4833 14.3231 12.3674 14.4944 12.4022C17.6985 13.0537 19.2564 23.458 12.2114 23.458C7.08273 23.458 8.24462 16.7625 9.73857 15.5074Z",fill:"#A3AEBB"})]}),sa=()=>(0,u.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,u.jsx)("path",{d:"M12.5114 23.4582C4.60184 23.4582 2.48853 15.213 3.44379 9.8107C3.48537 9.57557 3.79357 9.50784 3.92787 9.70527C4.34374 10.3165 4.71382 11.1994 5.32699 11.1228C6.2486 11.0076 6.88709 2.8753 12.3492 0.587102C12.5225 0.514492 12.7039 0.652258 12.6849 0.839195C12.4148 3.48918 14.0059 7.28301 16.8247 7.28301C18.4406 7.28301 19.5462 5.99338 20.0986 4.69823C20.2664 4.30481 20.8413 4.3544 20.9375 4.77116C21.9233 9.04063 24.5586 23.4582 12.5114 23.4582Z",fill:"#FF8F1F"}),(0,u.jsx)("path",{d:"M9.73857 15.5074C9.92457 15.3511 10.2069 15.4584 10.2492 15.6976C10.348 16.2575 10.6729 17.2196 11.7388 17.2196C13.0209 17.2196 13.891 13.6916 14.1192 12.654C14.1567 12.4833 14.3231 12.3674 14.4944 12.4022C17.6985 13.0537 19.2564 23.458 12.2114 23.458C7.08273 23.458 8.24462 16.7625 9.73857 15.5074Z",fill:"#FFB636"})]});var ss=n(80108),si=n(7739),sl=n.n(si);function so(){let e=(0,H._)(["\n  {\n    checkpoints(\n      orderBy: epoch\n      orderDirection: desc\n      first: 1000\n      where: {\n        contractAddress_in: [","]\n      }\n    ) {\n      id\n      availableRewards\n      blockTimestamp\n      contractAddress\n      epoch\n      epochLength\n      rewards\n      serviceIds\n      transactionHash\n    }\n  }\n"]);return so=function(){return e},e}let sd=rt.Ry({epoch:rt.Z_({message:"Expected epoch to be a string"}),rewards:rt.IX(rt.Z_(),{message:"Expected rewards to be an array of strings"}),serviceIds:rt.IX(rt.Z_(),{message:"Expected serviceIds to be an array of strings"}),blockTimestamp:rt.Z_({message:"Expected blockTimestamp to be a string"}),transactionHash:rt.Z_({message:"Expected transactionHash to be a string"}),epochLength:rt.Z_({message:"Expected epochLength to be a string"}),contractAddress:rt.Z_({message:"Expected contractAddress to be a valid Ethereum address"}),availableRewards:rt.Z_({message:"Expected availableRewards to be a string"}).optional().nullable()}),sc=rt.IX(sd),su=e=>{var t;let n=Object.values(null!==(t=nE.Xy[e])&&void 0!==t?t:{}).map(e=>'"'.concat(e,'"'));return(0,ss.Ps)(so(),n)},sp=()=>{let{selectedAgentConfig:e}=(0,k.S)(),{serviceApi:t,evmHomeChainId:n}=e;return(0,p.useCallback)((e,r,a,s)=>r&&0!==r.length&&e?r.map((a,i)=>{var l,o,d,c,u,p,h,m,x,g,f,y,v;let j=null!==(c=null===(l=a.serviceIds)||void 0===l?void 0:l.findIndex(t=>Number(t)===e))&&void 0!==c?c:-1,b=(null==s?void 0:s.treatMissingServiceIdsAsSelf)&&(null!==(u=null===(o=a.serviceIds)||void 0===o?void 0:o.length)&&void 0!==u?u:0)===0,w="0",S=!1;if(-1!==j){let e=null===(p=a.rewards)||void 0===p?void 0:p[j];w=isFinite(Number(e))&&null!=e?e:"0",S=-1!==j}else if(b){let e=null!==(x=null!==(m=a.availableRewards)&&void 0!==m?m:null===(h=a.rewards)||void 0===h?void 0:h[0])&&void 0!==x?x:"0",t=isFinite(Number(e));w=t&&null!=e?e:"0",S=!!t&&Number(null!=e?e:"0")>0}let k="0"===a.epoch?Number(a.blockTimestamp)-Number(a.epochLength):null!==(g=null===(d=r[i+1])||void 0===d?void 0:d.blockTimestamp)&&void 0!==g?g:0,T=t.getStakingProgramIdByAddress(n,a.contractAddress),C=b?[...null!==(f=a.serviceIds)&&void 0!==f?f:[],"".concat(e)]:null!==(y=a.serviceIds)&&void 0!==y?y:[];return{...a,serviceIds:C,epochEndTimeStamp:Number(null!==(v=a.blockTimestamp)&&void 0!==v?v:Date.now()),epochStartTimeStamp:Number(k),reward:Number(ro.formatUnits(w,18)),earned:S,contractName:T}}).filter(e=>!a||!!e&&!!e.epochEndTimeStamp&&e.epochEndTimeStamp<a):[],[t,n])},sh=(e,t,n)=>{let r=sp(),a=(0,p.useMemo)(()=>(null==n?void 0:n.treatMissingServiceIdsAsSelfFor)?Array.from(n.treatMissingServiceIdsAsSelfFor).map(e=>e.toLowerCase()).sort().join("|"):null,[null==n?void 0:n.treatMissingServiceIdsAsSelfFor]);return(0,ed.a)({queryKey:[...ev.p.REWARDS_HISTORY_KEY(e,t),a],queryFn:async()=>{let t=await (0,ss.WY)(ea.Xx[e],su(e)),n=sc.safeParse(t.checkpoints);return n.error?(console.error(n.error),[]):n.data},select:e=>{if(!t||ex()(e)||eh()(e))return{};let a=sl()(e,"contractAddress");return Object.keys(a).reduce((e,s)=>{var i,l;let o=a[s];if(!o||o.length<=0)return e;let d=null!==(l=null==n?void 0:null===(i=n.treatMissingServiceIdsAsSelfFor)||void 0===i?void 0:i.has(s.toLowerCase()))&&void 0!==l&&l;if(!(o.some(e=>e.serviceIds.includes("".concat(t)))||d))return e;let c=r(t,o,null,{treatMissingServiceIdsAsSelf:d});return{...e,[s]:c}},{})},enabled:!!t,refetchInterval:864e5,refetchOnWindowFocus:!1})},sm=()=>{var e,t,n;let{selectedService:r,selectedAgentConfig:a}=(0,k.S)(),{evmHomeChainId:s}=a,i=null==r?void 0:r.service_config_id,{service:l}=(0,ny.G)(i),{selectedStakingProgramId:o}=(0,nP.x)(),d=null==l?void 0:null===(n=l.chain_configs)||void 0===n?void 0:null===(t=n[(0,I.fG)(s)])||void 0===t?void 0:null===(e=t.chain_data)||void 0===e?void 0:e.token,c=(0,p.useMemo)(()=>(null==l?void 0:l.chain_configs)?new Set(Object.values(l.chain_configs).map(e=>{var t,n;return(null==e?void 0:null===(n=e.chain_data)||void 0===n?void 0:null===(t=n.user_params)||void 0===t?void 0:t.staking_program_id)?e.chain_data.user_params.staking_program_id:void 0}).filter(e=>!!e)):new Set,[null==l?void 0:l.chain_configs]),u=(0,p.useMemo)(()=>{let e=new Set,t=t=>{var n;if(!t)return;let r=null===(n=nE.Xy[s])||void 0===n?void 0:n[t];r&&e.add(r.toLowerCase())};return o&&t(o),c.forEach(t),e},[s,o,c]),{isError:h,isLoading:m,isFetched:x,refetch:g,data:f}=sh(s,d,{treatMissingServiceIdsAsSelfFor:u}),y=(0,p.useMemo)(()=>Object.values(null!=f?f:{}).flat().sort((e,t)=>t.epochEndTimeStamp-e.epochEndTimeStamp),[f]),v=(0,p.useMemo)(()=>{if(m||!x||!f)return 0;let e=y.filter(e=>e.earned),t=Math.trunc(Date.now()/1e3),n=!1;return e.reduce((r,a,s)=>{if(n)return r;if(0===s)return Math.trunc(t-a.epochEndTimeStamp)>Number(a.epochLength)?(n=!0,r):a.earned?r+1:(n=!0,r);let i=e[s-1].epochStartTimeStamp-a.epochEndTimeStamp;return a.earned&&i<=Number(a.epochLength)?r+1:(n=!0,r)},0)},[m,x,f,y]);return(0,p.useEffect)(()=>{d&&g()},[g,d]),{isError:h,isFetched:x,isLoading:m,latestRewardStreak:v,refetch:g,allCheckpoints:y,contractCheckpoints:f}};function sx(){let e=(0,H._)(["\n  padding: 8px 16px;\n  height: 40px;\n  background: ",";\n  border-radius: 6px;\n  margin-bottom: 16px;\n"]);return sx=function(){return e},e}let{Text:sg}=m.default,sf=(0,U.ZP)(x.Z)(sx(),P.r.GRAY_1),sy=()=>{let{isLoaded:e}=(0,eo.AE)(),{isEligibleForRewards:t}=(0,ri.D)(),{latestRewardStreak:n,isLoading:r,isError:a}=sm(),s=t?n+1:n,i=(0,p.useCallback)(()=>{let e=encodeURIComponent("\uD83C\uDF89  Supafund  ".concat(s," #olas")),t=encodeURIComponent("".concat(ea.fZ,"?supafund=share-streak"));window.open("https://twitter.com/intent/tweet?text=".concat(e,"&url=").concat(t),"_blank")},[s]);return r||!e?(0,u.jsx)(eH.Z.Input,{active:!0,size:"small"}):a?er.NA:(0,u.jsx)(x.Z,{gap:6,align:"center",children:s>0?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(sa,{})," ",s," day streak",(0,u.jsx)(tE.Z,{arrow:!1,title:"Share streak on X",placement:"top",children:(0,u.jsx)(f.ZP,{type:"link",onClick:i,icon:(0,u.jsx)(st.Z,{style:{fontSize:"20px",color:P.r.GRAY_2}})})})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(sr,{})," No streak"]})})},sv=()=>{let{goto:e}=(0,S.a)();return(0,u.jsxs)(sf,{align:"center",justify:"space-between",children:[(0,u.jsx)(sy,{}),(0,u.jsxs)(sg,{type:"secondary",className:"text-sm pointer hover-underline",onClick:()=>e(b.i.RewardsHistory),children:["See rewards history",(0,u.jsx)(sn.Z,{style:{fontSize:12,paddingLeft:6}})]})]})},sj=rt.Ry({epoch:rt.Z_(),epochLength:rt.Z_(),blockTimestamp:rt.Z_()});function sb(){let e=(0,H._)(['\n  query {\n    checkpoints(\n      orderBy: epoch\n      orderDirection: desc\n      first: 1\n      where: {\n        contractAddress: "','"\n      }\n    ) {\n      epoch\n      epochLength\n      blockTimestamp\n    }\n  }\n']);return sb=function(){return e},e}let sw=e=>(0,ss.Ps)(sb(),e),sS=async(e,t)=>{let n=await (0,ss.WY)(ea.Xx[e],sw(t));return sj.parse(n.checkpoints[0])},{Text:sk}=m.default,sT=()=>{let{selectedAgentConfig:e}=(0,k.S)(),t=e.evmHomeChainId,{activeStakingProgramAddress:n}=(0,nP.x)(),{data:r,isLoading:a}=(0,ed.a)({queryKey:ev.p.LATEST_EPOCH_TIME_KEY(t,n),queryFn:async()=>await sS(t,n),select:e=>Number(e.blockTimestamp)+Number(e.epochLength),enabled:!!n&&!!t,refetchOnWindowFocus:!1});return{data:r,isLoading:a}},sC=()=>{let{data:e}=sT(),{isActiveStakingProgramLoaded:t,activeStakingProgramMeta:n,defaultStakingProgramMeta:r}=(0,nP.x)(),a=t?n||r:null,s=(0,p.useMemo)(()=>t?n?(0,u.jsxs)("div",{style:{maxWidth:nN.sN},children:["The epoch for ",null==a?void 0:a.name," ends each day at ~"," ",(0,u.jsx)(sk,{className:"text-sm",strong:!0,children:e?"".concat(nz(1e3*e)," (UTC)"):er.NA})]}):(0,u.jsx)("div",{style:{maxWidth:nN.sN},children:"You're not yet in a staking program!"}):(0,u.jsx)(eH.Z.Input,{}),[n,e,t,null==a?void 0:a.name]);return(0,u.jsxs)(sk,{type:"secondary",children:["Staking rewards this epoch\xa0",(0,u.jsx)(nF.Z,{arrow:!1,content:s,children:(0,u.jsx)($.Z,{})})]})};function sZ(){let e=(0,H._)(["\n  position: relative;\n  top: -14px;\n"]);return sZ=function(){return e},e}let{Text:sE}=m.default,sN=()=>(0,u.jsx)(eH.Z.Button,{active:!0,size:"small",style:{position:"relative",top:-2,width:60}}),sP=()=>(0,u.jsx)(eH.Z.Input,{size:"small",style:{position:"relative",top:12}}),sI={initial:"initial",animate:"animate",exit:"exit",variants:{initial:{y:10,opacity:0},animate:{y:0,opacity:1,transition:{duration:.5}},exit:{y:-10,opacity:0,transition:{duration:.5}}},style:{position:"absolute"}},sM=U.ZP.div(sZ()),s_=()=>{let{availableRewardsForEpochEth:e,isEligibleForRewards:t,isStakingRewardsDetailsLoading:n}=(0,ri.D)(),{selectedStakingProgramId:r}=(0,nP.x)(),a=n||!r,s=(0,p.useMemo)(()=>a?(0,u.jsx)(sN,{}):void 0===e?er.NA:"~".concat((0,M.mT)(e,2)),[a,e]),i=(0,p.useMemo)(()=>a?(0,u.jsx)(sP,{}):(0,u.jsx)(a1.M,{children:t?(0,u.jsx)(aY.E.div,{...sI,children:(0,u.jsx)(a0.Z,{color:"success",children:"Earned"})},"earned"):(0,u.jsx)(aY.E.div,{...sI,children:(0,u.jsx)(a0.Z,{color:"processing",children:"Not yet earned"})},"not-earned")}),[t,a]);return(0,u.jsxs)(th,{vertical:!0,gap:8,padding:"16px 24px",align:"start",children:[(0,u.jsx)(sC,{}),(0,u.jsxs)(x.Z,{align:"center",gap:12,children:[(0,u.jsxs)(sE,{className:"text-xl font-weight-600",children:[s," OLAS\xa0"]}),(0,u.jsx)(sM,{children:i})]})]})},sA=()=>{let e=rs("rewards-streak");return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(s_,{}),e&&(0,u.jsx)(sv,{}),(0,u.jsx)(se,{})]})},{Text:sL}=m.default,sF=()=>{let{goto:e}=(0,S.a)(),{isActiveStakingProgramLoaded:t,selectedStakingProgramMeta:n}=(0,nP.x)(),{isAllStakingContractDetailsRecordLoaded:r}=(0,nL.n9)(),{selectedService:a}=(0,k.S)(),{selectedAgentConfig:s}=(0,k.S)(),{isServiceTransitioning:i}=(0,ny.G)(null==a?void 0:a.service_config_id),l=(0,p.useMemo)(()=>t?(0,u.jsxs)(f.ZP,{type:"link",className:"p-0",onClick:()=>e(b.i.ManageStaking),disabled:!r||i||s.isUnderConstruction,children:[(null==n?void 0:n.name)||er.NA,(0,u.jsx)(sn.Z,{})]}):(0,u.jsx)(eH.Z.Input,{}),[t,r,i,s,null==n?void 0:n.name,e]);return(0,u.jsx)(th,{padding:"16px 24px",children:(0,u.jsxs)(x.Z,{gap:16,justify:"space-between",align:"center",style:{width:"100%"},children:[(0,u.jsx)(sL,{type:"secondary",children:"Staking contract"}),l]})})};var sO=n(84632);let{Title:sR}=m.default,sD=e=>{var t;let{onNavigateToDashboard:n,canNavigateToDashboard:r,renderAsCard:a=!0,showBackToMain:s}=e,{goto:i}=(0,S.a)(),{goto:l}=tn(),o=rs("staking-contract-section"),{selectedStakingProgramId:d}=(0,nP.x)(),{hasEnoughNativeTokenForInitialFunding:c,hasEnoughOlasForInitialFunding:m,hasEnoughAdditionalTokensForInitialFunding:g,isInitialFunded:y}=n6(d),v=(0,p.useMemo)(()=>void 0!==c&&void 0!==m&&void 0!==g,[g,c,m]),j=(0,p.useMemo)(()=>!0===c&&!0===m&&!0===g,[g,c,m]),w=(0,p.useMemo)(()=>!0===y||v&&j,[j,v,y]),k=null!==(t=null!=r?r:w)&&void 0!==t&&t,[T]=(0,p.useState)(()=>!(!0===y||j));(0,p.useEffect)(()=>{!y&&T&&j&&l(sO.Q.SetupYourAgent)},[j,T,l,y]);let C=(null!=s?s:!n)&&(!0===y||j),Z=!!n,E=!k,N=(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(q.Z,{style:{marginBottom:"12px"},children:(0,u.jsxs)(x.Z,{align:"center",justify:"space-between",gap:12,children:[(0,u.jsxs)(x.Z,{align:"center",gap:12,children:[C?(0,u.jsx)(f.ZP,{icon:(0,u.jsx)(h.Z,{}),onClick:()=>i(b.i.Main),type:"text"}):null,(0,u.jsx)(sR,{level:4,style:{margin:0},children:"Supafund Agent"})]}),Z?(0,u.jsx)(tE.Z,{arrow:!1,placement:"bottomRight",title:E?"Insufficient funds to open the dashboard":"View Supafund Dashboard",children:(0,u.jsx)("span",{children:(0,u.jsx)(f.ZP,{type:"default",disabled:E,onClick:n,style:{minWidth:"120px"},children:"Dashboard"})})}):null]})}),(0,u.jsx)(q.Z,{styles:{body:{paddingTop:0,paddingBottom:12,overflow:"hidden"}},style:{borderTopColor:"transparent"},children:(0,u.jsxs)(x.Z,{vertical:!0,children:[(0,u.jsx)(aM,{}),(0,u.jsx)(aJ,{}),(0,u.jsx)(sA,{}),o&&(0,u.jsx)(sF,{}),(0,u.jsx)(aq,{}),(0,u.jsx)(rQ,{})]})})]});return a?(0,u.jsx)(G,{children:N}):(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"16px",marginTop:"16px"},children:N})},sB=()=>{let{goto:e}=(0,S.a)(),{selectedAgentType:t}=(0,k.S)(),{hasEnoughNativeTokenForInitialFunding:n,hasEnoughOlasForInitialFunding:r,hasEnoughAdditionalTokensForInitialFunding:a,isInitialFunded:s}=n6(void 0),i=(0,p.useMemo)(()=>t===rn.b.Supafund,[t]),l=(0,p.useMemo)(()=>{if(!0===s)return!0;let e=[n,r,a];return!!e.every(e=>null!=e)&&e.every(e=>!0===e)},[a,n,r,s]);return i?(0,u.jsxs)(G,{$padding:"12px",style:{overflowX:"hidden"},children:[(0,u.jsx)(r_,{}),(0,u.jsx)(rF,{}),(0,u.jsx)(sD,{renderAsCard:!1,onNavigateToDashboard:()=>e(b.i.SupafundDashboard),canNavigateToDashboard:l,showBackToMain:!1})]}):null};var sz=n(68406),sW=n(8348);let sH=e=>e.replace(/\s+/g," ").replace(/\u00a0/g," ").trim(),sq=e=>{if(!e)return"Untitled market";let[t]=e.split("<contextStart>"),n=sH(t);return n.length>0?n:"Untitled market"},sU=(e,t)=>{let n=sH(e);return 0===n.length?0===t?"YES":1===t?"NO":"Outcome ".concat(t):n},sY=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:140;return e.length<=t?e:"".concat(e.substring(0,t-1).trimEnd(),"")},sG={"0xe91d153e0b41518a2ce8dd3d7944fa863463a97d":{symbol:"XDAI",usdPegged:!0},"0x0000000000000000000000000000000000000000":{symbol:"ETH",usdPegged:!1}},sQ=e=>e&&sG[e.toLowerCase()]||{symbol:"Collateral",usdPegged:!1},s$=e=>{if(!e)return 0;let t=Number(e);return Number.isFinite(t)?t/1e18:0},sK=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!Number.isFinite(e))return 0;let n=10**t;return Math.round(e*n)/n},sX=(e,t,n)=>Math.min(Math.max(e,t),n),sV=()=>Math.floor(Date.now()/1e3),sJ=e=>{if(!e)return;let t=Number(e);return Number.isFinite(t)?t:void 0},s0=e=>{let t=Math.abs(e),n=Math.floor(t/86400),r=Math.floor(t%86400/3600),a=Math.floor(t%3600/60);return n>0?r>0?"".concat(n,"d ").concat(r,"h"):"".concat(n,"d"):r>0?a>0?"".concat(r,"h ").concat(a,"m"):"".concat(r,"h"):a>0?"".concat(a,"m"):"".concat(Math.max(1,Math.floor(t)),"s")},s1=e=>{if(!e)return"Unknown";let t=e-sV();return t<=0?"Resolved":"in ".concat(s0(t))},s2=e=>{let t=sV()-e;if(t>=0)return t<60?"".concat(Math.max(1,t),"s ago"):t<3600?"".concat(Math.floor(t/60),"m ago"):t<86400?"".concat(Math.floor(t/3600),"h ago"):"".concat(Math.floor(t/86400),"d ago");let n=Math.abs(t);return n<60?"in ".concat(Math.max(1,Math.floor(n)),"s"):n<3600?"in ".concat(Math.floor(n/60),"m"):n<86400?"in ".concat(Math.floor(n/3600),"h"):"in ".concat(Math.floor(n/86400),"d")},s6=(e,t)=>{let n=e.toLowerCase();return n.includes("no")?"NO":n.includes("yes")?"YES":0===t?"YES":"NO"},s4=e=>{let t=new Map,n=new Map;if(!e||0===e.length)return{aggregations:t,perTrade:n};let r=[...e].sort((e,t)=>Number(e.creationTimestamp)-Number(t.creationTimestamp)),a=sV(),s=a-604800,i=a-2592e3;return r.forEach(e=>{var r,a,l,o,d,c,u,p,h,m,x,g,f,y;let v=Number(null!==(a=e.outcomeIndex)&&void 0!==a?a:"0"),j="".concat(e.fpmm.id,"-").concat(v),b=s$(e.outcomeTokensTraded),w=s$(e.collateralAmount),S=s$(e.feeAmount),k=Number(e.creationTimestamp),T=null!==(l=e.fpmm.outcomes)&&void 0!==l?l:[],C=0===v?"YES":1===v?"NO":"Outcome ".concat(v),Z=sU(null!==(o=T[v])&&void 0!==o?o:C,v),E=sq(e.fpmm.title),N=t.get(j);N||(N={key:j,marketId:e.fpmm.id,marketTitle:E,outcomeIndex:v,outcomeName:Z,category:null!==(h=null!==(p=e.fpmm.category)&&void 0!==p?p:null===(d=e.fpmm.question)||void 0===d?void 0:d.category)&&void 0!==h?h:"General",conditionId:null!==(m=null===(c=e.fpmm.condition)||void 0===c?void 0:c.id)&&void 0!==m?m:null,collateralToken:null!==(x=e.collateralToken)&&void 0!==x?x:null,openingTimestamp:sJ(e.fpmm.openingTimestamp),resolutionTimestamp:sJ(e.fpmm.resolutionTimestamp),currentPrice:sX(Number.parseFloat(null!==(g=null===(u=e.fpmm.outcomeTokenMarginalPrices)||void 0===u?void 0:u[v])&&void 0!==g?g:"0")||0,0,1),netTokens:0,costBasis:0,realizedPnL:0,realizedPnLWeekly:0,realizedPnLMonthly:0,winTrades:0,closedTrades:0,totalFees:0,lastTradeTimestamp:k},t.set(j,N)),N.marketTitle=E,N.outcomeName=Z,N.collateralToken=null!==(f=e.collateralToken)&&void 0!==f?f:N.collateralToken;let P=Number.parseFloat(null!==(y=null===(r=e.fpmm.outcomeTokenMarginalPrices)||void 0===r?void 0:r[v])&&void 0!==y?y:"");Number.isNaN(P)||(N.currentPrice=sX(P,0,1)),N.lastTradeTimestamp=Math.max(N.lastTradeTimestamp,k),N.totalFees+=S;let I=0;if(b>0){if("Buy"===e.type){let e=w+S;N.netTokens+=b,N.costBasis+=e}else{let e=Math.max(w-S,0),t=b>0?e/b:0,n=N.netTokens,r=N.costBasis,a=Math.min(b,Math.max(n,0));if(a>0&&n>0){let e=r/n*a;I+=t*a-e,N.netTokens=n-a,N.costBasis=Math.max(r-e,0)}let l=b-a;l>0&&(I+=t*l,N.netTokens-=l,N.netTokens<=1e-6&&(N.netTokens=0,N.costBasis=0)),N.realizedPnL+=I,N.closedTrades+=1,k>=s&&(N.realizedPnLWeekly+=I),k>=i&&(N.realizedPnLMonthly+=I),I>0&&(N.winTrades+=1)}}n.set(e.id,{realizedPnL:I,price:b>0?"Buy"===e.type?(w+S)/b:Math.max(w-S,0)/b:0,tokens:b,fee:S,type:e.type,outcomeName:N.outcomeName,marketTitle:N.marketTitle,marketId:N.marketId,timestamp:k})}),t.forEach(e=>{0!==e.netTokens&&1e-6>=Math.abs(e.netTokens)&&(e.netTokens=0,e.costBasis=0)}),{aggregations:t,perTrade:n}},s5=e=>{var t,n,r,a;let s=null!==(n=null===(t=e.outcomeTokenMarginalPrices)||void 0===t?void 0:t.map(e=>Number.parseFloat(e)).filter(e=>Number.isFinite(e)))&&void 0!==n?n:[];if(0===s.length)return"No liquidity";let i=Math.max(...s),l=s.indexOf(i),o=null!==(a=(null!==(r=e.outcomes)&&void 0!==r?r:[])[l])&&void 0!==a?a:0===l?"YES":1===l?"NO":"Outcome ".concat(l);return"".concat((100*i).toFixed(1),"% ").concat(o)},s8=e=>{var t;let n=sV(),r=sJ(e.resolutionTimestamp);if(r&&r<=n)return"Resolved";let a=sJ(e.openingTimestamp);return s1(null!==(t=null!=a?a:r)&&void 0!==t?t:sJ(e.creationTimestamp))},s3=e=>{if(!e)return;let t=Number(e);if(!Number.isFinite(t)||t<=0)return;let n=Math.log2(t),r=Math.round(n);if(!(Math.abs(n-r)>1e-6))return r},s9=e=>{if(!e||0===e.length)return{totalProfitLoss:0,totalProfitLossPercentage:0,activePositions:0,winRate:0,weeklyPerformance:0,monthlyPerformance:0};let{aggregations:t}=s4(e),n=sV(),r=0,a=0,s=0,i=0,l=0,o=0,d=0;t.forEach(e=>{s+=e.realizedPnL,i+=e.realizedPnLWeekly,l+=e.realizedPnLMonthly,o+=e.winTrades,d+=e.closedTrades,e.netTokens>1e-6&&(r+=e.costBasis,a+=e.netTokens*e.currentPrice)});let c=s+(a-r),u=r>0?c/r*100:0,p=Array.from(t.values()).filter(e=>e.netTokens>1e-6&&(!e.resolutionTimestamp||e.resolutionTimestamp>n)).length,h=d>0?o/d*100:0,m=r>0?r:void 0,x=m?i/m*100:0,g=m?l/m*100:0;return{totalProfitLoss:sK(c),totalProfitLossPercentage:sK(u),activePositions:p,winRate:sK(h),weeklyPerformance:sK(x),monthlyPerformance:sK(g)}},s7=e=>e&&0!==e.length?[...e].sort((e,t)=>Number(t.creationTimestamp)-Number(e.creationTimestamp)).slice(0,10).map(e=>{var t,n,r;let a=sY(sq(e.title),80);return{id:e.id,title:a,marketLeader:s5(e),category:null!==(r=null!==(n=e.category)&&void 0!==n?n:null===(t=e.question)||void 0===t?void 0:t.category)&&void 0!==r?r:"General",expiresIn:s8(e)}}):[],ie=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{aggregations:r}=s4(t);if(0===r.size)return[];let a=new Map;null==e||e.forEach(e=>{var t,n,r;let s=null===(t=e.position.conditionIds)||void 0===t?void 0:t[0];if(!s)return;let i=s3(null===(n=e.position.indexSets)||void 0===n?void 0:n[0]);if(void 0===i)return;let l="".concat(s.toLowerCase(),"-").concat(i),o=s$(e.balance);if(o<=0)return;let d=null!==(r=a.get(l))&&void 0!==r?r:0;a.set(l,d+o)});let s=sV(),i=[];return r.forEach(e=>{var t,r,l,o,d,c,u,p,h;let m=e.conditionId?"".concat(e.conditionId.toLowerCase(),"-").concat(e.outcomeIndex):void 0,x=m?a.get(m):void 0,g=void 0!==x?x:e.netTokens;if(g<=1e-6)return;let f=e.conditionId?n[e.conditionId.toLowerCase()]:void 0,y=null!==(r=sJ(null==f?void 0:f.resolutionTimestamp))&&void 0!==r?r:e.resolutionTimestamp,v=null!==(l=sJ(null==f?void 0:f.openingTimestamp))&&void 0!==l?l:e.openingTimestamp,j=sQ(null!==(d=null!==(o=null==f?void 0:f.collateralToken)&&void 0!==o?o:e.collateralToken)&&void 0!==d?d:void 0),b=e.netTokens>1e-6&&g>0?e.costBasis*(g/e.netTokens):e.costBasis,w=g>0?b/g:0,S=null!==(c=e.currentPrice)&&void 0!==c?c:w,k=Number.parseFloat(null!==(u=null==f?void 0:null===(t=f.outcomeTokenMarginalPrices)||void 0===t?void 0:t[e.outcomeIndex])&&void 0!==u?u:"");Number.isFinite(k)&&(S=sX(k,0,1));let T=g*(S-w),C=e.realizedPnL+T,Z=void 0!==y&&y<=s,E=Z?"Resolved":s1(Z?y:null!=v?v:y),N=sY(sq(null!==(p=null==f?void 0:f.title)&&void 0!==p?p:e.marketTitle),120),P=g*S;i.push({id:e.key,market:N,direction:s6(e.outcomeName,e.outcomeIndex),entryPrice:sK(w),currentPrice:sK(S),size:sK(g,4),pnl:sK(C),pnlPercentage:sK(b>0?C/b*100:0),timeRemaining:E,status:Z?"CLOSED":"OPEN",category:null!==(h=null==f?void 0:f.category)&&void 0!==h?h:e.category,entryValue:sK(b),currentValue:sK(P),collateralSymbol:j.symbol,collateralIsStable:j.usdPegged,marketAddress:e.marketId})}),i.sort((e,t)=>e.status===t.status?t.pnl-e.pnl:"OPEN"===e.status?-1:1)},it=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||0===e.length)return[];let{perTrade:n}=s4(e);return[...e].sort((e,t)=>Number(t.creationTimestamp)-Number(e.creationTimestamp)).slice(0,20).map(e=>{var r,a,s,i,l,o,d,c,u,p;let h=n.get(e.id),m=null!==(i=null==h?void 0:h.tokens)&&void 0!==i?i:s$(e.outcomeTokensTraded),x=null!==(l=null==h?void 0:h.price)&&void 0!==l?l:0,g=null!==(d=null!==(o=null==h?void 0:h.outcomeName)&&void 0!==o?o:null===(r=e.fpmm.outcomes)||void 0===r?void 0:r[Number(e.outcomeIndex)])&&void 0!==d?d:"Outcome ".concat(e.outcomeIndex),f="Buy"===e.type?"Bought":"Sold",y=sU(g,Number(null!==(c=e.outcomeIndex)&&void 0!==c?c:"0")),v=null!==(u=null==h?void 0:h.realizedPnL)&&void 0!==u?u:0,j=Math.abs(v)>1e-4,b=m>0?"".concat(sK(m,2)," @ ").concat(sK(x,2)):"No size recorded",w=null===(s=e.fpmm.condition)||void 0===s?void 0:null===(a=s.id)||void 0===a?void 0:a.toLowerCase(),S=w?t[w]:void 0,k=sq(null!==(p=null==S?void 0:S.title)&&void 0!==p?p:e.fpmm.title),T=sY("".concat(k,"  ").concat(b),160);return{id:e.id,type:"Buy"===e.type?"POSITION_OPENED":"POSITION_CLOSED",title:"".concat(f," ").concat(y),description:T,timestamp:s2(Number(e.creationTimestamp)),result:j?{pnl:sK(v)}:void 0}})};function ir(){let e=(0,H._)(["\n    query GetUserTrades($userAddress: String!) {\n      fpmmTrades(\n        where: { creator: $userAddress }\n        orderBy: creationTimestamp\n        orderDirection: desc\n        first: 100\n      ) {\n        id\n        title\n        collateralToken\n        collateralAmount\n        feeAmount\n        outcomeTokensTraded\n        outcomeIndex\n        type\n        creationTimestamp\n        transactionHash\n        fpmm {\n          id\n          title\n          outcomes\n          outcomeTokenMarginalPrices\n          openingTimestamp\n          category\n          resolutionTimestamp\n          currentAnswer\n          condition {\n            id\n          }\n          question {\n            id\n            title\n            category\n          }\n        }\n      }\n    }\n  "]);return ir=function(){return e},e}function ia(){let e=(0,H._)(['\n    query GetMarketOpportunities {\n      fixedProductMarketMakers(\n        where: { \n          creator: "','",\n          resolutionTimestamp: null,\n          creationTimestamp_gt: "','"\n        }\n        orderBy: creationTimestamp\n        orderDirection: desc\n        first: 20\n      ) {\n        id\n        title\n        outcomes\n        outcomeTokenMarginalPrices\n        collateralToken\n        fee\n        creationTimestamp\n        category\n        openingTimestamp\n        resolutionTimestamp\n        currentAnswer\n        question {\n          id\n          title\n          category\n        }\n      }\n    }\n  ']);return ia=function(){return e},e}function is(){let e=(0,H._)(['\n    query GetUserPositions($userAddress: String!) {\n      user(id: $userAddress) {\n        userPositions(\n          where: { balance_gt: "0" }\n          first: 50\n        ) {\n          id\n          balance\n          wrappedBalance\n          position {\n            id\n            conditionIds\n            indexSets\n          }\n        }\n      }\n    }\n  ']);return is=function(){return e},e}function ii(){let e=(0,H._)(["\n    query MarketsByCondition($conditionIds: [String!]!) {\n      fixedProductMarketMakers(where: { condition_in: $conditionIds }) {\n        id\n        title\n        outcomes\n        outcomeTokenMarginalPrices\n        collateralToken\n        fee\n        creationTimestamp\n        category\n        openingTimestamp\n        resolutionTimestamp\n        currentAnswer\n        condition {\n          id\n        }\n        question {\n          id\n          title\n          category\n        }\n      }\n    }\n  "]);return ii=function(){return e},e}let il={OMEN:"https://omen.subgraph.autonolas.tech",CONDITIONAL_TOKENS:"https://conditional-tokens.subgraph.autonolas.tech"},io=async e=>{if(!e)return console.warn("No user address provided for trades query"),[];let t=(0,ss.Ps)(ir());try{console.log("\uD83D\uDD0D Querying trades for user: ".concat(e));let n=await (0,ss.WY)(il.OMEN,t,{userAddress:e.toLowerCase()}),r=(null==n?void 0:n.fpmmTrades)||[];return console.log("\uD83D\uDCCA Found ".concat(r.length," trades for user ").concat(e)),r}catch(e){return console.error("Failed to fetch user trades:",e),[]}},id=async()=>{let e="0xf765a1FE2E15d0246430CCE854D2c923a85AF388",t=(0,ss.Ps)(ia(),e,Math.floor(Date.now()/1e3)-2592e3);try{console.log("\uD83D\uDD0D Querying markets for creator: ".concat(e));let n=await (0,ss.WY)(il.OMEN,t),r=(null==n?void 0:n.fixedProductMarketMakers)||[];return console.log("\uD83D\uDCCA Found ".concat(r.length," markets by creator ").concat(e)),r.length>0&&console.log("\uD83D\uDCDD Sample market: ".concat(r[0].title.substring(0,100),"...")),r}catch(e){return console.error("Failed to fetch market opportunities:",e),[]}},ic=async e=>{if(!e)return[];let t=(0,ss.Ps)(is());try{var n;console.log("\uD83D\uDD0D Querying positions for user: ".concat(e));let r=await (0,ss.WY)(il.CONDITIONAL_TOKENS,t,{userAddress:e.toLowerCase()}),a=(null==r?void 0:null===(n=r.user)||void 0===n?void 0:n.userPositions)||[];return console.log("\uD83D\uDCCA Found ".concat(a.length," positions for user ").concat(e)),a}catch(e){return console.error("Failed to fetch user positions:",e),[]}},iu=(e,t)=>{if(t<=0)return[e];let n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n},ip=async e=>{if(!e||0===e.length)return{};let t=Array.from(new Set(e.map(e=>null==e?void 0:e.toLowerCase()).filter(e=>!!e)));if(0===t.length)return{};let n=(0,ss.Ps)(ii()),r={};for(let e of iu(t,40))try{var a;let t=await (0,ss.WY)(il.OMEN,n,{conditionIds:e});(null!==(a=null==t?void 0:t.fixedProductMarketMakers)&&void 0!==a?a:[]).forEach(e=>{var t,n;let a=null===(n=e.condition)||void 0===n?void 0:null===(t=n.id)||void 0===t?void 0:t.toLowerCase();a&&(r[a]=e)})}catch(e){console.error("Failed to fetch markets by condition:",e)}return r},ih=async()=>{try{return await fetch("http://127.0.0.1:8716/healthcheck",{method:"GET",mode:"no-cors"}),{isActive:!0,currentRound:"active",recentRounds:["active"],secondsSinceLastTransition:30}}catch(e){return console.warn("Trader health check not available (expected in dev mode):",e),{isActive:!0,currentRound:"development",recentRounds:["development"],secondsSinceLastTransition:0}}},im=(e,t)=>{let n=null==t?void 0:t.find(e=>e.type===el.S.Safe&&"evmChainId"in e&&e.evmChainId===r4.C.Gnosis);if(null==n?void 0:n.address)return console.log("\uD83C\uDFAF Using service wallet for trading:",n.address),n.address;let r=null==e?void 0:e.find(e=>e.evmChainId===r4.C.Gnosis);return(null==r?void 0:r.address)?(console.log("\uD83C\uDFAF Using master safe for trading:",r.address),r.address):(console.warn(" No trading address found"),null)},ix=()=>{let{masterSafes:e}=(0,eb.Q)(),{serviceWallets:t}=(0,k.S)(),[n,r]=(0,p.useState)(!0),[a,s]=(0,p.useState)(null),[i,l]=(0,p.useState)({totalProfitLoss:0,totalProfitLossPercentage:0,activePositions:0,winRate:0,weeklyPerformance:0,monthlyPerformance:0}),[o,d]=(0,p.useState)([]),[c,u]=(0,p.useState)([]),[h,m]=(0,p.useState)([]),x=(0,p.useCallback)(async()=>{let n=im(e||[],t||[]);if(!n){s("No trading address found"),r(!1);return}try{s(null),r(!0),console.log("\uD83C\uDFAF Using trading address: ".concat(n));let[e,t,a,i]=await Promise.all([io(n),id(),ic(n),ih()]),o=s9(e),c=s7(t),p=new Set;a.forEach(e=>{var t;let n=null===(t=e.position.conditionIds)||void 0===t?void 0:t[0];n&&p.add(n)}),e.forEach(e=>{var t;let n=null===(t=e.fpmm.condition)||void 0===t?void 0:t.id;n&&p.add(n)});let h=await ip(Array.from(p)),x=ie(a,e,h),g=it(e,h);l(o),d(c),u(x),m(g)}catch(e){console.error("Failed to load Supafund data:",e),s("Failed to load trading data"),l({totalProfitLoss:0,totalProfitLossPercentage:0,activePositions:0,winRate:0,weeklyPerformance:0,monthlyPerformance:0}),d([]),u([]),m([])}finally{r(!1)}},[e,t]);return(0,p.useEffect)(()=>{x()},[x]),{metrics:i,opportunities:o,positions:c,activities:h,isLoading:n,error:a,refetch:()=>{x()}}};var ig=n(26229),iy=n(81990);let{Text:iv}=m.default,ij=e=>{switch(e){case"POSITION_OPENED":return(0,u.jsx)(ig.Z,{style:{color:"#1890ff"}});case"POSITION_CLOSED":return(0,u.jsx)(iy.Z,{style:{color:"#52c41a"}});case"MARKET_ANALYSIS":return(0,u.jsx)(tm.Z,{style:{color:"#faad14"}});default:return null}},ib=e=>{switch(e){case"POSITION_OPENED":return(0,u.jsx)(a0.Z,{color:"blue",children:"Position Opened"});case"POSITION_CLOSED":return(0,u.jsx)(a0.Z,{color:"green",children:"Position Closed"});case"MARKET_ANALYSIS":return(0,u.jsx)(a0.Z,{color:"orange",children:"Market Analysis"});default:return null}},iw=e=>{let{activities:t}=e;if(0===t.length)return(0,u.jsx)(sW.Z,{description:"No recent activity",style:{padding:"40px 0"}});let[n,r]=(0,p.useState)(1),a=Math.max(1,Math.ceil(t.length/8)),s=(0,p.useMemo)(()=>t.slice((n-1)*8,8*n),[t,n]);return(0,u.jsxs)("div",{children:[(0,u.jsx)(Z.Z,{itemLayout:"horizontal",dataSource:s,size:"small",renderItem:e=>{var t,n;return(0,u.jsx)(Z.Z.Item,{style:{padding:"8px 0"},children:(0,u.jsx)(Z.Z.Item.Meta,{avatar:ij(e.type),title:(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px",flex:1},children:[(0,u.jsx)(iv,{style:{fontSize:"13px"},children:e.title}),ib(e.type)]}),(0,u.jsx)(iv,{type:"secondary",style:{fontSize:"11px",whiteSpace:"nowrap"},children:e.timestamp})]}),description:(0,u.jsxs)("div",{style:{fontSize:"12px"},children:[(0,u.jsx)(iv,{type:"secondary",style:{fontSize:"11px"},children:e.description}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"4px",flexWrap:"wrap",gap:"8px"},children:[(null===(t=e.result)||void 0===t?void 0:t.pnl)!==void 0&&(0,u.jsxs)(iv,{style:{color:e.result.pnl>=0?"#3f8600":"#cf1322",fontSize:"11px",fontWeight:"bold"},children:["P&L: ",e.result.pnl>=0?"+":"","$",e.result.pnl.toFixed(2)]}),(null===(n=e.result)||void 0===n?void 0:n.confidence)&&(0,u.jsxs)(iv,{type:"secondary",style:{fontSize:"11px"},children:["Confidence: ",e.result.confidence]})]})]})})})}}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"8px",marginTop:"12px"},children:[(0,u.jsx)(f.ZP,{size:"small",onClick:()=>r(e=>Math.max(1,e-1)),disabled:1===n,children:"Previous"}),(0,u.jsxs)(iv,{type:"secondary",style:{fontSize:"12px"},children:[n,"/",a]}),(0,u.jsx)(f.ZP,{size:"small",onClick:()=>r(e=>Math.min(a,e+1)),disabled:n===a,children:"Next"})]})]})};var iS=n(30562);let{Title:ik,Text:iT}=m.default,iC=e=>{let{agentName:t,onConfigClick:n}=e;return(0,u.jsx)(q.Z,{style:{borderRadius:"8px",border:"1px solid #e8e8e8",boxShadow:"0 1px 4px rgba(0,0,0,0.04)"},bodyStyle:{padding:"24px"},children:(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsxs)("div",{style:{flex:1},children:[(0,u.jsxs)(ik,{level:3,style:{margin:0,marginBottom:"8px",fontSize:"24px",fontWeight:600,color:"#1a1a1a"},children:[t," Dashboard"]}),(0,u.jsx)(iT,{type:"secondary",style:{fontSize:"14px",lineHeight:"20px"},children:"Monitor your agent's performance and trading activities"})]}),(0,u.jsx)("div",{children:(0,u.jsx)(f.ZP,{icon:(0,u.jsx)(iS.Z,{}),onClick:n,title:"Configuration",type:"default",size:"middle",style:{height:"36px",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"}})})]})})},{Text:iZ}=m.default,iE=e=>{let{metrics:t}=e,n=t.totalProfitLoss>=0?"#3f8600":"#cf1322";return(0,u.jsxs)(eJ.Z,{gutter:[12,12],children:[(0,u.jsx)(e0.Z,{xs:24,children:(0,u.jsx)(q.Z,{style:{borderRadius:"8px",border:"1px solid #e8e8e8",background:"linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%)"},bodyStyle:{padding:"24px"},children:(0,u.jsx)(eW.Z,{title:(0,u.jsx)("span",{style:{fontSize:"14px",fontWeight:500,color:"#666"},children:"Total Profit/Loss"}),value:t.totalProfitLoss,precision:2,valueStyle:{color:n,fontSize:"28px",fontWeight:"bold"},prefix:"$",suffix:(0,u.jsxs)("span",{style:{fontSize:"16px",marginLeft:"12px",color:n,fontWeight:"normal"},children:["(",t.totalProfitLossPercentage.toFixed(1),"%)"]})})})}),(0,u.jsx)(e0.Z,{xs:12,children:(0,u.jsx)(q.Z,{style:{borderRadius:"8px",border:"1px solid #e8e8e8"},bodyStyle:{padding:"20px",textAlign:"center"},children:(0,u.jsxs)("div",{style:{textAlign:"center"},children:[(0,u.jsx)(iZ,{type:"secondary",style:{fontSize:"13px",display:"block",marginBottom:"8px",fontWeight:500},children:"Active Positions"}),(0,u.jsx)(iZ,{style:{color:"#1890ff",fontSize:"22px",fontWeight:"bold"},children:t.activePositions})]})})}),(0,u.jsx)(e0.Z,{xs:12,children:(0,u.jsx)(q.Z,{style:{borderRadius:"8px",border:"1px solid #e8e8e8"},bodyStyle:{padding:"20px",textAlign:"center"},children:(0,u.jsxs)("div",{style:{textAlign:"center"},children:[(0,u.jsx)(iZ,{type:"secondary",style:{fontSize:"13px",display:"block",marginBottom:"8px",fontWeight:500},children:"Win Rate"}),(0,u.jsxs)(iZ,{style:{color:t.winRate>=50?"#3f8600":"#cf1322",fontSize:"22px",fontWeight:"bold"},children:[t.winRate.toFixed(1),"%"]})]})})}),(0,u.jsx)(e0.Z,{xs:12,children:(0,u.jsx)(q.Z,{style:{borderRadius:"8px",border:"1px solid #e8e8e8"},bodyStyle:{padding:"20px"},children:(0,u.jsxs)("div",{style:{textAlign:"center"},children:[(0,u.jsx)(iZ,{type:"secondary",style:{fontSize:"13px",display:"block",marginBottom:"8px",fontWeight:500},children:"Weekly Performance"}),(0,u.jsxs)(iZ,{style:{color:t.weeklyPerformance>=0?"#3f8600":"#cf1322",fontSize:"20px",fontWeight:"bold"},children:[t.weeklyPerformance>=0?"+":"",t.weeklyPerformance.toFixed(1),"%"]})]})})}),(0,u.jsx)(e0.Z,{xs:12,children:(0,u.jsx)(q.Z,{style:{borderRadius:"8px",border:"1px solid #e8e8e8"},bodyStyle:{padding:"20px"},children:(0,u.jsxs)("div",{style:{textAlign:"center"},children:[(0,u.jsx)(iZ,{type:"secondary",style:{fontSize:"13px",display:"block",marginBottom:"8px",fontWeight:500},children:"Monthly Performance"}),(0,u.jsxs)(iZ,{style:{color:t.monthlyPerformance>=0?"#3f8600":"#cf1322",fontSize:"20px",fontWeight:"bold"},children:[t.monthlyPerformance>=0?"+":"",t.monthlyPerformance.toFixed(1),"%"]})]})})})]})},{Title:iN,Text:iP}=m.default,iI=e=>{let{opportunities:t}=e;return 0===t.length?(0,u.jsx)(sW.Z,{description:"No opportunities available at the moment",style:{padding:"40px 0"}}):(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:t.map(e=>(0,u.jsx)(q.Z,{hoverable:!0,style:{borderRadius:"8px",border:"1px solid #e8e8e8",transition:"all 0.2s ease-in-out"},bodyStyle:{padding:"16px"},children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"12px"},children:[(0,u.jsx)(iN,{level:5,style:{margin:0,fontSize:"15px",flex:1,lineHeight:"22px",fontWeight:500},ellipsis:{rows:2,tooltip:e.title},children:e.title}),(0,u.jsx)(a0.Z,{color:e.marketLeader.includes("%")?e.marketLeader.toLowerCase().includes("yes")?"green":e.marketLeader.toLowerCase().includes("no")?"red":"blue":"blue",style:{margin:0,fontSize:"11px",padding:"4px 8px",borderRadius:"4px",fontWeight:500},children:e.marketLeader})]}),(0,u.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"16px",alignItems:"center",paddingTop:"8px",borderTop:"1px solid #f5f5f5"},children:[(0,u.jsx)(iP,{type:"secondary",style:{fontSize:"12px"},children:e.category}),(0,u.jsx)(iP,{type:"secondary",style:{fontSize:"12px"},children:"Resolved"===e.expiresIn?"Resolved":"Expired"===e.expiresIn?"Expired":"Expires in ".concat(e.expiresIn)})]})]})},e.id))})},{Text:iM}=m.default,i_=e=>Number.isFinite(e)?"".concat((100*e).toFixed(1),"%"):"",iA=e=>Number.isFinite(e)?Math.abs(e)>=1?e.toFixed(2):e.toFixed(4):"0",iL=(e,t)=>e>0?"+".concat(t):t,iF=(e,t,n)=>{let r=e.toFixed(2);return t?"$".concat(r):"".concat(r," ").concat(n)},iO=e=>{let{positions:t}=e;return 0===t.length?(0,u.jsx)(sW.Z,{description:"No active positions",style:{padding:"40px 0"}}):(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:t.map(e=>{let t=e.pnl>=0?"#3f8600":"#cf1322",n=i_(e.entryPrice),r=i_(e.currentPrice),a=iA(e.size),s=iL(e.pnl,e.pnl.toFixed(2)),i="".concat(iL(e.pnlPercentage,e.pnlPercentage.toFixed(1)),"%"),l=iF(e.currentValue,e.collateralIsStable,e.collateralSymbol),o=iF(e.entryValue,e.collateralIsStable,e.collateralSymbol);return(0,u.jsx)(q.Z,{style:{borderRadius:"8px",border:"1px solid #e8e8e8",transition:"all 0.2s ease-in-out"},bodyStyle:{padding:"16px"},children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"12px"},children:[(0,u.jsx)(iM,{strong:!0,style:{fontSize:"15px",flex:1,lineHeight:"22px",fontWeight:500},ellipsis:{tooltip:e.market},children:e.market}),(0,u.jsx)(a0.Z,{color:"YES"===e.direction?"green":"red",style:{margin:0,padding:"4px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:500},children:e.direction})]}),(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"16px",padding:"12px 0",borderTop:"1px solid #f5f5f5",borderBottom:"1px solid #f5f5f5"},children:[(0,u.jsxs)("div",{style:{textAlign:"center"},children:[(0,u.jsx)(iM,{type:"secondary",style:{fontSize:"12px",display:"block",marginBottom:"4px"},children:"Entry Price"}),(0,u.jsx)(iM,{style:{fontSize:"14px",fontWeight:500},children:n})]}),(0,u.jsxs)("div",{style:{textAlign:"center"},children:[(0,u.jsx)(iM,{type:"secondary",style:{fontSize:"12px",display:"block",marginBottom:"4px"},children:"Current Price"}),(0,u.jsx)(iM,{style:{fontSize:"14px",fontWeight:500},children:r})]}),(0,u.jsxs)("div",{style:{textAlign:"center"},children:[(0,u.jsx)(iM,{type:"secondary",style:{fontSize:"12px",display:"block",marginBottom:"4px"},children:"Tokens Held"}),(0,u.jsx)(iM,{style:{fontSize:"14px",fontWeight:500},children:a})]})]}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsxs)(iM,{type:"secondary",style:{fontSize:"12px"},children:["Current Value: ",(0,u.jsx)("span",{style:{fontWeight:500,color:"#141414"},children:l})]}),(0,u.jsxs)(iM,{type:"secondary",style:{fontSize:"12px"},children:["Cost Basis: ",(0,u.jsx)("span",{style:{fontWeight:500,color:"#141414"},children:o})]})]}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsx)("div",{children:(0,u.jsxs)(iM,{style:{color:t,fontSize:"15px",fontWeight:"bold"},children:["P&L: ",s," (",i,")"]})}),(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,u.jsx)(iM,{type:"secondary",style:{fontSize:"12px"},children:e.timeRemaining}),(0,u.jsx)(f.ZP,{type:"link",size:"small",style:{padding:"4px 8px",fontSize:"12px",height:"auto",color:"#666"},href:"https://dreamathon.supafund.xyz/markets/".concat(e.marketAddress),target:"_blank",rel:"noopener noreferrer",children:"View"})]})]})]})},e.id)})})},{Title:iR}=m.default,{TabPane:iD}=sz.default,iB=e=>{let{hideBackButton:t=!1}=e,{goto:n}=(0,S.a)(),{selectedAgentConfig:r,selectedAgentType:a,selectedService:s}=(0,k.S)(),{deploymentStatus:i}=(0,ny.G)(null==s?void 0:s.service_config_id),{metrics:l,opportunities:o,positions:d,activities:c,isLoading:x}=ix(),y=(0,p.useMemo)(()=>a===rn.b.Supafund,[a]),v=(0,p.useMemo)(()=>i===tv.E.DEPLOYED,[i]);return y?(0,u.jsxs)(G,{$noBorder:!0,style:{overflowX:"hidden"},children:[!t&&(0,u.jsx)("div",{style:{marginBottom:"20px"},children:(0,u.jsx)(f.ZP,{icon:(0,u.jsx)(h.Z,{}),onClick:()=>n(b.i.Main),type:"text",style:{padding:"4px 8px",color:"#666",fontSize:"14px"},children:"Back to main"})}),(0,u.jsx)("div",{style:{marginBottom:"20px"},children:(0,u.jsx)(iC,{agentName:r.displayName,onConfigClick:()=>n(b.i.SupafundConfiguration)})}),(0,u.jsxs)(g.Z,{spinning:x,children:[(0,u.jsx)("div",{style:{marginBottom:"24px"},children:(0,u.jsx)(iE,{metrics:l})}),(0,u.jsx)(q.Z,{style:{borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.06)"},bodyStyle:{padding:"20px"},children:(0,u.jsxs)(sz.default,{defaultActiveKey:"opportunities",size:"large",tabBarStyle:{marginBottom:"20px",borderBottom:"1px solid #f0f0f0"},children:[(0,u.jsx)(iD,{tab:"Opportunities",children:v?(0,u.jsx)(iI,{opportunities:o}):(0,u.jsx)(sW.Z,{description:"Start your agent to see market opportunities",style:{padding:"40px 0"}})},"opportunities"),(0,u.jsx)(iD,{tab:"Positions",children:(0,u.jsx)(iO,{positions:d})},"positions"),(0,u.jsx)(iD,{tab:"Activity",children:(0,u.jsx)(iw,{activities:c})},"activity")]})})]})]}):(0,u.jsx)(G,{$noBorder:!0,$padding:"16px",children:(0,u.jsxs)(q.Z,{children:[(0,u.jsx)(iR,{level:4,children:"Supafund Dashboard"}),(0,u.jsx)(m.default.Text,{type:"secondary",children:"This dashboard is only available for Supafund agents."}),(0,u.jsx)("div",{style:{marginTop:"20px"},children:(0,u.jsx)(W,{})})]})})},iz=()=>{let{goto:e}=(0,S.a)(),{selectedAgentType:t}=(0,k.S)(),{hasEnoughNativeTokenForInitialFunding:n,hasEnoughOlasForInitialFunding:r,hasEnoughAdditionalTokensForInitialFunding:a,isInitialFunded:s}=n6(void 0),i=(0,p.useMemo)(()=>t===rn.b.Supafund,[t]),l=[n,r,a],o=l.every(e=>null!=e),d=l.every(e=>!0===e),c=!0===s||o&&d;return((0,p.useEffect)(()=>{i&&o&&!c&&e(b.i.Main)},[c,e,o,i]),i&&(!o||c))?(0,u.jsxs)(G,{$padding:"12px",style:{overflowX:"hidden"},children:[(0,u.jsx)(r_,{}),(0,u.jsx)(rF,{}),(0,u.jsx)("div",{style:{marginTop:"12px",marginBottom:"16px"},children:(0,u.jsx)(f.ZP,{icon:(0,u.jsx)(h.Z,{}),onClick:()=>e(b.i.Main),type:"default",children:"Back to Settings"})}),(0,u.jsx)(iB,{hideBackButton:!0})]}):null},iW=e=>{let{prev:t}=e,{goto:n,prevState:r}=tn(),a=(0,p.useCallback)(()=>{t&&(D()(t)?t():n(t))},[n,t]),s=t&&r!==sO.Q.Welcome;return(0,u.jsxs)(eJ.Z,{children:[(0,u.jsx)(e0.Z,{span:8,children:s&&(0,u.jsx)(f.ZP,{onClick:a,icon:(0,u.jsx)(h.Z,{}),size:"large"})}),(0,u.jsx)(e0.Z,{span:8,children:(0,u.jsx)(x.Z,{justify:"center",children:(0,u.jsx)(v(),{src:"/onboarding-robot.svg",alt:"logo",width:80,height:80})})}),(0,u.jsx)(e0.Z,{span:8})]})};var iH=n(3940),iq=n(29620),iU=n(83736),iY=n(61572),iG=n(71513),iQ=n(78453),i$=n(72635);function iK(){let e=(0,H._)(["\n  display: flex;\n  flex-direction: column;\n"]);return iK=function(){return e},e}let iX=(0,U.ZP)(iU.Z)(iK()),{Text:iV,Title:iJ}=m.default,i0={founder_team:20,market_opportunity:20,technical_analysis:20,social_sentiment:20,tokenomics:20},i1={balanced:{name:"Balanced",description:"Equal weight across all factors",weights:{founder_team:20,market_opportunity:20,technical_analysis:20,social_sentiment:20,tokenomics:20}},technical:{name:"Technical Focus",description:"Emphasizes code quality and development",weights:{founder_team:15,market_opportunity:15,technical_analysis:40,social_sentiment:15,tokenomics:15}},fundamental:{name:"Fundamental Focus",description:"Focuses on team and market opportunity",weights:{founder_team:35,market_opportunity:35,technical_analysis:15,social_sentiment:10,tokenomics:5}},social:{name:"Social Driven",description:"Prioritizes community and sentiment",weights:{founder_team:20,market_opportunity:15,technical_analysis:15,social_sentiment:35,tokenomics:15}}},i2={founder_team:"Evaluates team experience, track record, and domain expertise.",market_opportunity:"Assesses market size, growth potential, and competitive landscape.",technical_analysis:"Evaluates code quality, development activity, and innovation.",social_sentiment:"Measures community engagement, social media presence, and sentiment.",tokenomics:"Analyzes token distribution, utility, and economic model."},i6=()=>{let e=!iq.ZP.useBreakpoint().md,{goto:t}=tn(),{goto:n}=(0,S.a)(),[r]=iU.Z.useForm(),[a,s]=(0,p.useState)(i0),[i,l]=(0,p.useState)(""),[o,d]=(0,p.useState)(5),[c,h]=(0,p.useState)(5),[m,x]=(0,p.useState)(!1),g=(e,t)=>{s({...a,[e]:t})},y=e=>{s(i1[e].weights)},v=(0,p.useCallback)(async()=>{try{x(!0),await r.validateFields(),localStorage.setItem("supafund_config",JSON.stringify({weights:a,apiEndpoint:i,minEdgeThreshold:o,riskTolerance:c})),es.ZP.success("Supafund agent configuration saved!"),n(b.i.Main)}catch(e){es.ZP.error("Please check your configuration."),console.error("Validation failed:",e)}finally{x(!1)}},[r,a,i,o,c,n]),j=Object.values(a).reduce((e,t)=>e+t,0),w=100===j,k=j>100;return(0,u.jsx)(iX,{children:(0,u.jsxs)(iU.Z,{form:r,layout:"vertical",children:[(0,u.jsxs)(q.Z,{className:"mb-4",children:[(0,u.jsx)(iJ,{level:5,children:"Personalized Trading Strategy"}),(0,u.jsx)(iV,{children:"The Supafund Agent uses your personal weights to trade on prediction markets. Adjust the sliders below to customize your agent's focus areas."}),!w&&(0,u.jsx)("div",{className:"mt-4",children:(0,u.jsxs)(iV,{type:"danger",children:[(0,u.jsx)(X.Z,{})," Total weight must equal 100% (currently ",j,"%)"]})}),(0,u.jsxs)("div",{className:"mt-4 mb-4",children:[(0,u.jsxs)(eJ.Z,{justify:"space-between",align:"middle",className:"mb-3",children:[(0,u.jsx)(iV,{strong:!0,children:"Quick Presets:"}),(0,u.jsx)(f.ZP,{size:"small",type:"link",onClick:()=>s(i0),style:{padding:0},children:"Reset to Default"})]}),(0,u.jsx)(eJ.Z,{gutter:[8,8],children:Object.entries(i1).map(e=>{let[t,n]=e;return(0,u.jsx)(e0.Z,{xs:12,md:6,children:(0,u.jsx)(f.ZP,{size:"small",onClick:()=>y(t),style:{width:"100%",height:"auto",padding:"6px 8px",textAlign:"left",border:"1px solid #d9d9d9",borderRadius:"4px",whiteSpace:"normal",lineHeight:1.2},className:"hover:border-blue-400 hover:bg-blue-50 transition-colors",children:(0,u.jsxs)("div",{children:[(0,u.jsx)(iV,{strong:!0,style:{fontSize:"11px",display:"block",lineHeight:"1.2",whiteSpace:"normal",wordBreak:"break-word"},children:n.name}),(0,u.jsx)(iV,{type:"secondary",style:{fontSize:"9px",lineHeight:"1.2",whiteSpace:"normal",wordBreak:"break-word",display:"block"},children:n.description})]})})},t)})})]}),(0,u.jsx)("div",{className:"mt-6",children:Object.entries(a).map(t=>{let[n,r]=t;return(0,u.jsx)(q.Z,{size:"small",className:"mb-4",style:{border:"1px solid #f0f0f0"},children:(0,u.jsxs)(eJ.Z,{gutter:16,align:"middle",children:[(0,u.jsxs)(e0.Z,{xs:24,md:7,children:[(0,u.jsx)(iJ,{level:5,style:{margin:0,fontSize:"14px",fontWeight:600},children:n.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" & ")}),(0,u.jsx)(iV,{type:"secondary",style:{fontSize:"12px"},children:i2[n]})]}),(0,u.jsx)(e0.Z,{xs:24,md:14,style:e?{marginTop:8}:void 0,children:(0,u.jsx)(iY.Z,{min:0,max:100,value:r,onChange:e=>g(n,e),marks:{0:"0%",25:"25%",50:"50%",75:"75%",100:"100%"},tooltip:{formatter:e=>"".concat(e,"%")}})}),(0,u.jsx)(e0.Z,{xs:24,md:3,style:{textAlign:"center",...e?{marginTop:4}:{}},children:(0,u.jsxs)(iJ,{level:4,style:{margin:0,color:r>0?"#1890ff":"#d9d9d9"},children:[r,"%"]})})]})},n)})}),(0,u.jsxs)("div",{className:"mt-4 p-4",style:{backgroundColor:w?"#f6ffed":"#fff2e8",borderRadius:"8px",border:"1px solid ".concat(w?"#b7eb8f":"#ffd591")},children:[(0,u.jsxs)(eJ.Z,{justify:"space-between",align:"middle",className:"mb-2",children:[(0,u.jsxs)(iV,{style:{color:w?"#52c41a":"#fa8c16",fontWeight:600,fontSize:"14px"},children:["Total Weight: ",j,"%"]}),(0,u.jsx)(iV,{style:{color:w?"#52c41a":"#fa8c16",fontWeight:500},children:w?" Perfect!":"Need ".concat(100-j,"% more")})]}),(0,u.jsx)(iG.Z,{percent:j,status:100===j?"success":j>100?"exception":"active",strokeColor:100===j?"#52c41a":j>100?"#ff4d4f":"#1890ff",showInfo:!1,strokeWidth:8}),j>100&&(0,u.jsx)(iV,{type:"danger",style:{fontSize:"12px",display:"block",marginTop:"4px"},children:"Total exceeds 100%. Please reduce some weights."})]})]}),(0,u.jsxs)(q.Z,{className:"mb-4",children:[(0,u.jsx)(iJ,{level:5,children:"Advanced Settings"}),(0,u.jsx)(iV,{type:"secondary",className:"mb-4 block",children:"Fine-tune your agent's trading behavior and risk parameters."}),(0,u.jsx)(iU.Z.Item,{name:"apiEndpoint",label:(0,u.jsx)(iV,{strong:!0,children:"Supafund API Endpoint"}),help:"Leave empty to use default endpoint. Only change if you have a custom Supafund backend.",children:(0,u.jsx)(iQ.Z,{placeholder:"https://api.supafund.ai (optional)",value:i,onChange:e=>l(e.target.value),size:"large"})}),(0,u.jsxs)("div",{className:"mb-6",children:[(0,u.jsxs)(iV,{strong:!0,className:"block mb-2",children:["Minimum Edge Threshold: ",o,"%"]}),(0,u.jsx)(iV,{type:"secondary",className:"block mb-3",children:"Your agent will only place bets when it has at least this percentage advantage"}),(0,u.jsx)(iY.Z,{min:1,max:20,value:o,onChange:d,marks:{1:"1%",5:"5%",10:"10%",15:"15%",20:"20%"},tooltip:{formatter:e=>"".concat(e,"% edge required")}})]}),(0,u.jsxs)("div",{className:"mb-4",children:[(0,u.jsxs)(iV,{strong:!0,className:"block mb-2",children:["Risk Tolerance: ",c,"/10"]}),(0,u.jsx)(iV,{type:"secondary",className:"block mb-3",children:"Higher values mean larger position sizes and more aggressive trading"}),(0,u.jsx)(iY.Z,{min:1,max:10,value:c,onChange:h,marks:e?{1:"VC",3:"C",5:"M",7:"A",10:"VA"}:{1:"Very Conservative",3:"Conservative",5:"Moderate",7:"Aggressive",10:"Very Aggressive"},tooltip:{formatter:e=>["","Very Conservative","Conservative","Conservative","Moderate","Moderate","Moderate","Aggressive","Aggressive","Very Aggressive","Very Aggressive"][e||0]}})]})]}),(0,u.jsx)("div",{className:"sticky-actions",children:(0,u.jsxs)(i$.Z,{direction:"horizontal",size:"middle",children:[(0,u.jsx)(f.ZP,{size:"large",type:"primary",disabled:!w||k||m,loading:m,onClick:v,children:m?"Saving configuration...":"Proceed"}),(0,u.jsx)(f.ZP,{size:"large",disabled:m,onClick:()=>t(sO.Q.AgentIntroduction),children:"Back"})]})})]})})},{Title:i4,Text:i5}=m.default;var i8=n(18446),i3=n.n(i8),i9=n(14176),i7=n.n(i9),le=n(95858),lt=n(50308),ln=n.n(lt);let lr={open:!1,openModal:ln(),closeModal:ln(),cancel:ln(),confirm:ln()},la=()=>{let[e,t]=(0,p.useState)(!1),n=()=>t(!1),r=(0,p.useCallback)(async()=>{n()},[]),a=(0,p.useCallback)(async()=>{n()},[]);return{open:e,openModal:()=>t(!0),closeModal:n,cancel:r,confirm:a}},ls=e=>{let{confirmCallback:t}=e,n=la(),{isServiceRunning:r,service:a}=(0,ny.G)(),[s,i]=(0,p.useState)(!1),l=(0,p.useCallback)(async()=>{if(r&&(null==a?void 0:a.service_config_id))try{es.ZP.info("Restarting service ..."),await n8.ServicesService.stopDeployment(a.service_config_id),await n8.ServicesService.startService(a.service_config_id)}catch(e){console.error(e)}},[r,null==a?void 0:a.service_config_id]),o=(0,p.useCallback)(async()=>{i(!0),es.ZP.loading({content:"Updating agent settings...",key:"updating"});let e=!1;try{await t(),es.ZP.destroy("updating"),es.ZP.success({content:"Agent settings updated successfully."}),l().catch(()=>es.ZP.error({content:"Failed to restart service."}))}catch(t){console.error(t),e=!0}finally{i(!1)}if(!e)return n.closeModal();throw Error("Failed to confirm")},[t,n,l]);return{...n,confirm:o,pending:s}},li=e=>{let{confirmCallback:t}=e,n=la(),r=(0,p.useCallback)(async()=>{t(),n.closeModal()},[t,n]);return{...n,confirm:r}},ll=e=>{let{isLoading:t}=e,{isServiceRunning:n}=(0,ny.G)(),{confirmUpdateModal:r}=(0,p.useContext)(ld),a=(0,p.useMemo)(()=>n?t?"Saving and restarting agent...":"Save and restart agent":t?"Saving...":"Save",[n,t]);return(0,u.jsx)(nZ.Z,{title:"Confirm changes",open:r.open,onOk:r.confirm,okButtonProps:{loading:t},onCancel:r.cancel,okText:a,closable:!t,children:"These changes will only take effect when you restart the agent."})},lo=()=>{let{unsavedModal:e}=(0,p.useContext)(ld);return(0,u.jsx)(nZ.Z,{title:"Unsaved changes",open:e.open,onOk:e.confirm,onCancel:e.cancel,okText:"Discard changes",children:"You have unsaved changes. Are you sure you want to leave this page?"})},ld=(0,p.createContext)({isEditing:!1,setIsEditing:ln(),unsavedModal:lr,confirmUpdateModal:lr}),lc=e=>{let{children:t}=e,[n]=iU.Z.useForm(),{refetch:r,selectedService:a,selectedAgentType:s}=(0,k.S)(),{goto:i}=(0,S.a)(),[l,o]=(0,p.useState)(!1),[d,c]=(0,p.useState)(!1),h=(0,p.useCallback)(async()=>{var e;let t=n.getFieldsValue();if(!a||!a.service_config_id)return;c(!0);let i=n1.J9.find(e=>{let{name:t,agentType:n}=e;return t===a.name||n===s}),l=null!==(e=t.env_variables)&&void 0!==e?e:{},d={serviceConfigId:a.service_config_id,partialServiceTemplate:{...t,env_variables:{...Object.entries(l).reduce((e,t)=>{var n;let[r,a]=t;return{...e,[r]:{...(null==i?void 0:null===(n=i.env_variables)||void 0===n?void 0:n[r])||{},value:a}}},{})}}};try{await n8.ServicesService.updateService(d),await (null==r?void 0:r())}catch(e){console.error(e)}finally{o(!1),c(!1)}},[n,s,a,r]),m=(0,p.useCallback)(async()=>{i(b.i.Main)},[i]),x=ls({confirmCallback:h}),g=li({confirmCallback:m});return(0,u.jsxs)(ld.Provider,{value:{confirmUpdateModal:x,unsavedModal:g,form:n,isEditing:l,setIsEditing:o},children:[(0,u.jsx)(ll,{isLoading:d}),(0,u.jsx)(lo,{}),t]})},lu=()=>{let{setIsEditing:e}=(0,p.useContext)(ld),t=(0,p.useCallback)(()=>{null==e||e(e=>!e)},[e]);return(0,u.jsx)(f.ZP,{icon:(0,u.jsx)(le.Z,{}),onClick:t,children:"Edit"})},lp=e=>{let{onClickBack:t,children:n}=e,{isEditing:r}=(0,p.useContext)(ld);return(0,u.jsx)(G,{title:(0,u.jsx)(B,{backButtonCallback:t,title:r?"Edit agent settings":"Agent settings"}),extra:r?null:(0,u.jsx)(lu,{}),bordered:!1,children:n})},{Title:lh,Text:lm}=m.default,lx=()=>{let{goto:e}=(0,S.a)(),{selectedService:t}=(0,k.S)(),{unsavedModal:n,form:r,isEditing:a,confirmUpdateModal:s}=(0,p.useContext)(ld),i=(0,p.useMemo)(()=>(null==t?void 0:t.env_variables)?Object.entries(t.env_variables).reduce((e,t)=>{let[n,{value:r}]=t;if("SUPAFUND_WEIGHTS"===n)try{e.weights=JSON.parse(r)}catch(t){e.weights={founder_team:20,market_opportunity:20,technical_analysis:20,social_sentiment:20,tokenomics:20}}else"SUPAFUND_API_ENDPOINT"===n?e.apiEndpoint=r:"MIN_EDGE_THRESHOLD"===n?e.minEdgeThreshold=parseInt(r)||5:"RISK_TOLERANCE"===n&&(e.riskTolerance=parseInt(r)||5);return e},{}):null,[t]),l=(0,p.useCallback)(()=>{let t=i7()(null==r?void 0:r.getFieldsValue(),e=>void 0===e||""===e);i3()(t,i)?e(b.i.Main):n.openModal()},[i,r,n,e]),o=(0,p.useCallback)(async()=>{s.openModal()},[s]);return i?(0,u.jsx)(lp,{onClickBack:l,children:(0,u.jsxs)(q.Z,{children:[(0,u.jsx)(lh,{level:4,children:"Supafund Agent Configuration"}),(0,u.jsx)(lm,{type:"secondary",children:"Update your Supafund agent configuration settings."}),(0,u.jsxs)("div",{style:{marginTop:"24px"},children:[(0,u.jsx)(lm,{children:"Current configuration values are loaded from your service environment variables."}),i&&(0,u.jsxs)("div",{style:{marginTop:"16px"},children:[(0,u.jsx)(lm,{strong:!0,children:"Current Weights:"}),(0,u.jsxs)("ul",{style:{marginTop:"8px"},children:[(0,u.jsxs)("li",{children:["Founder Team: ",i.weights.founder_team,"%"]}),(0,u.jsxs)("li",{children:["Market Opportunity: ",i.weights.market_opportunity,"%"]}),(0,u.jsxs)("li",{children:["Technical Analysis: ",i.weights.technical_analysis,"%"]}),(0,u.jsxs)("li",{children:["Social Sentiment: ",i.weights.social_sentiment,"%"]}),(0,u.jsxs)("li",{children:["Tokenomics: ",i.weights.tokenomics,"%"]})]}),(0,u.jsxs)("div",{style:{marginTop:"16px"},children:[(0,u.jsx)(lm,{strong:!0,children:"Risk Settings:"}),(0,u.jsxs)("ul",{style:{marginTop:"8px"},children:[(0,u.jsxs)("li",{children:["Min Edge Threshold: ",i.minEdgeThreshold,"%"]}),(0,u.jsxs)("li",{children:["Risk Tolerance: ",i.riskTolerance,"/10"]}),i.apiEndpoint&&(0,u.jsxs)("li",{children:["API Endpoint: ",i.apiEndpoint]})]})]})]}),(0,u.jsx)("div",{style:{marginTop:"24px"},children:a?(0,u.jsx)(f.ZP,{type:"primary",onClick:o,children:"Save Configuration"}):(0,u.jsx)(lm,{type:"secondary",children:"Click Edit Agent to modify these settings."})})]})]})}):null};var lg=n(99859),lf=n(48673);let{Text:ly}=m.default,lv={balanced:{name:"Balanced",description:"Equal weight across all factors",weights:{founder_team:20,market_opportunity:20,technical_analysis:20,social_sentiment:20,tokenomics:20}},technical:{name:"Technical Focus",description:"Emphasizes code quality and development",weights:{founder_team:15,market_opportunity:15,technical_analysis:40,social_sentiment:15,tokenomics:15}},fundamental:{name:"Fundamental Focus",description:"Focuses on team and market opportunity",weights:{founder_team:35,market_opportunity:35,technical_analysis:15,social_sentiment:10,tokenomics:5}},social:{name:"Social Driven",description:"Prioritizes community and sentiment",weights:{founder_team:20,market_opportunity:15,technical_analysis:15,social_sentiment:35,tokenomics:15}}},lj=e=>{let{currentWeights:t,onSelect:n,onReset:r}=e;return(0,u.jsxs)("div",{children:[(0,u.jsxs)(eJ.Z,{justify:"space-between",align:"middle",style:{marginBottom:"16px"},children:[(0,u.jsx)(ly,{strong:!0,children:"Quick Presets"}),(0,u.jsx)(f.ZP,{size:"small",type:"link",onClick:r,children:"Reset to Default"})]}),(0,u.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"12px"},children:Object.entries(lv).map(e=>{let[r,a]=e;return(0,u.jsxs)(q.Z,{hoverable:!0,size:"small",onClick:()=>n(a.weights),style:{cursor:"pointer",borderColor:JSON.stringify(t)===JSON.stringify(a.weights)?"#1890ff":void 0,backgroundColor:JSON.stringify(t)===JSON.stringify(a.weights)?"#e6f7ff":void 0,minHeight:"120px",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,u.jsx)(ly,{strong:!0,style:{fontSize:"14px",marginBottom:"4px"},children:a.name}),(0,u.jsx)(ly,{type:"secondary",style:{fontSize:"12px",whiteSpace:"normal"},children:a.description})]},r)})})]})},{Title:lb,Text:lw}=m.default,lS={founder_team:20,market_opportunity:20,technical_analysis:20,social_sentiment:20,tokenomics:20},lk={founder_team:"Evaluates team experience, track record, and domain expertise.",market_opportunity:"Assesses market size, growth potential, and competitive landscape.",technical_analysis:"Evaluates code quality, development activity, and innovation.",social_sentiment:"Measures community engagement, social media presence, and sentiment.",tokenomics:"Analyzes token distribution, utility, and economic model."},lT=()=>{let{goto:e}=(0,S.a)(),{selectedAgentType:t,selectedService:n,overrideSelectedServiceStatus:r}=(0,k.S)(),[a]=iU.Z.useForm(),[s,i]=(0,p.useState)(lS),[l,o]=(0,p.useState)(!0),[d,c]=(0,p.useState)(!1),x=t===rn.b.Supafund;(0,p.useEffect)(()=>{(async()=>{if(x)try{let e=await lf.r.getSupafundConfig();i(e.weights),o(!1)}catch(e){console.error("Failed to load configuration:",e),o(!1)}})()},[x]);let y=(e,t)=>{i({...s,[e]:t})},v=(0,p.useCallback)(async()=>{if(100!==Object.values(s).reduce((e,t)=>e+t,0)){es.ZP.error("Total weight must equal 100%");return}try{if(c(!0),await lf.r.updateSupafundWeights(s,null==n?void 0:n.service_config_id),es.ZP.success("Configuration saved successfully!"),null==n?void 0:n.service_config_id){let e="supafund-restart";es.ZP.loading({content:"Restarting agent to apply new configuration...",key:e,duration:0}),null==r||r(tv.E.STOPPING);try{await lf.r.restartSupafundService(n.service_config_id),es.ZP.success({content:"Agent restarted successfully! New configuration is now active.",key:e})}catch(n){console.error("Restart error:",n);let t=n instanceof Error?n.message:String(null!=n?n:"Unknown error");t.includes("500")?es.ZP.error({content:"Server error during restart. Please check agent logs and try restarting manually.",key:e}):t.includes("connection")?es.ZP.warning({content:"Connection issue during restart. Please check if the agent service is running.",key:e}):es.ZP.warning({content:"Configuration saved but restart failed: ".concat(t,". You may need to restart manually."),key:e})}finally{null==r||r(void 0)}}setTimeout(()=>{e(b.i.Main)},2e3)}catch(e){es.ZP.error("Failed to save configuration"),console.error("Save error:",e)}finally{c(!1)}},[s,e,null==n?void 0:n.service_config_id,r]);if(!x)return(0,u.jsx)(G,{children:(0,u.jsxs)(q.Z,{children:[(0,u.jsx)(lb,{level:4,children:"Supafund Configuration"}),(0,u.jsx)(m.default.Text,{type:"secondary",children:"This configuration is only available for Supafund agents."}),(0,u.jsx)("div",{style:{marginTop:"20px"},children:(0,u.jsx)(f.ZP,{onClick:()=>e(b.i.Main),children:"Back to Main"})})]})});let j=Object.values(s).reduce((e,t)=>e+t,0),w=100===j;return(0,u.jsxs)(G,{children:[(0,u.jsx)(eJ.Z,{gutter:16,style:{marginBottom:"16px"},children:(0,u.jsx)(e0.Z,{span:24,children:(0,u.jsx)(f.ZP,{icon:(0,u.jsx)(h.Z,{}),onClick:()=>e(b.i.Main),children:"Back to Dashboard"})})}),(0,u.jsxs)(q.Z,{bodyStyle:{padding:"0 24px 24px"},children:[(0,u.jsx)(lb,{level:3,children:"Agent Configuration"}),(0,u.jsx)(lw,{type:"secondary",children:"Customize your agent's trading strategy by adjusting the weight of each evaluation factor."})]}),(0,u.jsxs)(g.Z,{spinning:l,children:[(0,u.jsxs)(q.Z,{style:{marginTop:"16px"},children:[(0,u.jsx)(lj,{currentWeights:s,onSelect:e=>{i(e)},onReset:()=>i(lS)}),(0,u.jsx)(iU.Z,{form:a,layout:"vertical",style:{marginTop:"24px"},children:Object.entries(s).map(e=>{let[t,n]=e;return(0,u.jsx)(q.Z,{size:"small",style:{marginBottom:"16px"},children:(0,u.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"16px"},children:[(0,u.jsxs)("div",{style:{flex:"1 1 280px",minWidth:"240px"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"baseline",gap:"8px",flexWrap:"wrap"},children:[(0,u.jsx)(lb,{level:5,style:{margin:0},children:t.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" & ")}),(0,u.jsxs)(lw,{strong:!0,style:{color:n>0?"#1890ff":"#d9d9d9"},children:[" ",n,"%"]})]}),(0,u.jsx)(lw,{type:"secondary",style:{fontSize:"12px",whiteSpace:"normal"},children:lk[t]})]}),(0,u.jsx)("div",{style:{flex:"2 1 320px",minWidth:"260px",padding:"0 20px"},children:(0,u.jsx)(iY.Z,{min:0,max:100,value:n,onChange:e=>y(t,e),marks:{0:"0%",50:"50%",100:{style:{transform:"translateX(-10px)"},label:"100%"}}})})]})},t)})}),(0,u.jsx)(q.Z,{style:{backgroundColor:w?"#f6ffed":"#fff2e8",borderColor:w?"#b7eb8f":"#ffd591"},children:(0,u.jsxs)(eJ.Z,{justify:"space-between",align:"middle",children:[(0,u.jsxs)(lw,{style:{color:w?"#52c41a":"#fa8c16",fontWeight:600,fontSize:"16px"},children:["Total Weight: ",j,"%"]}),(0,u.jsx)(lw,{style:{color:w?"#52c41a":"#fa8c16"},children:w?" Perfect!":"".concat(j>100?"Reduce":"Add"," ").concat(Math.abs(100-j),"%")})]})})]}),(0,u.jsx)(eJ.Z,{style:{marginTop:"16px"},children:(0,u.jsx)(e0.Z,{span:24,children:(0,u.jsxs)(i$.Z,{children:[(0,u.jsx)(f.ZP,{type:"primary",icon:(0,u.jsx)(lg.Z,{}),size:"large",loading:d,disabled:!w,onClick:v,children:"Save Configuration"}),(0,u.jsx)(f.ZP,{size:"large",onClick:()=>e(b.i.Main),children:"Cancel"})]})})})]})]})},lC=()=>(0,u.jsx)(sB,{});var lZ=n(66161);(a=o||(o={})).Active="current",a.Default="default";var lE=n(12297),lN=n.n(lE);(s=d||(d={})).ContractAlreadySelected="This staking program is already selected",s.LoadingBalance="Loading balance...",s.LoadingStakingContractInfo="Loading staking contract information...",s.InsufficientOlasToMigrate="Insufficient OLAS to switch",s.InsufficientGasToMigrate="Insufficient XDAI to switch",s.MigrationNotSupported="Switching to this program is not currently supported",s.NoAvailableRewards="This program has no rewards available",s.NoAvailableStakingSlots="The program has no more available slots",s.NotStakedForMinimumDuration="Pearl has not been staked for the required minimum duration",s.PearlCurrentlyRunning="Unable to switch while Pearl is running",s.LoadingServices="Loading services...",s.CannotFindStakingContractInfo="Cannot obtain staking contract information";let lP=e=>{let{isFetched:t,selectedAgentConfig:n,selectedService:r,selectedAgentType:a}=(0,k.S)(),{evmHomeChainId:s}=n,i=null==r?void 0:r.service_config_id,{deploymentStatus:l}=(0,ny.G)(i),{isLoaded:o,totalStakedOlasBalance:d,isLowBalance:c}=(0,eo.AE)(),{masterSafeBalances:u}=(0,eo.PU)(),{needsInitialFunding:h,hasEnoughNativeTokenForInitialFunding:m}=n6(e),{activeStakingProgramId:x}=(0,nP.x)(),{allStakingContractDetailsRecord:g,isAllStakingContractDetailsRecordLoaded:f}=(0,nL.n9)(),{isServiceStaked:y,isServiceStakedForMinimumDuration:v}=(0,nL.S9)(),{stakingContractInfo:j,hasEnoughServiceSlots:b}=(0,nL.c5)(e),w=(0,p.useMemo)(()=>!o||ex()(u)||eh()(u)?0:u.reduce((e,t)=>{let{evmChainId:n,symbol:r,balance:a}=t;return n===s&&r===tS.W.OLAS?e+a:e},0),[s,o,u]),S=(0,p.useMemo)(()=>{var t;let r=null===(t=nE.Z5[n.evmHomeChainId])||void 0===t?void 0:t[e];return null==r?void 0:r.stakingRequirements[tS.W.OLAS]},[n.evmHomeChainId,e]),T=(0,p.useMemo)(()=>!(!o||ex()(w)||ex()(d)||ex()(S))&&w+d>=S,[o,S,w,d]),C=(0,p.useMemo)(()=>!(!o||ex()(w)||ex()(S))&&w>=S,[o,S,w]);return{migrateValidation:(0,p.useMemo)(()=>{var n,r,i,d,c,u,p;if(!t)return{canMigrate:!1,reason:"Loading services..."};if([tv.E.DEPLOYED,tv.E.DEPLOYING,tv.E.STOPPING].some(e=>e===l))return{canMigrate:!1,reason:"Unable to switch while Pearl is running"};if(!o)return{canMigrate:!1,reason:"Loading balance..."};if(!f)return{canMigrate:!1,reason:"Loading staking contract information..."};if(!j)return{canMigrate:!1,reason:"Cannot obtain staking contract information"};if(x===e)return{canMigrate:!1,reason:"This staking program is already selected"};if((null===(n=null!==(i=j.serviceIds)&&void 0!==i?i:[])||void 0===n?void 0:n.length)>=(null!==(d=j.maxNumServices)&&void 0!==d?d:0))return{canMigrate:!1,reason:"The program has no more available slots"};if((null!==(c=j.availableRewards)&&void 0!==c?c:0)<=0)return{canMigrate:!1,reason:"This program has no rewards available"};if((null!==(u=j.serviceIds)&&void 0!==u?u:[]).length>=(null!==(p=j.maxNumServices)&&void 0!==p?p:0))return{canMigrate:!1,reason:"The program has no more available slots"};if(!T)return{canMigrate:!1,reason:"Insufficient OLAS to switch"};if(null===x&&!y)return{canMigrate:!0};let h=null===(r=nE.Z5[s])||void 0===r?void 0:r[e];if(!h)return{canMigrate:!1,reason:"Switching to this program is not currently supported"};let{deprecated:m,agentsSupported:g}=h;return m||!g.includes(a)?{canMigrate:!1,reason:"Switching to this program is not currently supported"}:v?{canMigrate:!0}:{canMigrate:!1,reason:"Pearl has not been staked for the required minimum duration"}},[t,o,f,j,x,e,T,y,s,a,v,l]),firstDeployValidation:(0,p.useMemo)(()=>{var n,r,a,s;if(!t)return{canMigrate:!1,reason:"Loading services..."};if([tv.E.DEPLOYED,tv.E.DEPLOYING,tv.E.STOPPING].some(e=>e===l))return{canMigrate:!1,reason:"Unable to switch while Pearl is running"};if(!o)return{canMigrate:!1,reason:"Loading balance..."};if(!f)return{canMigrate:!1,reason:"Loading staking contract information..."};let i=null==g?void 0:g[e];return i?(null===(n=null!==(r=i.serviceIds)&&void 0!==r?r:[])||void 0===n?void 0:n.length)>=(null!==(a=i.maxNumServices)&&void 0!==a?a:0)?{canMigrate:!1,reason:"The program has no more available slots"}:(null!==(s=null==i?void 0:i.availableRewards)&&void 0!==s?s:0)<=0?{canMigrate:!1,reason:"This program has no rewards available"}:(null==i?void 0:i.maxNumServices)?C?m?{canMigrate:!0}:{canMigrate:!1,reason:"Insufficient XDAI to switch"}:{canMigrate:!1,reason:"Insufficient OLAS to switch"}:{canMigrate:!1,reason:"The program has no more available slots"}:{canMigrate:!1,reason:"Cannot obtain staking contract information"}},[t,o,m,f,g,e,C,l]),canUpdateStakingContract:(0,p.useMemo)(()=>!!o&&!c&&!h&&!!b,[o,c,h,b])}},{Text:lI}=m.default,lM=e=>{var t;let{stakingProgramId:n}=e,{selectedAgentConfig:r}=(0,k.S)(),{isAllStakingContractDetailsRecordLoaded:a}=(0,nL.n9)(),{isLoaded:s,totalStakedOlasBalance:i}=(0,eo.AE)(),{masterSafeBalances:l,masterSafeNativeGasRequirement:o}=(0,eo.PU)(),{serviceFundRequirements:d,isInitialFunded:c}=n6(n),h=d[r.evmHomeChainId][tS.W.OLAS],m=(0,p.useMemo)(()=>{if(s&&!(ex()(l)||eh()(l)))return l.reduce((e,t)=>{let{evmChainId:n,symbol:a,balance:s}=t;return n===r.evmHomeChainId&&(e[a]=s),e},{})},[s,l,r.evmHomeChainId]);if(!a||ex()(h)||ex()(null==m?void 0:m[tS.W.OLAS])||ex()(i)||ex()(o))return null;let g=h-lN()([m[tS.W.OLAS],i]),f=r.evmHomeChainId,y=(0,tb.Ro)(f),v=m[y]||0,j=(null===(t=d[f])||void 0===t?void 0:t[y])||0,b=c?o:j-v;return(0,u.jsx)(ee,{type:"warning",showIcon:!0,message:(0,u.jsxs)(x.Z,{vertical:!0,gap:4,children:[(0,u.jsx)(lI,{className:"font-weight-600",children:"Additional funds required"}),(0,u.jsxs)(lI,{children:[(0,u.jsxs)("ul",{style:{marginTop:0,marginBottom:4},children:[g>0&&(0,u.jsx)("li",{children:"".concat((0,M.mT)(g,2)," ").concat(tS.W.OLAS)}),b>0&&(0,u.jsx)("li",{children:"".concat((0,M.mT)(b,2)," ").concat(y)})]}),"Add the required funds to your account to meet the staking requirements."]})]})})},l_=()=>(0,u.jsx)(ee,{type:"warning",showIcon:!0,message:(0,u.jsx)(lI,{children:"No slots currently available - try again later."})}),lA=e=>{let{stakingProgramId:t,cantMigrateReason:n}=e;return n===d.NoAvailableStakingSlots?(0,u.jsx)(l_,{}):n===d.InsufficientOlasToMigrate||n===d.InsufficientGasToMigrate?(0,u.jsx)(lM,{stakingProgramId:t}):null};var lL=n(2275);let lF=()=>{let{migrationModalOpen:e,setMigrationModalOpen:t}=(0,p.useContext)(lL.t);return{migrationModalOpen:e,setMigrationModalOpen:t}},{Text:lO}=m.default,lR=e=>{let{currentStakingContractInfo:t}=e,[n,r]=(0,p.useState)();(0,rl.Yz)(()=>{if(!t||!("serviceStakingStartTime"in t)||!("minimumStakingDuration"in t))return;let{serviceStakingStartTime:e,minimumStakingDuration:n}=t;if(ex()(n)||ex()(e))return;let a=n-(Math.round(Date.now()/1e3)-e);if(a<0){r(0);return}r(a)},1e3);let a=ex()(n)?"Loading...":nH(n);return(0,u.jsxs)(x.Z,{vertical:!0,gap:1,style:{maxWidth:nN.E7},children:[(0,u.jsx)(lO,{strong:!0,children:"Can't switch because you unstaked too recently."}),(0,u.jsx)(lO,{children:"This may be because your agent was suspended."}),(0,u.jsx)(lO,{children:"Keep running your agent and you'll be able to switch in"}),(0,u.jsx)(lO,{children:a})]})},lD=e=>{let{stakingProgramId:t}=e,{goto:n}=(0,S.a)(),{setPaused:r,isFetched:a,selectedService:s,selectedAgentType:i,selectedAgentConfig:l,overrideSelectedServiceStatus:o}=(0,k.S)(),c=a&&s?s.service_config_id:"",h=(0,p.useMemo)(()=>n1.J9.find(e=>e.agentType===i),[i]),{setIsPaused:m}=(0,eo.AE)(),{defaultStakingProgramId:x,setDefaultStakingProgramId:g}=(0,nP.x)(),{selectedStakingContractDetails:y,isSelectedStakingContractDetailsLoading:v}=(0,nL.S9)(),{stakingContractInfo:j}=(0,nL.c5)(x),w=(0,p.useMemo)(()=>{if(!v)return y||j},[y,j,v]),{setMigrationModalOpen:T}=lF(),{migrateValidation:C,firstDeployValidation:Z}=lP(t),E=(0,p.useMemo)(()=>{var e,t;if(!a)return!1;let n=l.evmHomeChainId,r=ex()(null==s?void 0:s.chain_configs)?null:null==s?void 0:null===(t=s.chain_configs)||void 0===t?void 0:null===(e=t[(0,I.fG)(n)])||void 0===e?void 0:e.chain_data,i=null==r?void 0:r.token;return!(s&&(0,n3.qV)(i))},[a,l.evmHomeChainId,s])?Z:C,N=(0,p.useMemo)(()=>E.canMigrate?null:E.reason!==d.NotStakedForMinimumDuration||ex()(w)?E.reason:(0,u.jsx)(lR,{currentStakingContractInfo:w}),[w,E]);return(0,u.jsx)(nF.Z,{content:N,children:(0,u.jsx)(f.ZP,{type:"primary",size:"large",disabled:!E.canMigrate,onClick:async()=>{if(h){r(!0),m(!0),g(t);try{o(tv.E.DEPLOYING),n(b.i.Main),s?await n8.ServicesService.updateService({serviceConfigId:c,partialServiceTemplate:{configurations:{...Object.entries(h.configurations).reduce((e,n)=>{let[r]=n;return e[r]={staking_program_id:t},e},{})}}}):await n8.ServicesService.createService({stakingProgramId:t,serviceTemplate:h,deploy:!0}),await n8.ServicesService.startService(c),T(!0)}catch(e){console.error(e)}finally{o(null),r(!1),m(!1)}}},children:"Switch and run agent"})})};function lB(){let e=(0,H._)(["\n  display: flex;\n  flex-direction: column;\n"]);return lB=function(){return e},e}function lz(){let e=(0,H._)(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  font-size: ",";\n  color: ",";\n  width: 100%;\n  gap: 12px;\n"]);return lz=function(){return e},e}function lW(){let e=(0,H._)(["\n  flex: 1;\n  border-top: ",";\n"]);return lW=function(){return e},e}let lH=U.ZP.div(lB()),lq=U.ZP.div(lz(),e=>{let{size:t}=e;switch(t){case"small":return"14px";case"large":return"16px";default:return"inherit"}},P.r.TEXT),lU=U.ZP.span(lW(),e=>{let{color:t}=e;return"1px solid ".concat("primary"===t?P.r.PURPLE_LIGHT:P.r.BORDER_GRAY)}),lY=e=>{let{list:t,parentStyle:n,size:r,color:a}=e;return 0===t.length?null:(0,u.jsx)(lH,{style:n,children:t.map((e,t)=>(0,u.jsxs)(lq,{size:r,children:[(0,u.jsx)("span",{className:e.leftClassName,children:e.left}),(0,u.jsx)(lU,{color:a}),(0,u.jsx)("span",{className:e.rightClassName||"font-weight-600",children:e.right})]},e.id||t))})},lG=e=>{let{stakingProgramId:t}=e,{allStakingContractDetailsRecord:n,isAllStakingContractDetailsRecordLoaded:r}=(0,nL.n9)(),a=(0,p.useMemo)(()=>{var e;if(!r||!n||!t||!(null==n?void 0:n[t]))return;let a=n[t];return[{left:"Available slots",right:"".concat(a.maxNumServices-a.serviceIds.length," / ").concat(a.maxNumServices)},{left:"Rewards per epoch",right:"~ ".concat(null===(e=a.rewardsPerWorkPeriod)||void 0===e?void 0:e.toFixed(2)," OLAS")},{left:"Estimated Annual Percentage Yield (APY)",right:"".concat(a.apy,"%"),leftClassName:"max-width-200"},{left:"Required OLAS for staking",right:"".concat(a.olasStakeRequired," OLAS")}]},[r,n,t]);return r?n&&a&&0!==a.length&&a&&0!==a.length?(0,u.jsx)(lY,{list:a,parentStyle:{gap:12},color:"primary"}):(0,u.jsx)(V.Z,{message:"No staking information available.",type:"error",showIcon:!0}):(0,u.jsx)(eH.Z,{active:!0})},lQ=()=>{let[e,t]=(0,p.useState)(!1);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(f.ZP,{type:"default",size:"large",onClick:()=>t(e=>!e),children:[e?"Hide":"Show"," address to fund"]}),e&&(0,u.jsx)(rY,{})]})},{Title:l$}=m.default,{useToken:lK}=aE.default,lX=e=>{let{status:t}=e;return t===o.Active?(0,u.jsx)(a0.Z,{color:"purple",children:"Active"}):t===o.Default?(0,u.jsx)(a0.Z,{color:"purple",children:"Default"}):null},lV=e=>{var t;let{stakingProgramId:n}=e,{token:r}=lK(),{migrateValidation:a}=lP(n),{defaultStakingProgramId:s,activeStakingProgramId:i,selectedStakingProgramId:l,allStakingProgramsMeta:c,isActiveStakingProgramLoaded:h}=(0,nP.x)(),{selectedAgentConfig:m}=(0,k.S)(),g=(0,p.useMemo)(()=>h?i===n?o.Active:i||n!==s?null:o.Default:null,[i,s,h,n]),f=h&&n!==l,y=(0,p.useMemo)(()=>!!h&&!a.canMigrate&&(a.reason===d.InsufficientOlasToMigrate||a.reason===d.InsufficientGasToMigrate),[h,a]),v=null==c?void 0:c[n],j=m.evmHomeChainId,b=null===(t=nE.Xy[j])||void 0===t?void 0:t[n];return(0,u.jsxs)(th,{style:{padding:"16px 24px",backgroundColor:g?r.colorPrimaryBg:void 0},borderbottom:"true",vertical:!0,gap:16,children:[(0,u.jsxs)(x.Z,{gap:12,children:[(0,u.jsx)(l$,{level:5,className:"m-0",children:(null==v?void 0:v.name)||"Unknown"}),(0,u.jsx)(lX,{status:g})]}),(0,u.jsx)(lG,{stakingProgramId:n}),j&&b&&(0,u.jsx)(lZ.N,{address:b,middlewareChain:m.middlewareHomeChainId,prefix:"View contract details"}),!a.canMigrate&&(0,u.jsx)(lA,{stakingProgramId:n,cantMigrateReason:a.reason}),f&&(0,u.jsx)(lD,{stakingProgramId:n}),y&&(0,u.jsx)(lQ,{})]})},{Text:lJ}=m.default,l0=[{key:1,label:(0,u.jsx)(lJ,{className:"font-weight-600",children:"What are staking contracts?"}),children:(0,u.jsxs)(x.Z,{vertical:!0,gap:12,children:[(0,u.jsx)(lJ,{children:"When your agent goes to work, it participates in staking contracts."}),(0,u.jsx)(lJ,{children:"Staking contracts define what the agent needs to do, how much OLAS needs to be staked, etc., to be eligible for rewards."}),(0,u.jsx)(lJ,{children:"Your agent can only participate in one staking contract at a time."})]})}],l1=()=>(0,u.jsx)(th,{borderbottom:"true",justify:"space-between",align:"center",padding:"0",children:(0,u.jsx)(nx.Z,{items:l0,ghost:!0})}),l2=()=>{let{selectedAgentConfig:e}=(0,k.S)(),{activeStakingProgramId:t,isActiveStakingProgramLoaded:n,defaultStakingProgramId:r}=(0,nP.x)(),a=n?t||r:null,s=(0,p.useMemo)(()=>{var t;return null!==(t=nE.Z5[e.evmHomeChainId])&&void 0!==t?t:{}},[e.evmHomeChainId]),i=(0,p.useMemo)(()=>Object.keys(s).map(e=>e),[s]),l=(0,p.useMemo)(()=>i.reduce((e,t)=>{if(!n)return e;if(t===a)return[t,...e];let r=s[t];return(null==r?void 0:r.deprecated)?e:[...e,t]},[]),[n,a,i,s]),o=l.filter(e=>{if(!n)return!1;let t=s[e];return!!t&&a!==e&&!t.deprecated}),d=(0,p.useMemo)(()=>0===o.length?"No other staking contracts available at this time.":"Browse ".concat(o.length," staking contract").concat(1===o.length?"":"s","."),[o.length]);return(0,u.jsxs)(q.Z,{title:(0,u.jsx)(B,{title:"Manage staking contract"}),bordered:!1,styles:{body:{paddingTop:0,paddingBottom:0}},extra:(0,u.jsx)(W,{}),children:[(0,u.jsx)(l1,{}),n&&(t||r)&&(0,u.jsx)(lV,{stakingProgramId:l[0]}),(0,u.jsx)(th,{style:{padding:24},borderbottom:"true",vertical:!0,gap:16,children:d}),o.map(e=>(0,u.jsx)(lV,{stakingProgramId:e},e))]})},{Text:l6}=m.default,l4={[rB.W2.Ethereum]:"eth",[rB.JM.Base]:"base",[rB.JM.Optimism]:"oeth",[rB.JM.Gnosis]:"gno",[rB.JM.Mode]:""},l5=()=>{let{masterSafes:e}=(0,eb.Q)(),{selectedAgentConfig:{evmHomeChainId:t}}=(0,k.S)(),n=null==e?void 0:e.find(e=>{let{evmChainId:n}=e;return t===n}),r=(null==n?void 0:n.evmChainId)&&l4[n.evmChainId];return(0,u.jsx)(q.Z,{title:(0,u.jsx)(B,{title:"Add backup wallet via Safe"}),bordered:!1,extra:(0,u.jsx)(W,{}),children:(0,u.jsxs)(x.Z,{vertical:!0,gap:16,children:[(0,u.jsxs)(x.Z,{vertical:!0,gap:4,children:[(0,u.jsx)(l6,{children:"Manually add backup wallet via Safe interface:"}),(null==n?void 0:n.address)?(0,u.jsxs)("a",{target:"_blank",href:"https://app.safe.global/settings/setup?safe=".concat(r,":").concat(n.address),children:["Open Safe interface ",er.$.EXTERNAL_LINK]}):(0,u.jsx)(eH.Z.Input,{style:{width:200}})]}),(0,u.jsxs)(x.Z,{vertical:!0,gap:4,children:[(0,u.jsx)(l6,{children:"Not sure how?"}),(0,u.jsxs)("a",{target:"_blank",href:ea.zf,children:["Get community assistance via Discord ticket"," ",er.$.EXTERNAL_LINK]})]})]})})};var l8=n(37228);let l3=()=>{let{goto:e}=tn();return(0,u.jsx)(f.ZP,{size:"large",icon:(0,u.jsx)(z.Z,{}),onClick:()=>e(sO.Q.Welcome)})},{Title:l9,Paragraph:l7}=m.default,oe=()=>(0,u.jsx)(B,{title:(0,u.jsxs)(x.Z,{gap:10,children:[(0,u.jsx)(l8.Z,{}),"Help & support"]})}),ot=()=>{let{isUserLoggedIn:e}=(0,S.a)(),[t,n]=(0,p.useState)(null),{getAppVersion:r}=(0,ei.Z)(),a=(0,rl.tm)();return(0,p.useEffect)(()=>{(async()=>{if("function"==typeof r)try{let e=await r();e&&a()&&n(e)}catch(e){console.error("Failed to get app version:",e)}})()},[r,a]),(0,u.jsxs)(q.Z,{title:(0,u.jsx)(oe,{}),bordered:!1,styles:{body:{paddingTop:0,paddingBottom:0}},extra:e?(0,u.jsx)(W,{}):(0,u.jsx)(l3,{}),children:[(0,u.jsxs)(th,{$borderBottom:!0,$padding:"16px 24px 24px",vertical:!0,children:[(0,u.jsx)(l9,{level:5,className:"m-0 mb-16 text-base",children:"Frequently asked questions"}),(0,u.jsxs)("a",{target:"_blank",href:ea.A1,className:"mb-8",children:["Read FAQ ",er.$.EXTERNAL_LINK]}),t&&(0,u.jsxs)("a",{href:"".concat(ea.Fv,"/tag/v").concat(t),target:"_blank",rel:"noopener noreferrer",className:"mb-8",children:["Release notes ",er.$.EXTERNAL_LINK]}),(0,u.jsxs)("a",{target:"_blank",href:ea.Vf,children:["Terms and Conditions ",er.$.EXTERNAL_LINK]})]}),(0,u.jsxs)(th,{$borderBottom:!0,$padding:"16px 24px 24px",vertical:!0,children:[(0,u.jsx)(l9,{level:5,className:"m-0 mb-8 text-base",children:"Ask for help"}),(0,u.jsx)(l7,{type:"secondary",className:"mb-16 text-sm",children:"Get your questions answered by the community."}),(0,u.jsxs)("a",{target:"_blank",href:ea.av,children:["Olas community Discord server ",er.$.EXTERNAL_LINK]})]}),(0,u.jsxs)(th,{padding:"16px 24px 24px",vertical:!0,align:"start",children:[(0,u.jsx)(l9,{level:5,className:"m-0 mb-16 text-base ",children:"Export logs for troubleshooting"}),(0,u.jsx)(eP,{})]})]})};var on=n(13538),or=n(22904);function oa(){let e=(0,H._)(["\n  padding: 24px 24px 16px 24px;\n  border-bottom: 1px solid ",";\n"]);return oa=function(){return e},e}function os(){let e=(0,H._)(["\n  padding: 16px 24px;\n  border-bottom: 1px solid ",";\n"]);return os=function(){return e},e}let{Text:oi,Title:ol}=m.default,oo={fontSize:48,color:P.r.TEXT_LIGHT},od={components:{Card:{paddingLG:16}}},oc=U.ZP.div(oa(),P.r.BORDER_GRAY),ou=(0,U.ZP)(eJ.Z)(os(),P.r.BORDER_GRAY),op=e=>e?"~".concat((0,M.mT)(null!=e?e:0,2)," OLAS"):"0 OLAS",oh=()=>(0,u.jsx)(a0.Z,{color:"success",className:"m-0",children:"Earned"}),om=()=>(0,u.jsx)(a0.Z,{color:"red",className:"m-0",children:"Not earned"}),ox=()=>(0,u.jsx)(a0.Z,{color:"processing",className:"m-0",children:"Not yet earned"}),og=e=>{let{children:t}=e;return(0,u.jsx)(x.Z,{vertical:!0,gap:24,align:"center",justify:"center",style:{height:400},children:t})},of=()=>(0,u.jsx)(og,{children:(0,u.jsx)(g.Z,{})}),oy=()=>(0,u.jsxs)(og,{children:[(0,u.jsx)(on.Z,{style:oo}),(0,u.jsx)(oi,{type:"secondary",children:"Theres no history of rewards yet"})]}),ov=e=>{let{refetch:t}=e;return(0,u.jsxs)(og,{children:[(0,u.jsx)(nh.Z,{style:oo}),(0,u.jsx)(oi,{type:"secondary",children:"Error loading data"}),(0,u.jsx)(f.ZP,{onClick:t,children:"Try again"})]})},oj=()=>(0,u.jsx)(x.Z,{vertical:!0,style:{height:60},align:"center",justify:"center",children:(0,u.jsx)(oi,{type:"secondary",children:"Theres no history of rewards yet."})}),ob=e=>{let{epoch:t,epochEndTimeStamp:n,epochStartTimeStamp:r,transactionHash:a}=e,{selectedAgentConfig:s}=(0,k.S)(),{middlewareHomeChainId:i}=s,l=(0,p.useMemo)(()=>r&&n?"".concat(nW(1e3*r)," - ").concat(nW(1e3*n)," (UTC)"):r?"".concat(nB(1e3*r)," (UTC)"):"NA",[r,n]);return(0,u.jsxs)(oi,{type:"secondary",children:["Epoch ".concat(t),"\xa0",(0,u.jsx)(nF.Z,{arrow:!1,placement:"topRight",content:(0,u.jsxs)(x.Z,{vertical:!0,gap:4,className:"text-sm",style:{width:280},children:[(0,u.jsx)(ol,{level:5,className:"text-sm m-0",children:"Epoch duration"}),(0,u.jsx)(oi,{type:"secondary",className:"text-sm m-0",children:l}),a&&(0,u.jsxs)("a",{href:"".concat(ea.Tz[i],"/tx/").concat(a),target:"_blank",children:["End of epoch transaction ",er.$.EXTERNAL_LINK]})]}),children:(0,u.jsx)($.Z,{})})]})},ow=e=>{let{epochSummary:t,earned:n,reward:r}=e;return(0,u.jsxs)(ou,{children:[(0,u.jsx)(e0.Z,{span:6,children:t}),(0,u.jsx)(e0.Z,{span:11,className:"text-center",children:n}),(0,u.jsx)(e0.Z,{span:7,className:"text-right",children:(0,u.jsx)(oi,{type:"secondary",children:r})})]})},oS=e=>{var t;let{checkpoints:n,stakingProgramId:r,selectedAgentConfig:a}=e,s=null===(t=nE.Z5[a.evmHomeChainId])||void 0===t?void 0:t[r],{availableRewardsForEpochEth:i,isEligibleForRewards:l}=(0,ri.D)(),o=(0,p.useMemo)(()=>{var e;return(0,u.jsx)(oc,{children:(0,u.jsx)(oi,{strong:!0,children:null!==(e=null==s?void 0:s.name)&&void 0!==e?e:"Supafund staking"})})},[s]);return 0===n.length?(0,u.jsxs)(x.Z,{vertical:!0,children:[o,(0,u.jsx)(oj,{})]}):(0,u.jsxs)(x.Z,{vertical:!0,children:[o,(0,u.jsx)(ow,{epochSummary:(0,u.jsx)(ob,{epoch:Number(n[0].epoch)+1,epochStartTimeStamp:n[0].epochEndTimeStamp,epochEndTimeStamp:n[0].epochEndTimeStamp+86400}),reward:op(i),earned:l?(0,u.jsx)(oh,{}):(0,u.jsx)(ox,{})}),n.map(e=>(0,u.jsx)(ow,{epochSummary:(0,u.jsx)(ob,{epoch:Number(e.epoch),epochStartTimeStamp:e.epochStartTimeStamp,epochEndTimeStamp:e.epochEndTimeStamp,transactionHash:e.transactionHash}),reward:op(e.reward),earned:e.earned?(0,u.jsx)(oh,{}):(0,u.jsx)(om,{})},e.epochEndTimeStamp))]})},ok=()=>{let{contractCheckpoints:e,isError:t,isFetched:n,refetch:r}=sm(),{selectedService:a,selectedAgentConfig:s}=(0,k.S)(),{serviceNftTokenId:i}=(0,ny.G)(null==a?void 0:a.service_config_id),l=(0,p.useMemo)(()=>{var l;if(!n||!(null==a?void 0:a.service_config_id))return(0,u.jsx)(of,{});if(t)return(0,u.jsx)(ov,{refetch:r});if(!e||0===Object.keys(e).length)return(0,u.jsx)(oy,{});let o=null===(l=Object.values(e).flat().sort((e,t)=>t.epochEndTimeStamp-e.epochEndTimeStamp).find(e=>e.serviceIds.includes("".concat(i))))||void 0===l?void 0:l.contractAddress,d=Object.keys(e).sort((e,t)=>e===o?-1:t===o?1:0);return s.evmHomeChainId?(0,u.jsx)(x.Z,{vertical:!0,gap:16,children:d.map(t=>{var n,r;let a=e[t],[i]=null!==(r=Object.entries(null!==(n=nE.Xy[s.evmHomeChainId])&&void 0!==n?n:{}).find(e=>{let[,n]=e;return n.toLowerCase()===t.toLowerCase()}))&&void 0!==r?r:[null,null];return i?(0,u.jsx)(oS,{stakingProgramId:i,checkpoints:a,selectedAgentConfig:s},t):null})}):null},[n,null==a?void 0:a.service_config_id,t,r,e,s,i]);return(0,u.jsx)(or.ZP,{theme:od,children:(0,u.jsx)(G,{bordered:!1,title:(0,u.jsx)(B,{title:"Staking rewards history"}),noBodyPadding:"true",extra:(0,u.jsx)(W,{}),children:l})})};var oT=n(26163),oC=n(66487),oZ=n(88695);let oE=()=>(0,p.useContext)(oZ.J);var oN=n(35185);let oP=e=>0===e?null:Intl.DateTimeFormat("en-US",{dateStyle:"medium",timeStyle:"long"}).format(new Date(e));function oI(){let e=(0,H._)(["\n  top: 24px;\n  height: calc(100vh - 48px);\n  display: flex;\n  flex-direction: column;\n\n  .ant-modal-content {\n    height: calc(100vh - 48px);\n    display: flex;\n    flex-direction: column;\n    padding: 0;\n  }\n\n  .ant-modal-header {\n    padding: 16px 24px;\n    margin: 0;\n    border-bottom: 1px solid ",";\n  }\n\n  .ant-modal-body {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    overflow-y: auto;\n    border-radius: 12px;\n    padding: ",";\n  }\n"]);return oI=function(){return e},e}let oM=(0,U.ZP)(nZ.Z)(oI(),P.r.BORDER_GRAY,e=>{let{bodyPadding:t}=e;return t?"20px":"0"}),{Text:o_}=m.default,oA=()=>{let{selectedAgentConfig:e}=(0,k.S)(),{selectedStakingContractDetails:t}=(0,nL.n9)(),n=null==e?void 0:e.displayName,r=null==t?void 0:t.serviceStakingState,a=(0,p.useMemo)(()=>r===oN.s.Evicted?"Evicted":r===oN.s.Staked?"Staked":r===oN.s.NotStaked?"Not Staked":null,[r]),s=null==t?void 0:t.serviceStakingStartTime,i=s?oP(1e3*s):null,l=(0,p.useMemo)(()=>{var e,n;return 0!==s&&t?oP(1e3*((null!==(e=null==t?void 0:t.serviceStakingStartTime)&&void 0!==e?e:0)+(null!==(n=null==t?void 0:t.minimumStakingDuration)&&void 0!==n?n:0))):null},[s,t]),o=(0,p.useMemo)(()=>[{key:"Name",value:null!=n?n:er.NA},{key:"Status",value:null!=a?a:er.NA},{key:"Last staked",value:null!=i?i:er.NA,column:!0},{key:"Can be unstaked at",value:ex()(l)?er.NA:l,column:!0}],[n,a,i,l]);return(0,u.jsxs)(x.Z,{vertical:!0,style:{padding:"16px 24px"},gap:8,children:[(0,u.jsx)(o_,{children:"Agent staking details:"}),e?o.map(e=>{let{key:t,value:n,column:r}=e;return(0,u.jsxs)(x.Z,{gap:r?2:8,vertical:!!r,align:r?"start":"center",children:[(0,u.jsxs)(o_,{type:"secondary",className:"text-sm",children:[t,":"]}),(0,u.jsx)(o_,{strong:!0,children:n})]},t)}):(0,u.jsx)(o_,{type:"secondary",children:"No agent staking info available."})]})},oL=()=>{let[e,t]=(0,p.useState)(!1),n=(0,p.useCallback)(()=>t(!0),[]),r=(0,p.useCallback)(()=>t(!1),[]);return(0,u.jsxs)(th,{vertical:!0,gap:8,align:"start",padding:"24px",children:[(0,u.jsx)(o_,{strong:!0,children:"Debug data (for devs)"}),(0,u.jsx)(f.ZP,{type:"primary",ghost:!0,size:"large",onClick:n,children:"Show debug data"}),(0,u.jsx)(oM,{title:"Debug data",open:e,footer:null,width:nN.iF,onCancel:r,destroyOnClose:!0,children:(0,u.jsx)(oA,{})})]})},{Text:oF,Paragraph:oO}=m.default,oR=()=>(0,u.jsx)(B,{title:(0,u.jsxs)(x.Z,{gap:10,children:[(0,u.jsx)(oT.Z,{}),"Settings"]})}),oD=()=>{let{goto:e}=(0,S.a)();return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(oF,{type:"secondary",children:"No backup wallet added."}),(0,u.jsx)(th,{style:{marginTop:12},children:(0,u.jsx)(ee,{type:"warning",fullWidth:!0,showIcon:!0,message:(0,u.jsxs)(x.Z,{vertical:!0,gap:5,children:[(0,u.jsx)("span",{className:"font-weight-600",children:"Your funds are at risk!"}),(0,u.jsx)("span",{children:"Add a backup wallet to allow you to retrieve funds if you lose your password and seed phrase."}),(0,u.jsx)(oF,{className:"pointer hover-underline text-primary",onClick:()=>e(b.i.AddBackupWalletViaSafe),children:"See instructions"})]})})})]})},oB=()=>{let{screen:e}=oE();return(0,p.useMemo)(()=>e===oC.a.Main?(0,u.jsx)(oz,{}):null,[e])},oz=()=>{let e=rs("backup-via-safe"),{isUserLoggedIn:t}=(0,S.a)(),{selectedAgentConfig:n}=(0,k.S)(),{masterEoa:r,masterSafes:a}=(0,eb.Q)(),{owners:s,ownersIsFetched:i}=ew(null==a?void 0:a.find(e=>{let{evmChainId:t}=e;return n.evmHomeChainId===t})),l=(0,p.useMemo)(()=>{if(i&&r)return ex()(s)||eh()(s)?[]:s.filter(e=>e.toLowerCase()!==r.address.toLowerCase())},[i,s,r]),o=(0,p.useMemo)(()=>{if(!ex()(l))return l[0]},[l]),d=(0,p.useMemo)(()=>i?o?(0,u.jsx)(lZ.N,{address:o,middlewareChain:n.middlewareHomeChainId}):(0,u.jsx)(oD,{}):(0,u.jsx)(eH.Z.Input,{}),[o,i,n.middlewareHomeChainId]);return(0,u.jsxs)(q.Z,{title:(0,u.jsx)(oR,{}),bordered:!1,styles:{body:{paddingTop:0,paddingBottom:0}},extra:t?(0,u.jsx)(W,{}):(0,u.jsx)(l3,{}),children:[(0,u.jsx)(th,{$padding:"24px",$borderBottom:!0,justify:"space-between",align:"center",children:(0,u.jsxs)(x.Z,{vertical:!0,children:[(0,u.jsx)(oO,{strong:!0,children:"Password"}),(0,u.jsx)(oF,{style:{lineHeight:1},children:"********"})]})}),e||o?(0,u.jsxs)(th,{$padding:"24px",$borderBottom:!!o,vertical:!0,gap:8,children:[(0,u.jsx)(oF,{strong:!0,children:"Backup wallet"}),d]}):null,(0,u.jsx)(oL,{})]})},oW=[{title:"Personalized Trading Strategy",desc:"The Supafund Agent uses your personal weights to trade on prediction markets about emerging projects and startups achieving key milestones.",imgSrc:"setup-agent-prediction-1"},{title:"Discover Promising Projects",desc:"Access the agent's trading reasoning to discover and evaluate new projects. Each trade includes detailed AI-powered analysis of why the agent believes a project will succeed or fail.",imgSrc:"setup-agent-prediction-2"},{title:"Earn Rewards",desc:"Earn rewards in xDAI for your agent's accurate predictions about project milestones, funding rounds, and mainnet launches.",imgSrc:"setup-agent-prediction-3"}];var oH=n(95249);let{Title:oq,Text:oU}=m.default,oY=e=>{let{imgSrc:t,alt:n}=e;return(0,u.jsx)(a1.M,{mode:"wait",children:(0,u.jsx)(aY.E.div,{initial:{opacity:0,x:10,scale:.99},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.99},transition:{opacity:{duration:.1},scale:{duration:.1},duration:.1},children:(0,u.jsx)(v(),{src:t,alt:n,priority:!0,width:0,height:0,sizes:"100vw",style:{width:"100%",height:"auto"}})},t)})},oG=e=>{let{title:t,desc:n,helper:r}=e;return(0,u.jsx)(a1.M,{mode:"wait",children:(0,u.jsx)(aY.E.div,{initial:{opacity:0,x:5},animate:{opacity:1,x:0},exit:{opacity:0,x:-5},transition:{duration:.1},children:(0,u.jsxs)(x.Z,{vertical:!0,gap:8,children:[(0,u.jsx)(oq,{level:5,className:"m-0",children:t}),(0,u.jsx)(oU,{children:n}),r&&(0,u.jsx)(oU,{type:"secondary",className:"text-sm",children:r})]})},t)})},oQ=e=>{let{title:t,desc:n,imgSrc:r,helper:a,btnText:s,onPrev:i,onNext:l}=e,{selectedAgentConfig:o}=(0,k.S)();return(0,u.jsxs)("div",{style:{overflowX:"hidden",overflowY:"auto"},children:[(0,u.jsx)(oY,{imgSrc:"/".concat(r,".png"),alt:t}),(0,u.jsx)("div",{style:{padding:"12px 0px 20px 0px"},children:(0,u.jsxs)(x.Z,{vertical:!0,gap:24,children:[(0,u.jsx)("div",{style:{padding:"0px 20px"},children:(0,u.jsx)(oG,{title:t,desc:n,helper:a})}),o.isUnderConstruction&&(0,u.jsx)(aj,{}),(0,u.jsx)("div",{style:{padding:"0px 24px"},children:(0,u.jsxs)(x.Z,{gap:12,children:[(0,u.jsx)(f.ZP,{onClick:i,size:"large",style:{minWidth:40},icon:(0,u.jsx)(oH.Z,{})}),(0,u.jsx)(f.ZP,{onClick:l,type:"primary",block:!0,size:"large",children:s})]})})]})})]})},{Text:o$}=m.default,oK=e=>{let{steps:t,onOnboardingComplete:n,isUnderConstruction:r}=e,{onboardingStep:a,updateOnboardingStep:s}=n5(),i=(0,p.useCallback)(()=>{a===t.length-1?n():s(a+1)},[a,t.length,n,s]),l=(0,p.useCallback)(()=>{0!==a&&s(a-1)},[a,s]),o=(0,p.useMemo)(()=>a===t.length-1?r?"Return to agent selection":"Set up agent":"Continue",[a,t.length,r]);return(0,u.jsx)(oQ,{title:t[a].title,desc:t[a].desc,imgSrc:t[a].imgSrc,helper:t[a].helper,btnText:o,onPrev:l,onNext:i})},oX=()=>{let{goto:e}=tn(),{selectedAgentConfig:t}=(0,k.S)(),n=(0,p.useMemo)(()=>oW,[]),r=(0,p.useCallback)(()=>{e(sO.Q.SetupEoaFunding)},[e]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(x.Z,{align:"center",justify:"center",style:{paddingTop:12},children:(0,u.jsx)(o$,{children:t.displayName})}),(0,u.jsx)(tg.Z,{style:{margin:"12px 0 0 0"}}),(0,u.jsx)(oK,{steps:n,onOnboardingComplete:r,isUnderConstruction:!!t.isUnderConstruction})]})},oV=e=>(0,u.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"18",viewBox:"0 0 16 18",...e,children:(0,u.jsx)("path",{d:"M8.2816 4.81465C7.6976 4.81465 6.7936 4.15065 5.8416 4.17465C4.5856 4.19065 3.4336 4.90265 2.7856 6.03065C1.4816 8.29465 2.4496 11.6386 3.7216 13.4787C4.3456 14.3747 5.0816 15.3826 6.0576 15.3506C6.9936 15.3106 7.3456 14.7426 8.4816 14.7426C9.6096 14.7426 9.9296 15.3506 10.9216 15.3266C11.9296 15.3106 12.5696 14.4146 13.1856 13.5106C13.8976 12.4706 14.1936 11.4627 14.2096 11.4066C14.1856 11.3987 12.2496 10.6546 12.2256 8.41465C12.2096 6.54265 13.7536 5.64665 13.8256 5.60665C12.9456 4.31865 11.5936 4.17465 11.1216 4.14265C9.8896 4.04665 8.8576 4.81465 8.2816 4.81465ZM10.3616 2.92665C10.8816 2.30265 11.2256 1.43065 11.1296 0.56665C10.3856 0.59865 9.4896 1.06265 8.9536 1.68665C8.4736 2.23865 8.0576 3.12665 8.1696 3.97465C8.9936 4.03865 9.8416 3.55065 10.3616 2.92665Z",fill:e.fill})}),oJ=e=>(0,u.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",...e,children:(0,u.jsx)("path",{d:"M2.54295 5.00659C3.09787 3.90228 3.94883 2.97396 5.00082 2.32529C6.0528 1.67663 7.26439 1.33317 8.50029 1.33325C10.297 1.33325 11.8063 1.99392 12.9603 3.06992L11.049 4.98192C10.3576 4.32125 9.47895 3.98459 8.50029 3.98459C6.76362 3.98459 5.29362 5.15792 4.77029 6.73325C4.63695 7.13325 4.56095 7.55992 4.56095 7.99992C4.56095 8.43992 4.63695 8.86658 4.77029 9.26658C5.29429 10.8426 6.76362 12.0153 8.50029 12.0153C9.39695 12.0153 10.1603 11.7786 10.7576 11.3786C11.1039 11.1506 11.4004 10.8547 11.6291 10.5089C11.8578 10.1631 12.014 9.77449 12.0883 9.36658H8.50029V6.78792H14.779C14.8576 7.22392 14.9003 7.67859 14.9003 8.15125C14.9003 10.1819 14.1736 11.8913 12.9123 13.0513C11.8096 14.0699 10.3003 14.6666 8.50029 14.6666C7.62471 14.6669 6.75764 14.4947 5.94865 14.1598C5.13965 13.8249 4.40459 13.3339 3.78546 12.7147C3.16633 12.0956 2.67528 11.3606 2.34037 10.5516C2.00547 9.74256 1.83327 8.8755 1.83362 7.99992C1.83362 6.92392 2.09095 5.90659 2.54295 5.00659Z",fill:e.fill})}),o0=e=>{let{onFinish:t}=e,{ipcRenderer:n,web3AuthWindow:r}=(0,ei.Z)(),{setBackupSigner:a}=tn(),s=(0,p.useRef)(!1);return(0,p.useEffect)(()=>{var e;let i=e=>{if(!s.current&&e){var n;s.current=!0,null==r||null===(n=r.close)||void 0===n||n.call(r),a({address:e,type:"web3auth"}),t(),es.ZP.success("Backup wallet successfully set")}};return null==n||null===(e=n.on)||void 0===e||e.call(n,"web3auth-address-received",i),()=>{var e;null==n||null===(e=n.removeListener)||void 0===e||e.call(n,"web3auth-address-received",i)}}),{openWeb3AuthModel:()=>{(null==r?void 0:r.show)&&(null==r||r.show())}}},{Text:o1}=m.default,o2="Please input a valid backup wallet address!",o6=[{required:!0,len:42,pattern:/^0x[a-fA-F0-9]{40}$/,type:"string",message:o2}],o4=()=>{let{goto:e,setBackupSigner:t}=tn(),[n]=iU.Z.useForm(),{openWeb3AuthModel:r}=o0({onFinish:()=>{e(sO.Q.AgentIntroduction)}});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(iX,{layout:"vertical",form:n,onFinish:r=>{let a=(0,n2.getAddress)(r["backup-signer"].toLowerCase());if(!a)return n.setFields([{name:"backup-signer",errors:[o2]}]);t({address:a,type:"manual"}),e(sO.Q.AgentIntroduction)},children:[(0,u.jsx)(iU.Z.Item,{name:"backup-signer",label:"Enter Backup Wallet Address",rules:o6,children:(0,u.jsx)(iQ.Z,{size:"large",placeholder:"e.g. 0x12345...54321"})}),(0,u.jsx)(f.ZP,{type:"primary",size:"large",htmlType:"submit",children:"Continue"})]}),(0,u.jsx)(f.ZP,{type:"link",size:"large",onClick:r,children:(0,u.jsxs)(x.Z,{justify:"center",align:"center",children:["Set Up Wallet with\xa0",(0,u.jsx)(oJ,{fill:P.r.PRIMARY}),"\xa0/\xa0",(0,u.jsx)(oV,{fill:P.r.PRIMARY})]})}),(0,u.jsx)(o1,{type:"secondary",className:"text-sm mt-16",children:"Keep your backup wallet secure. If you lose both your password and backup wallet, you'll lose access to Pearl  permanently."})]})},{Text:o5}=m.default,o8=()=>{let{termsAndConditionsWindow:e}=(0,ei.Z)();return(0,u.jsxs)(o5,{type:"secondary",className:"text-sm mt-16",children:["Set Up with\xa0",(0,u.jsx)(oJ,{fill:P.r.GRAY_2,height:14,width:14,viewBox:"0 0 14 15"}),"\xa0/\xa0",(0,u.jsx)(oV,{fill:P.r.GRAY_2,height:15,width:15,viewBox:"0 0 15 16"}),"\xa0 authentication service is provided by Web3Auth. For details on how your data is handled during authentication, please refer to the\xa0",(0,u.jsx)("a",{onClick:()=>{var t;return null==e?void 0:null===(t=e.show)||void 0===t?void 0:t.call(e,"web3auth")},children:"Terms and Conditions"}),"."]})},o3=e=>{let{onSetUpManuallyClick:t}=e,{goto:n}=tn(),{openWeb3AuthModel:r}=o0({onFinish:()=>{n(sO.Q.AgentIntroduction)}});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(f.ZP,{type:"primary",size:"large",onClick:r,children:(0,u.jsxs)(x.Z,{justify:"center",align:"center",children:["Set Up with\xa0",(0,u.jsx)(oJ,{fill:P.r.WHITE}),"\xa0/\xa0",(0,u.jsx)(oV,{fill:P.r.WHITE})]})}),(0,u.jsx)(f.ZP,{size:"large",onClick:t,children:"Provide Existing Backup Wallet"}),(0,u.jsx)(o8,{})]})},{Title:o9,Text:o7}=m.default,de=()=>{let[e,t]=(0,p.useState)("web3auth");return(0,u.jsxs)(G,{$noBorder:!0,children:[(0,u.jsx)(iW,{prev:sO.Q.SetupSeedPhrase}),(0,u.jsx)(o9,{level:3,children:"Set backup wallet"}),(0,u.jsxs)(x.Z,{vertical:!0,gap:16,children:[(0,u.jsx)(o7,{className:"mb-16",children:"To help keep your funds safe, set up a backup wallet. Alternatively, you can add your existing crypto wallet as a backup if you have one."}),"web3auth"===e&&(0,u.jsx)(o3,{onSetUpManuallyClick:()=>t("manual")}),"manual"===e&&(0,u.jsx)(o4,{})]})]})},dt=e=>{let{selectedAgentConfig:t}=(0,k.S)(),{masterEoa:n}=(0,eb.Q)(),{refillRequirements:r,isBalancesAndFundingRequirementsLoading:a}=(0,w.C)(),s=t.middlewareHomeChainId;return(0,p.useCallback)(t=>{var i,l,o,d,c;if(a||!r||!(null==n?void 0:n.address))return;let u=t.findIndex(t=>(0,tC.J)(t[e].token,tw.d));if(-1===u)return;let p=null===(i=r[n.address])||void 0===i?void 0:i[tw.d],h=null===(l=r.master_safe)||void 0===l?void 0:l[tw.d];if(!p||!h)return;let m=null!==(c=null===(d=n1.J9.find(e=>e.home_chain===s))||void 0===d?void 0:null===(o=d.configurations[s])||void 0===o?void 0:o.monthly_gas_estimate)&&void 0!==c?c:0,x=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((e,t)=>t>e?t:e)}(BigInt(h),BigInt(m))+BigInt(p);return t[u].to.amount=x.toString(),t},[n,r,s,a,e])},dn=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"from",{selectedAgentConfig:r}=(0,k.S)(),{masterEoa:a}=(0,eb.Q)(),{refillRequirements:s,isBalancesAndFundingRequirementsLoading:i}=(0,w.C)(),l=dt(n),o=e===rB.W2.Ethereum?tb.hE:tb.vP[e],d=r.middlewareHomeChainId,c=null==a?void 0:a.address,u=null==a?void 0:a.address;return(0,p.useCallback)(function(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(i||!s||!c||!u)return null;let r=tb.vP[(0,I.DH)(d)],a=Object.entries(s),p=[];for(let[n,s]of a)if((0,tC.J)(n,u)||"master_safe"===n)for(let[n,a]of Object.entries(s)){if(!(0,n2.isAddress)(n))continue;let s=t||t9(n,o,r),i=(0,I.y)(e),l=n,h=p.find(e=>e.from.chain===i&&e.to.chain===d&&(0,tC.J)(e.from.address,c)&&(0,tC.J)(e.to.address,u)&&(0,tC.J)(e.from.token,s)&&(0,tC.J)(e.to.token,l));if(h){let e=BigInt(h.to.amount)+BigInt(a);h.to.amount=e.toString()}else p.push({from:{chain:i,address:c,token:s},to:{chain:d,address:u,token:l,amount:"".concat(a)}})}return{bridge_requests:l(p)||p,force_update:n}},[c,u,o,s,e,t,i,d,l])},dr=()=>{let{goto:e}=tn(),t=dn(rB.W2.Ethereum),n=(0,p.useCallback)(()=>{e(sO.Q.SetupEoaFunding)},[e]);return(0,u.jsx)(tX,{enabledStepsAfterBridging:["masterSafeCreationAndTransfer"],bridgeFromDescription:"The bridged amount covers all funds required to create your account and run your agent, including fees. No further funds will be needed.",getBridgeRequirementsParams:t,onPrevBeforeBridging:n})},{Text:da,Title:ds}=m.default,di=e=>{let{text:t}=e;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(v(),{src:"/onboarding-robot.svg",alt:"logo",width:80,height:80}),(0,u.jsx)(ds,{level:4,className:"m-0 mt-12 loading-ellipses",style:{width:"fit-content"},children:t}),(0,u.jsx)(da,{type:"secondary",children:"You will be redirected once the account is created."})]})},dl=()=>(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(v(),{src:"/broken-robot.svg",alt:"logo",width:80,height:80}),(0,u.jsx)(da,{type:"secondary",className:"mt-12",children:"Error, please restart the app and try again."}),(0,u.jsxs)(da,{style:{fontSize:"small"},children:["If the issue persists,"," ",(0,u.jsxs)("a",{href:ea.av,target:"_blank",rel:"noreferrer",children:["contact Olas community support ",er.$.EXTERNAL_LINK]}),"."]})]}),dd=()=>{let{goto:e}=(0,S.a)(),{masterSafes:t,refetch:n,isFetched:r}=(0,eb.Q)(),{masterSafesOwnersIsLoading:a}=eS(t),s=tr(),{selectedAgentType:i}=(0,k.S)(),l=n1.J9.find(e=>e.agentType===i),[o,d]=(0,p.useState)(!1),[c,h]=(0,p.useState)(!1),[m,x]=(0,p.useState)(!1),g=(0,p.useMemo)(()=>{if(t)return t.find(e=>e.evmChainId===(0,I.DH)(null==l?void 0:l.home_chain))},[t,null==l?void 0:l.home_chain]),f=(0,p.useCallback)(async(e,t)=>{for(let r=t;r>0;r--)try{await ta.X.createSafe(e,s),await (null==n?void 0:n()),h(!1),x(!0);break}catch(t){if(console.error(t),1===r)throw h(!0),x(!1),Error("Failed to create safe on ".concat(e));es.ZP.error("Failed to create account, retrying in 5 seconds... (".concat(r-1," retries left)")),await (0,e5.a)(5)}},[s,n]),y=(0,p.useMemo)(()=>o?"Creating accounts":m?"Account created":"Account creation in progress",[o,m]);return(0,p.useEffect)(()=>{if(c||o||!r||a)return;let e=l?Object.keys(l.configurations):null,n=e?e.reduce((e,n)=>((null==t?void 0:t.find(e=>e.evmChainId===(0,I.DH)(n)))||e.push(n),e),[]):[];(async()=>{for(let e of n){d(!0);let t=(0,I.KP)(e).displayName;try{await f(e,3),es.ZP.success("".concat(t," account created"))}catch(e){es.ZP.warning("Failed to create ".concat(t," account")),console.error(e)}}})().then(()=>{d(!1)})},[s,f,o,c,r,t,a,l]),(0,p.useEffect)(()=>{g&&(0,e5.a)(2).then(()=>{e(b.i.Main)})},[g,e]),(0,u.jsx)(q.Z,{bordered:!1,children:(0,u.jsx)(th,{vertical:!0,align:"center",justify:"center",$padding:"80px 24px",gap:12,children:c?(0,u.jsx)(dl,{}):(0,u.jsx)(di,{text:y})})})};var dc=n(39693),du=n.n(dc);let dp=()=>{let{defaultStakingProgramId:e}=(0,nP.x)(),{selectedAgentType:t,selectedService:n,refetch:r}=(0,k.S)(),a=n1.J9.find(e=>e.agentType===t);return(0,p.useCallback)(async()=>{if(!n){if(!e)throw Error("Default staking program ID unavailable");if(!a)throw Error("Service template unavailable");await (0,n3.tb)(e,a),await (null==r?void 0:r())}},[e,a,n,r])};function dh(){let e=(0,H._)(["\n  display: flex;\n  flex-direction: column;\n  padding: 16px;\n  border-radius: 12px;\n"]);return dh=function(){return e},e}function dm(){let e=(0,H._)(["\n  gap: 8px;\n  background-image: url(\"data:image/svg+xml,%3csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3e%3crect width='100%25' height='100%25' fill='none' rx='12' ry='12' stroke='%23A3AEBB' stroke-width='2' stroke-dasharray='6' stroke-dashoffset='15' stroke-linecap='square'/%3e%3c/svg%3e\");\n"]);return dm=function(){return e},e}function dx(){let e=(0,H._)(["\n  align-items: flex-start;\n  gap: 8px;\n  border: 1px solid ",";\n"]);return dx=function(){return e},e}function dg(){let e=(0,H._)(["\n  width: auto;\n  min-width: auto;\n  flex-grow: 1;\n  margin: 0;\n"]);return dg=function(){return e},e}let{Text:df,Title:dy,Paragraph:dv}=m.default,dj=U.ZP.div(dh()),db=(0,U.ZP)(dj)(dm()),dw=(0,U.ZP)(dj)(dx(),P.r.BORDER_GRAY),dS=(0,U.ZP)(tg.Z)(dg()),dk={color:P.r.TEXT_LIGHT},dT=e=>e?"Funds have been received!":"Waiting for transaction",dC=()=>{let{masterEoa:e}=(0,eb.Q)(),t=null==e?void 0:e.address,n=(0,p.useCallback)(()=>{t&&tN(t).then(()=>es.ZP.success("Address copied!"))},[t]);return(0,u.jsxs)(db,{className:"mt-16",children:[(0,u.jsxs)(x.Z,{justify:"space-between",children:[(0,u.jsx)(df,{className:"text-sm",type:"secondary",children:"Account creation address"}),(0,u.jsx)(x.Z,{gap:10,align:"center",children:(0,u.jsx)(tE.Z,{title:"Copy to clipboard",placement:"left",children:(0,u.jsx)(tZ.Z,{style:dk,onClick:n})})})]}),(0,u.jsx)("span",{className:"can-select-text break-word",children:"".concat(t||er.NA)})]})},dZ=e=>{let{onBridgeFunds:t}=e;return(0,u.jsxs)(th,{$padding:"0px 24px",vertical:!0,gap:16,children:[(0,u.jsx)(df,{className:"text-base",children:"Bridge from Ethereum directly to your agent. No further funds will be needed after bridging."}),(0,u.jsx)(f.ZP,{onClick:t,block:!0,type:"primary",size:"large",children:"Bridge funds"})]})},dE=e=>{let{onPayInFiat:t}=e;return(0,u.jsxs)(th,{$padding:"0px 24px",vertical:!0,gap:16,children:[(0,u.jsx)(df,{className:"text-base",children:"Pay in fiat by using your credit or debit card  funds convert and deposit to your agent automatically. No further funds will be needed after payment."}),(0,u.jsx)(f.ZP,{onClick:t,block:!0,type:"primary",size:"large",children:"Pay in fiat"}),(0,u.jsxs)(df,{className:"text-sm text-lighter text-center",children:["The service is provided by"," ",(0,u.jsx)("a",{href:"https://transak.com/",target:"_blank",rel:"noopener noreferrer",children:"Transak"}),"."]})]})},dN=e=>{let{chainName:t}=e;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(th,{children:(0,u.jsx)(ee,{fullWidth:!0,type:"warning",showIcon:!0,message:(0,u.jsxs)(x.Z,{vertical:!0,gap:5,children:[(0,u.jsxs)(df,{strong:!0,children:["Only send funds on ",t,"!"]}),(0,u.jsx)(df,{children:"You will lose any assets you send on other chains."})]})})}),(0,u.jsx)(dC,{})]})},dP=e=>{let{isFunded:t,minRequiredBalance:n,currency:r,chainName:a}=e;return(0,u.jsxs)(G,{noBorder:!0,children:[(0,u.jsx)(iW,{prev:sO.Q.AgentIntroduction}),(0,u.jsx)(dy,{level:3,children:"Deposit ".concat(n," ").concat(r," on ").concat(a)}),(0,u.jsx)(dv,{style:{marginBottom:0},children:"The app needs these funds to create your account on-chain."}),(0,u.jsx)(th,{$padding:"12px 24px",$borderTop:!0,className:"mt-12",children:(0,u.jsxs)(df,{className:t?"":"loading-ellipses",children:["Status: ",dT(t)]})}),!t&&(0,u.jsx)(dN,{chainName:a})]})},dI=e=>{let{isFunded:t,minRequiredBalance:n,currency:r,chainName:a,introText:s}=e;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(dv,{style:{marginBottom:12},children:s||(0,u.jsxs)(u.Fragment,{children:["Send funds on ",a," to create your account. Additional funds for staking and operating your agent will be requested separately."]})}),(0,u.jsx)(th,{children:(0,u.jsx)(ee,{fullWidth:!0,type:"warning",showIcon:!0,message:(0,u.jsxs)(x.Z,{vertical:!0,gap:5,children:[(0,u.jsxs)(df,{strong:!0,children:["Only send funds on ",a," chain!"]}),(0,u.jsx)(df,{children:"You will lose any assets you send on other chains."})]})})}),(0,u.jsxs)(dw,{className:"mt-16",children:[(0,u.jsxs)(x.Z,{gap:8,align:"center",children:[(0,u.jsx)(v(),{src:"/chains/".concat(N()(a),"-chain.png"),width:20,height:20,alt:"chain logo"}),(0,u.jsx)(df,{children:a})]}),(0,u.jsxs)(x.Z,{justify:"space-between",align:"center",gap:16,className:"w-full",children:[(0,u.jsxs)(df,{strong:!0,children:[n," ",r]}),(0,u.jsx)(dS,{}),(0,u.jsx)(df,{style:{display:"block",width:172},type:"secondary",className:t?"":"loading-ellipses",children:dT(t)})]})]}),(0,u.jsx)(dC,{})]})},dM=()=>{var e;let[t,n]=rs(["bridge-onboarding","on-ramp"]),{goto:r}=tn(),{selectedAgentConfig:a}=(0,k.S)(),{masterEoa:s}=(0,eb.Q)(),{masterWalletBalances:i}=(0,eo.PU)(),l=dp(),[o,d]=(0,p.useState)(a.evmHomeChainId),[c,h]=(0,p.useState)("transfer"),m=null==s?void 0:s.address,x=nc.NJ[o],g=(null==a?void 0:a.evmHomeChainId)===r4.C.Gnosis&&(null==a?void 0:null===(e=a.name)||void 0===e?void 0:e.toLowerCase().includes("supafund")),f=x.safeCreationThreshold,y=g?Math.max(3,f):f,v=null==i?void 0:i.find(e=>e.walletAddress===m&&e.evmChainId===o),j=(null==v?void 0:v.evmChainId)===o&&v.balance>=y,b=(0,p.useCallback)(async()=>{es.ZP.success("".concat(x.name," funds have been received!")),await (0,e5.a)(1);let e=a.requiresAgentSafesOn,t=e.indexOf(o);if(e.length>t+1){d(e[t+1]);return}r(sO.Q.SetupCreateSafe)},[o,r,x.name,a.requiresAgentSafesOn]);(0,p.useEffect)(()=>{x&&m&&j&&b()},[x,b,j,m]);let w=(0,p.useCallback)(async()=>{try{await l(),r(sO.Q.SetupBridgeOnboardingScreen)}catch(e){es.ZP.error("Failed to prepare for bridging funds. Please try again."),console.error(e)}},[r,l]),S=(0,p.useCallback)(async()=>{try{await l(),r(sO.Q.SetupOnRamp)}catch(e){es.ZP.error("Failed to prepare for fiat payment. Please try again."),console.error(e)}},[r,l]);return x?t?(0,u.jsxs)(G,{$noBorder:!0,children:[(0,u.jsx)(iW,{prev:sO.Q.AgentIntroduction}),(0,u.jsx)(dy,{level:3,className:"mb-8",children:"Fund your agent"}),(0,u.jsx)(df,{type:"secondary",children:"Choose how."}),(0,u.jsx)(th,{$padding:"20px 24px",$borderTop:!0,$borderBottom:!0,className:"mt-12 mb-12",children:(0,u.jsx)(rO.Z,{options:du()([{label:n?"Transfer":"Send on ".concat(x.name),value:"transfer"},t?{label:"Bridge",value:"bridge"}:null,n?{label:"Buy",value:"onRamp"}:null]),onChange:h,value:c,block:!0,className:"w-full"})}),"transfer"===c&&(0,u.jsx)(dI,{isFunded:j,minRequiredBalance:y,currency:x.nativeToken.symbol,chainName:x.name,introText:g?"Deposit ".concat(y," ").concat(x.nativeToken.symbol," to your EOA to cover Safe creation (1.5 ").concat(x.nativeToken.symbol,") and initial operating funds. Any excess will be forwarded to your agent automatically after the Safe is created."):void 0}),"bridge"===c&&(0,u.jsx)(dZ,{onBridgeFunds:w}),"onRamp"===c&&(0,u.jsx)(dE,{onPayInFiat:S})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(dP,{isFunded:j,minRequiredBalance:y,currency:x.nativeToken.symbol,chainName:x.name}),!1]}):null};var d_=n(92209);function dA(){let e=(0,H._)(["\n  line-height: normal;\n"]);return dA=function(){return e},e}let{Text:dL}=m.default,dF=U.ZP.div(dA()),dO=e=>{let{children:t}=e;return"string"==typeof t?(0,u.jsx)(dL,{className:"text-sm text-lighter",style:{lineHeight:"normal"},children:t}):(0,u.jsx)(u.Fragment,{children:t})},dR=e=>{let{href:t}=e;return(0,u.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"pl-4",children:(0,u.jsxs)(dL,{className:"text-sm text-primary",children:["Txn details ",er.$.EXTERNAL_LINK]})})},dD=e=>{let{steps:t}=e;return(0,u.jsx)(en.Z,{items:t.map(e=>{let{status:t,title:n,subSteps:r}=e;return{status:t,title:n,description:(r||[]).map((e,t)=>(0,u.jsxs)(dF,{style:{marginTop:0===t?4:6},children:[e.description&&(0,u.jsx)(dO,{children:e.description}),e.txnLink&&(0,u.jsx)(dR,{href:e.txnLink}),e.failed]},t)),icon:"process"===t?(0,u.jsx)(et.Z,{}):void 0}}),size:"small",direction:"vertical"})},{Text:dB}=m.default,dz=e=>{let{onClick:t}=e;return(0,u.jsxs)(dB,{className:"text-sm text-lighter",children:["By proceeding, you agree to the service's\xa0",(0,u.jsx)("a",{onClick:t,children:"Terms & Conditions"}),"."]})},dW=()=>{let{onRampWindow:e,termsAndConditionsWindow:t}=(0,ei.Z)(),{masterEoa:n}=(0,eb.Q)(),{isBuyCryptoBtnLoading:r,usdAmountToPay:a,updateIsBuyCryptoBtnLoading:s,isTransactionSuccessfulButFundsNotReceived:i,isOnRampingStepCompleted:l}=(0,d_.q)(),o=(0,p.useCallback)(async()=>{(null==e?void 0:e.show)&&a&&(e.show(a),await (0,e5.a)(1),s(!0))},[e,a,s]),d=!(null==n?void 0:n.address)||!a,c=(0,p.useCallback)(async()=>{var e;null==t||null===(e=t.show)||void 0===e||e.call(t,"transak")},[t]);return(0,p.useMemo)(()=>({status:l?"finish":i||r?"process":"wait",title:"Buy crypto on Transak",subSteps:l?[{description:"Funds received by the agent."}]:[{description:(0,u.jsx)(dz,{onClick:c})},{description:(0,u.jsx)(f.ZP,{loading:r||i,disabled:d,onClick:o,type:"primary",children:"Buy crypto"})}]}),[l,r,i,d,o,c])},dH=[{status:"wait",title:"Create Master Safe"},{status:"wait",title:"Transfer funds to the Master Safe"}],dq=(e,t)=>{let{isPending:n,isError:r,data:a,mutateAsync:s}=ts(t),i=null==a?void 0:a.isSafeCreated;(0,p.useEffect)(()=>{e&&!n&&!r&&(null!=a&&a.isSafeCreated||s())},[e,n,r,a,s]);let l=(0,p.useMemo)(()=>{let t=e?r?"error":n?"process":i?"finish":"wait":"wait";return{status:t,title:"Create Master Safe",subSteps:[{description:n?"Sending Transaction...":i?"Transaction complete.":null,txnLink:null==a?void 0:a.txnLink,failed:r?(0,u.jsx)(eM,{onRetry:s,onRetryProps:{isLoading:"process"===t}}):null}]}},[e,r,n,i,null==a?void 0:a.txnLink,s]),o=(0,p.useMemo)(()=>{let t=(()=>{if(!e)return"wait";if(n)return"process";let t=null==a?void 0:a.transfers.map(e=>{let{status:t}=e;return t});if(null==t?void 0:t.some(e=>"error"===e))return"error";let r=null==t?void 0:t.map(e=>"process"===e);return(null==r?void 0:r.some(e=>e))?"process":i?"finish":"wait"})();return{status:t,title:"Transfer funds to the Master Safe",subSteps:null==a?void 0:a.transfers.map(e=>{let{status:n,symbol:r,txnLink:a}=e;return{description:"finish"===n?"Transfer ".concat(r," complete."):"error"===n?"Transfer ".concat(r," failed."):"process"===n?"Sending transaction...":null,txnLink:a,failed:"error"===n?(0,u.jsx)(eM,{onRetry:s,onRetryProps:{isLoading:"process"===t}}):null}})}},[e,n,i,null==a?void 0:a.transfers,s]),d=(0,p.useMemo)(()=>{if(r||!i||0===t.length)return!1;let e=(null==a?void 0:a.transfers)||[];return t.length!==e.length?(window.console.warn("Expected ".concat(t.length," transfers, but got ").concat(e.length,".\n        This might indicate that not all tokens were transferred.")),!1):e.every(e=>"finish"===e.status)},[r,i,t.length,null==a?void 0:a.transfers]);return e?{isMasterSafeCreatedAndFundsTransferred:d,steps:[l,o]}:{isMasterSafeCreatedAndFundsTransferred:!1,steps:dH}},dU=e=>(0,ed.a)({queryKey:[ev.p.BRIDGE_REFILL_REQUIREMENTS_KEY_ON_DEMAND,e],queryFn:async t=>{let{signal:n}=t;return e?await e4.getBridgeRefillRequirements(e,n):(window.console.warn("No parameters provided for bridge refill requirements"),null)},enabled:!1,retry:!1,staleTime:0}),dY=e=>{let{selectedAgentConfig:t}=(0,k.S)(),n=(0,p.useCallback)(e=>{if(!e)return[];let n=(0,I.DH)(t.middlewareHomeChainId),r=tb.vP[n];return e.bridge_requests.map(e=>{let{token:t,amount:n}=e.to,a=t5(t,r);return{amount:(0,M.Bs)(n,null==a?void 0:a.decimals),symbol:null==a?void 0:a.symbol}})},[t.middlewareHomeChainId]),r=t.evmHomeChainId===e,a=(0,p.useCallback)(e=>{if(0===e.length)return[];let n=(0,I.KP)(t.middlewareHomeChainId).symbol;return r?e.filter(e=>e.symbol!==n).map(e=>e.symbol):e.map(e=>e.symbol)},[t.middlewareHomeChainId,r]),s=(0,p.useCallback)(e=>{if(!e)return null;let t=e.bridge_requests.filter(e=>e.to.token!==tw.d),n=r?t:e.bridge_requests;return{...e,bridge_requests:n}},[r]);return{canIgnoreNativeToken:r,getReceivingTokens:n,getTokensToBeBridged:a,getBridgeParamsExceptNativeToken:s}},{Text:dG}=m.default,dQ=e=>{let[t,n]=(0,p.useState)(null),{isOnRampingStepCompleted:r}=(0,d_.q)(),{isBalancesAndFundingRequirementsLoading:a}=(0,w.C)(),{getReceivingTokens:s,getTokensToBeBridged:i,getBridgeParamsExceptNativeToken:l}=dY(e),[o,d]=(0,p.useState)(!1),[c,u]=(0,p.useState)(!0),[h,m]=(0,p.useState)(!1),x=dn(e,tw.d,"to"),g=(0,p.useMemo)(()=>x?x(o):null,[o,x]),{isLoading:f,isError:y,refetch:v}=dU((0,p.useMemo)(()=>l(g),[l,g]));(0,p.useEffect)(()=>{c&&r&&v().then(e=>{let{data:t}=e;return n(null!=t?t:null)}).finally(()=>{u(!1)})},[c,r,v,u]);let j=a||f||c||h,b=(0,p.useMemo)(()=>!!t&&t.bridge_request_status.some(e=>{let{status:t}=e;return"QUOTE_FAILED"===t}),[t]),S=(0,p.useMemo)(()=>s(g),[s,g]),k=(0,p.useMemo)(()=>i(S),[i,S]);return{isLoading:j,hasError:y||b,bridgeFundingRequirements:t,receivingTokens:S,tokensToBeBridged:k,onRetry:(0,p.useCallback)(async()=>{d(!0),m(!0),await (0,e5.a)(1),v().then(e=>{let{data:t}=e;n(null!=t?t:null),d(!1)}).finally(()=>{m(!1)})},[v])}},d$="Swap funds",dK={tokensToBeTransferred:[],step:{status:"wait",title:d$,subSteps:[]}},dX={tokensToBeTransferred:[],step:{status:"process",title:d$,subSteps:[{description:"Sending transaction..."}]}},dV=e=>({tokensToBeTransferred:[],step:{status:"error",title:d$,subSteps:[{failed:(0,u.jsxs)(x.Z,{vertical:!0,gap:8,align:"flex-start",children:[(0,u.jsx)(dG,{className:"text-sm text-lighter",children:"Quote request failed"}),(0,u.jsx)(f.ZP,{onClick:e,icon:(0,u.jsx)(tx.Z,{}),size:"small",children:"Try again"})]})}]}}),dJ=e=>{let{isOnRampingStepCompleted:t,isSwappingFundsStepCompleted:n,updateIsSwappingStepCompleted:r}=(0,d_.q)(),{isLoading:a,hasError:s,bridgeFundingRequirements:i,receivingTokens:l,tokensToBeBridged:o,onRetry:d}=dQ(e),[c,h]=(0,p.useState)(),{isBridgingCompleted:m,isBridgingFailed:x,isBridging:g,bridgeStatus:f}=e7(o,(0,p.useMemo)(()=>{if(!a&&t&&i)return i.id},[a,t,i]));(0,p.useEffect)(()=>{!n&&(m&&r(!0),(null==f?void 0:f.length)&&h(f))},[m,n,f,r]);let y=(0,p.useMemo)(()=>n?"finish":t?x?"error":a||g?"process":m?"finish":"process":"wait",[n,t,a,g,x,m]),v=(0,p.useMemo)(()=>l?l.map(e=>{let{symbol:t}=e;return t}):[],[l]);if(!t)return dK;if(!n){if(a||g)return dX;if(s)return dV(d)}return{tokensToBeTransferred:v,step:{status:y,title:d$,subSteps:(c||[]).map(e=>{let{status:t,symbol:n,txnLink:r}=e;return{description:"finish"===t?"Swap ".concat(n||""," complete."):"error"===t?"Swap ".concat(n||""," failed."):"Sending transaction...",txnLink:r,failed:"error"===t&&(0,u.jsx)(eM,{onRetry:d,onRetryProps:{isLoading:"process"===y}})}})}}},d0=e=>{let{onRampChainId:t}=e,{goto:n}=(0,S.a)(),{isOnRampingStepCompleted:r,isSwappingFundsStepCompleted:a}=(0,d_.q)(),s=dW(),{tokensToBeTransferred:i,step:l}=dJ(t),{isMasterSafeCreatedAndFundsTransferred:o,steps:d}=dq(a,i);return(0,p.useEffect)(()=>{r&&a&&o&&(0,e5.a)(1).then(()=>n(b.i.Main))},[r,o,a,n]),(0,u.jsx)(dD,{steps:[s,l,...d]})};var d1=n(48282),d2=n(50361),d6=n.n(d2);let d4="".concat(ea.Kg,"price-quote/"),d5=async(e,t,n)=>{let r=new URLSearchParams({fiatCurrency:"USD",cryptoCurrency:"ETH",isBuyOrSell:"BUY",network:e,paymentMethod:"credit_debit_card",cryptoAmount:t.toString()}),a=await fetch("".concat(d4,"?").concat(r.toString()),{method:"GET",headers:{accept:"application/json"},signal:n});if(!a.ok)throw Error("Failed to fetch Transak quote: ".concat(a.status));return a.json()},d8=e=>{let{selectedAgentConfig:t}=(0,k.S)(),n=(0,I.fG)(t.evmHomeChainId),r=(0,I.fG)(rB.P2[n]);return(0,ed.a)({queryKey:ev.p.ON_RAMP_QUOTE_KEY(r,e),queryFn:async t=>{let{signal:n}=t;try{let{response:t}=await d5(r,e,n);return t}catch(e){throw console.error("Error fetching Transak quote",e),e}},select:e=>e.fiatAmount,enabled:!!r&&!!e})},d3=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2?arguments[2]:void 0,{isBalancesAndFundingRequirementsLoading:r}=(0,w.C)(),{getReceivingTokens:a,getTokensToBeBridged:s,getBridgeParamsExceptNativeToken:i}=dY(e),[l,o]=(0,p.useState)(!1),[d,c]=(0,p.useState)(!0),[u,h]=(0,p.useState)(t),[m,x]=(0,p.useState)(!1),g=dn(e,tw.d,"to"),f=(0,p.useMemo)(()=>g?g(l):null,[l,g]),{data:y,isLoading:v,isError:j,refetch:b}=tT(i(f),u&&!n,t);(0,p.useEffect)(()=>{d&&b().finally(()=>{c(!1)})},[d,b,c]);let S=r||v||d||m,k=(0,p.useMemo)(()=>!!y&&y.bridge_request_status.some(e=>{let{status:t}=e;return"QUOTE_FAILED"===t}),[y]),T=(0,p.useMemo)(()=>a(f),[a,f]),C=(0,p.useMemo)(()=>s(T),[s,T]);return{isLoading:S,hasError:j||k,bridgeParams:f,bridgeFundingRequirements:y,receivingTokens:T,tokensToBeBridged:C,onRetry:(0,p.useCallback)(async()=>{o(!0),x(!0),h(!1),await (0,e5.a)(1),b().then(()=>{o(!1),h(!0)}).finally(()=>{x(!1)})},[b])}},d9=e=>{let{updateEthAmountToPay:t,isOnRampingTransactionSuccessful:n}=(0,d_.q)(),{selectedAgentConfig:r}=(0,k.S)(),{masterEoa:a}=(0,eb.Q)(),{isLoading:s,hasError:i,bridgeParams:l,bridgeFundingRequirements:o,receivingTokens:d,onRetry:c}=d3(e,!n,n),u=(0,p.useMemo)(()=>{var e,t;if(!l||!o||!(null==a?void 0:a.address))return;let n=(0,I.fG)(r.evmHomeChainId),s=(0,I.fG)(rB.P2[n]),i=null===(e=l.bridge_requests.find(e=>e.to.token===tw.d))||void 0===e?void 0:e.to.amount,d=o.bridge_refill_requirements[s],c=null==d?void 0:null===(t=d[a.address])||void 0===t?void 0:t[tw.d];if(!c)return;let u=BigInt(c)+BigInt((n===s?i:0)||0);return u?(0,M.Bs)(u,18):0},[l,o,null==a?void 0:a.address,r.evmHomeChainId]);return(0,p.useEffect)(()=>{u&&(n||t(u))},[u,n,t]),{isLoading:s,hasError:i,totalNativeToken:u,receivingTokens:d,onRetry:c}},{Text:d7}=m.default,ce=(e,t)=>[{title:(0,u.jsxs)(x.Z,{justify:"space-between",align:"center",children:[(0,u.jsx)(d7,{children:"Paying"}),(0,u.jsx)(v(),{src:"/wallet.png",width:24,height:24,alt:"Paying"})]}),dataIndex:"paying",key:"paying",width:"50%",onCell:()=>({style:{verticalAlign:"top"}})},{title:(0,u.jsxs)(x.Z,{justify:"space-between",align:"center",children:[(0,u.jsx)(d7,{children:"Receiving"}),(0,u.jsx)(v(),{src:"/chains/".concat(e,"-chain.png"),width:24,height:24,alt:t})]}),dataIndex:"receiving",key:"receiving",width:"50%",onCell:()=>({style:{verticalAlign:"top"}})}],ct=()=>(0,u.jsx)(eH.Z.Input,{size:"small",active:!0,style:{width:"80px !important",minWidth:"80px !important"}}),cn=e=>{let{onRetry:t}=e;return(0,u.jsxs)(x.Z,{vertical:!0,gap:8,align:"flex-start",children:[(0,u.jsx)(tm.Z,{style:{color:P.r.RED}}),(0,u.jsx)(d7,{children:"Quote request failed"}),(0,u.jsx)(f.ZP,{onClick:t,icon:(0,u.jsx)(tx.Z,{}),size:"small",children:"Try again"})]})},cr=e=>{let{receivingTokens:t}=e;return(0,u.jsx)(x.Z,{vertical:!0,justify:"center",gap:6,children:0===t.length?(0,u.jsxs)(x.Z,{vertical:!0,gap:6,children:[(0,u.jsx)(ct,{}),(0,u.jsx)(ct,{})]}):t.map((e,t)=>(0,u.jsx)(d7,{children:"".concat(null==e?void 0:e.amount," ").concat(null==e?void 0:e.symbol)},t))})},ca=e=>{let{onRampChainId:t}=e,{selectedAgentConfig:n}=(0,k.S)(),{isOnRampingStepCompleted:r,isTransactionSuccessfulButFundsNotReceived:a,usdAmountToPay:s,ethAmountToPay:i,updateUsdAmountToPay:l}=(0,d_.q)(),{isLoading:o,hasError:d,totalNativeToken:c,receivingTokens:h,onRetry:m}=d9(t),{isLoading:g,data:f}=d8(d?void 0:c),[y,v]=(0,p.useState)();(0,p.useEffect)(()=>{h&&!a&&(r||v(d6()(h)))},[r,a,h]);let j=g||o,b=s?"~".concat(s," USD"):er.NA,w="for ".concat(i," ETH");(0,p.useEffect)(()=>{r||a||(j||d?l(null):f&&l(f))},[a,r,j,d,f,l]);let S=(0,p.useMemo)(()=>[{key:"paying-receiving",paying:(0,u.jsx)(u.Fragment,{children:d&&!o?(0,u.jsx)(cn,{onRetry:m}):(0,u.jsxs)(x.Z,{vertical:!0,justify:"center",gap:6,children:[(0,u.jsx)(d7,{children:j?(0,u.jsx)(ct,{}):b}),(0,u.jsx)(d7,{children:o?(0,u.jsx)(ct,{}):w})]})}),receiving:y?(0,u.jsx)(cr,{receivingTokens:y}):null}],[o,d,w,y,m,b,j]),T=(0,I.KP)(n.middlewareHomeChainId);return(0,u.jsx)(d1.Z,{columns:ce(T.name,T.displayName),dataSource:S,pagination:!1,bordered:!0,style:{width:"100%"}})},{Title:cs,Text:ci}=m.default,cl=()=>(0,u.jsx)(x.Z,{justify:"center",align:"center",style:{height:120},children:(0,u.jsx)(g.Z,{})}),co=()=>(0,u.jsxs)(x.Z,{vertical:!0,gap:8,children:[(0,u.jsx)(cs,{level:3,className:"m-0",children:"Pay in fiat"}),(0,u.jsx)(ci,{className:"text-base text-lighter",children:"The amount you pay in fiat covers all funds required to create an account and run your agent, including fees. No further funds will be needed."})]}),cd=()=>(0,u.jsx)(th,{children:(0,u.jsx)(ee,{fullWidth:!0,type:"warning",showIcon:!0,message:(0,u.jsx)(x.Z,{vertical:!0,gap:5,children:(0,u.jsx)(ci,{className:"text-sm",children:"Keep the app open until the process is complete."})})})}),cc=()=>{let{goto:e}=tn(),{networkId:t}=(0,d_.q)(),n=(0,p.useCallback)(()=>{e(sO.Q.SetupEoaFunding)},[e]);return(0,u.jsxs)(G,{$noBorder:!0,children:[(0,u.jsx)(e1,{onPrev:n}),(0,u.jsxs)(th,{vertical:!0,gap:24,className:"m-0 pt-24",children:[(0,u.jsx)(co,{}),(0,u.jsx)(cd,{}),t?(0,u.jsxs)(x.Z,{vertical:!0,gap:24,children:[(0,u.jsx)(ca,{onRampChainId:t}),(0,u.jsx)(d0,{onRampChainId:t})]}):(0,u.jsx)(cl,{})]})]})};var cu=n(21720),cp=n(21322),ch=n.n(cp),cm=n(8797);let cx=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Something went wrong",n=null;try{n=await e.json()}catch(e){}throw Error((null==n?void 0:n.error)||(null==n?void 0:n.message)||t)},cg=e=>{let t=e instanceof Error?e.message:"Something went wrong";return console.error(e),t},cf={getAccount:()=>fetch("".concat(ea.z0,"/account"),{headers:{...e6.z}}).then(e=>{if(e.ok)return e.json();throw Error("Failed to get account")}),createAccount:e=>fetch("".concat(ea.z0,"/account"),{method:"POST",headers:{...e6.z},body:JSON.stringify({password:e})}).then(e=>e.ok?e.json():cx(e,"Failed to create account")),loginAccount:e=>fetch("".concat(ea.z0,"/account/login"),{method:"POST",headers:{...e6.z},body:JSON.stringify({password:e})}).then(e=>e.ok?e.json():cx(e,"Failed to login"))},{Title:cy,Text:cv}=m.default,cj=["Too weak","Weak","Moderate","Strong","Very strong! Nice job!"],cb=[P.r.RED,P.r.WARNING,P.r.SUCCESS,P.r.SUCCESS,P.r.PURPLE],cw=e=>{let{score:t}=e;return(0,u.jsxs)(cv,{style:{color:P.r.GRAY_2},children:["Password strength:"," ",(0,u.jsx)("span",{style:{color:cb[t]},children:cj[t]})]})},cS=()=>{let{goto:e,setMnemonic:t}=tn(),{setUserLoggedIn:n}=(0,S.a)(),[r]=iU.Z.useForm(),a=(0,cm.h)(),[s,i]=(0,p.useState)(!1),l=iU.Z.useWatch("terms",r),o=iU.Z.useWatch("password",r),[d,c]=(0,p.useState)(!0);(0,p.useEffect)(()=>{void 0!==o?r.validateFields(["password"]).then(()=>c(!0)).catch(()=>c(!1)):c(!1)},[o,r]);let h=async r=>{let{password:s}=r;l&&d&&!(s.length<8)&&(i(!0),cf.createAccount(s).then(()=>cf.loginAccount(s)).then(()=>ta.X.createEoa()).then(r=>{let{mnemonic:a}=r;t(a),e(sO.Q.SetupSeedPhrase),n()}).catch(e=>{a.error(cg(e))}).finally(()=>i(!1)))};return(0,u.jsxs)(G,{$gap:10,styles:{body:{padding:"12px 24px"}},$noBorder:!0,children:[(0,u.jsx)(iW,{prev:sO.Q.Welcome}),(0,u.jsxs)("div",{children:[(0,u.jsx)(cy,{level:3,children:"Create account"}),(0,u.jsx)(cv,{style:{color:P.r.GRAY_2},children:"Your password must be at least 8 characters long. For a strong password, use a mix of letters, numbers, and symbols."})]}),(0,u.jsxs)(iU.Z,{name:"createEoa",form:r,layout:"horizontal",onFinish:h,requiredMark:!1,children:[(0,u.jsx)(iU.Z.Item,{name:"password",label:"Password",help:o&&o.length>0&&d?(0,u.jsx)(cw,{score:ch()(o).score}):null,rules:[{required:!0,message:"Please input a Password!"},{validator:(e,t)=>t?/^[\x20-\x7E]*$/.test(t)?Promise.resolve():Promise.reject(Error("Password must only contain ASCII characters.")):Promise.resolve()}],children:(0,u.jsx)(iQ.Z.Password,{size:"large",placeholder:"Password",maxLength:64})}),(0,u.jsx)(iU.Z.Item,{name:"terms",valuePropName:"checked",children:(0,u.jsxs)(cu.Z,{children:["I agree to the Pearls"," ",(0,u.jsx)("a",{href:ea.Vf,target:"_blank",rel:"noreferrer",children:"Terms & Conditions"})]})}),(0,u.jsx)(iU.Z.Item,{style:{marginBottom:0},children:(0,u.jsx)(f.ZP,{size:"large",type:"primary",htmlType:"submit",disabled:!l||!d||o.length<8,loading:s,style:{width:"100%"},children:"Continue"})})]})]})},{Text:ck,Title:cT}=m.default,cC=()=>(0,u.jsx)(ee,{type:"warning",showIcon:!0,message:(0,u.jsx)(ck,{children:"Without seed phrase, access to your Pearl account will be lost forever, so keep it safe."})}),cZ=()=>{let{mnemonic:e,goto:t}=tn(),[n,r]=(0,p.useState)(!1),[a,s]=nZ.Z.useModal(),i=(0,p.useCallback)(()=>{tN(e.join(" ")).then(()=>{es.ZP.success("Seed phrase is copied!"),r(!0)})},[e]),l=(0,p.useCallback)(()=>{a.confirm({title:"Did you back up your seed phrase securely?",content:(0,u.jsxs)(x.Z,{vertical:!0,gap:8,className:"mb-16",children:[(0,u.jsx)(ck,{children:"This is the only way to recover your account and restore your funds if access is lost."}),(0,u.jsx)(ck,{children:"Ensure you have securely saved the seed phrase in a safe location before proceeding."})]}),okText:"Confirm & continue",cancelText:"Cancel",onOk:()=>t(sO.Q.SetupBackupSigner),icon:null})},[t,a]);return(0,u.jsxs)(q.Z,{style:{border:"none"},children:[(0,u.jsx)(iW,{}),(0,u.jsx)(cT,{level:3,children:"Back up seed phrase"}),(0,u.jsxs)(x.Z,{gap:16,vertical:!0,children:[(0,u.jsx)(ck,{children:"Seed phrase is required to regain access to your account if you forget your password."}),(0,u.jsx)(cC,{}),(0,u.jsx)(x.Z,{gap:8,wrap:"wrap",style:{marginBottom:8},children:e.map(e=>(0,u.jsx)(a0.Z,{style:{width:80,textAlign:"center",fontSize:14},children:e},e))}),(0,u.jsxs)(x.Z,{gap:16,vertical:!0,children:[(0,u.jsxs)(f.ZP,{size:"large",onClick:i,block:!0,children:[(0,u.jsx)(tZ.Z,{})," Copy to clipboard"]}),(0,u.jsx)(f.ZP,{disabled:!n,onClick:l,block:!0,type:"primary",size:"large",children:"Continue"})]})]}),s]})};var cE=n(69468);let{Title:cN,Paragraph:cP}=m.default,cI=()=>{let{goto:e}=tn(),t=(0,p.useCallback)(()=>{e(sO.Q.AgentIntroduction)},[e]);return(0,u.jsxs)(G,{gap:20,noBorder:!0,styles:{body:{padding:"24px 48px",alignItems:"center"}},children:[(0,u.jsx)(cE.Z,{style:{fontSize:"48px",color:P.r.TEXT_LIGHT}}),(0,u.jsx)(cN,{level:3,className:"m-0",children:"Early access only"}),(0,u.jsx)(cP,{className:"text-center text-light m-0",children:"This agent is available only to early adopters. Fill out the form to request access."}),(0,u.jsxs)(f.ZP,{type:"link",href:"https://mailchi.mp/a95a68faaac8/olas-mailing-list",target:"_blank",rel:"noopener noreferrer",children:["Request access\xa0",er.$.EXTERNAL_LINK]}),(0,u.jsx)(f.ZP,{type:"default",onClick:t,children:"Go back"})]})},cM=(0,p.memo)(function(){let{goto:e}=tn();return(0,u.jsx)(f.ZP,{size:"large",onClick:()=>e(sO.Q.Welcome),children:(0,u.jsx)(z.Z,{})})}),c_=()=>{let{goto:e}=tn();return(0,u.jsxs)(G,{noBorder:!0,title:(0,u.jsxs)(x.Z,{justify:"space-between",align:"center",children:[(0,u.jsx)(m.default.Title,{className:"m-0",level:4,children:"Restore access"}),(0,u.jsx)(cM,{})]}),children:[(0,u.jsxs)(th,{gap:8,vertical:!0,padding:"0px 24px 24px 24px",align:"center",children:[(0,u.jsx)(m.default.Text,{children:"You can recover the Pearl account access by providing the seed phrase you received when setting up your account."}),(0,u.jsx)(tE.Z,{title:"Seed phrase account recovery coming soon.",children:(0,u.jsx)(f.ZP,{disabled:!0,size:"large",type:"primary",className:"w-3/4",onClick:()=>e(sO.Q.RestoreViaSeed),children:"Restore account via seed phrase"})})]}),(0,u.jsxs)(th,{gap:8,vertical:!0,$borderTop:!0,padding:"16px 24px 8px 24px",align:"center",children:[(0,u.jsx)(m.default.Text,{children:"If you dont have the seed phrase but added a backup wallet to your account, you may still restore your funds, but you wont be able to recover access to your Pearl account."}),(0,u.jsx)(f.ZP,{size:"large",className:"w-3/4",onClick:()=>e(sO.Q.RestoreViaBackup),children:"Restore funds via backup wallet"})]})]})},cA=()=>{let{goto:e}=tn(),[t]=iU.Z.useForm(),[n,r]=(0,p.useState)({}),a=(0,p.useMemo)(()=>!eh()(n)&&Object.values(n).every(e=>e&&e.trim()),[n]);return(0,u.jsx)(G,{title:(0,u.jsxs)(x.Z,{justify:"space-between",align:"center",children:[(0,u.jsx)(m.default.Title,{className:"m-0",level:4,children:"Restore via seed phrase"}),(0,u.jsx)(cM,{})]}),children:(0,u.jsxs)(x.Z,{gap:24,vertical:!0,children:[(0,u.jsx)(m.default.Text,{children:"To restore access to your Pearl account, enter the seed phrase you received when setting up your account."}),(0,u.jsx)(iU.Z,{form:t,onValuesChange:(e,t)=>r(t),children:(0,u.jsxs)(x.Z,{vertical:!0,gap:24,children:[(0,u.jsx)(eJ.Z,{gutter:10,children:[...Array(12)].map((e,t)=>(0,u.jsx)(e0.Z,{span:12,children:(0,u.jsx)(iU.Z.Item,{name:"".concat(t+1),children:(0,u.jsx)(iQ.Z,{prefix:"".concat(t+1,". "),size:"large",className:"w-full text-base"})})},t))}),(0,u.jsx)(f.ZP,{disabled:!a,htmlType:"submit",onClick:()=>e(sO.Q.RestoreSetPassword),size:"large",type:"primary",children:"Continue"})]})})]})})},cL=()=>{let{goto:e}=tn(),[t,n]=(0,p.useState)("");return(0,u.jsx)(G,{title:(0,u.jsxs)(x.Z,{justify:"space-between",align:"center",children:[(0,u.jsx)(m.default.Title,{className:"m-0",level:4,children:"Set password"}),(0,u.jsx)(cM,{})]}),children:(0,u.jsxs)(x.Z,{gap:24,vertical:!0,children:[(0,u.jsx)(m.default.Text,{children:"Come up with a strong password to get access to the Pearl account in the future."}),(0,u.jsxs)(x.Z,{vertical:!0,gap:16,children:[(0,u.jsx)(iQ.Z.Password,{onChange:e=>n(e.target.value),placeholder:"Password",size:"large",value:t}),(0,u.jsx)(f.ZP,{size:"large",type:"primary",onClick:()=>e(sO.Q.Welcome),children:"Set password"})]})]})})},cF=()=>(0,u.jsx)(G,{title:(0,u.jsxs)(x.Z,{justify:"space-between",align:"center",children:[(0,u.jsx)(m.default.Title,{className:"m-0",level:4,children:"Restore funds with backup wallet"}),(0,u.jsx)(cM,{})]}),$noBorder:!0,children:(0,u.jsxs)(x.Z,{vertical:!0,gap:10,children:[(0,u.jsx)(m.default.Text,{children:"To restore access to the fund in your Pearl account, use your seed phrase to connect with your Safe account and restore your funds."}),(0,u.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:"https://app.safe.global/welcome/accounts",children:"Open Safe interface "}),(0,u.jsx)(m.default.Text,{children:"Not sure how?"}),(0,u.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:ea.ar,children:"Get community assistance via a Discord ticket "})]})}),{Title:cO}=m.default,cR=e=>{var t;let{canNavigate:n,setIsLoggingIn:r}=e,{goto:a}=tn(),{goto:s}=(0,S.a)(),{isOnline:i}=(0,e2.y)(),{selectedService:l,selectedAgentConfig:o,services:d,isFetched:c}=(0,k.S)(),{masterSafes:u,masterEoa:h,isFetched:m}=(0,eb.Q)(),{isLoaded:x}=(0,eo.AE)(),{masterWalletBalances:g}=(0,eo.PU)(),f=tr(),y=(null==l?void 0:l.home_chain)?(0,I.DH)(null==l?void 0:l.home_chain):o.evmHomeChainId,v=null==u?void 0:u.find(e=>y&&e.evmChainId===y),j=null==g?void 0:null===(t=g.find(e=>e.walletAddress===(null==h?void 0:h.address)&&e.evmChainId===y))||void 0===t?void 0:t.balance,w=(0,p.useMemo)(()=>!!c&&!!d&&!!l&&!!o&&d.some(e=>{let{home_chain:t}=e;return t===(0,I.fG)(o.evmHomeChainId)}),[c,d,l,o]),T=(0,p.useMemo)(()=>!!i&&!!n&&!!c&&!!m&&!!x,[n,x,i,c,m]),C=(0,p.useMemo)(()=>!(null==d?void 0:d.length)&&!f,[null==d?void 0:d.length,f]);(0,p.useEffect)(()=>{if(T&&(r(!1),o)){if(C){a(sO.Q.SetupBackupSigner);return}if(!o.isAgentEnabled){a(sO.Q.AgentIntroduction);return}if(!w){window.console.log("No service created for chain ".concat(y)),a(sO.Q.AgentIntroduction);return}if(!j){a(sO.Q.SetupEoaFundingIncomplete);return}if(!(null==v?void 0:v.address)){a(sO.Q.SetupCreateSafe);return}s(b.i.Main)}},[w,j,null==v?void 0:v.address,y,a,s,o,r,T,C])};(i=c||(c={}))[i.True=0]="True",i[i.False=1]="False",i[i.Loading=2]="Loading",i[i.Error=3]="Error";let cD=()=>(0,u.jsx)(x.Z,{justify:"center",align:"center",style:{height:140,marginBottom:32},children:(0,u.jsx)(g.Z,{})}),cB=()=>(0,u.jsx)(x.Z,{justify:"center",style:{margin:"32px 0",textAlign:"center"},children:(0,u.jsx)(m.default.Text,{children:"Unable to determine the account setup status, please try again."})}),cz=()=>{let{goto:e}=tn();return(0,u.jsxs)(x.Z,{vertical:!0,gap:10,children:[(0,u.jsx)(f.ZP,{color:"primary",type:"primary",size:"large",onClick:()=>e(sO.Q.SetupPassword),children:"Create account"}),(0,u.jsx)(f.ZP,{size:"large",disabled:!0,children:"Restore access"})]})},cW=()=>{let[e]=iU.Z.useForm(),t=(0,cm.h)(),{goto:n}=tn(),{setUserLoggedIn:r}=(0,S.a)(),{updateBalances:a}=(0,eo.AE)(),[s,i]=(0,p.useState)(!1),[l,o]=(0,p.useState)(!1);cR({canNavigate:l,setIsLoggingIn:i});let d=(0,p.useCallback)(async e=>{let{password:n}=e;i(!0);try{await cf.loginAccount(n),await a(),o(!0),r()}catch(e){t.error(cg(e))}finally{i(!1)}},[a,r,t]);return(0,u.jsxs)(iX,{form:e,onFinish:d,children:[(0,u.jsx)(iU.Z.Item,{name:"password",rules:[{required:!0,message:"Please input your Password!"}],children:(0,u.jsx)(iQ.Z.Password,{size:"large",placeholder:"Password"})}),(0,u.jsxs)(x.Z,{vertical:!0,gap:10,children:[(0,u.jsx)(f.ZP,{htmlType:"submit",type:"primary",size:"large",loading:s,children:"Login"}),(0,u.jsx)(f.ZP,{type:"link",target:"_blank",size:"small",onClick:()=>n(sO.Q.Restore),children:"Forgot password? Restore access"})]})]})},cH=()=>{let e=(0,ei.Z)(),[t,n]=(0,p.useState)(null);(0,p.useEffect)(()=>{null===t&&(n(2),cf.getAccount().then(t=>{switch(t.is_setup){case!0:n(0);break;case!1:var r,a;null===(a=e.store)||void 0===a||null===(r=a.clear)||void 0===r||r.call(a),n(1);break;default:n(3)}}).catch(e=>{console.error(e),n(3)}))},[e.store,t]);let r=(0,p.useMemo)(()=>{switch(t){case 0:return(0,u.jsx)(cW,{});case 1:return(0,u.jsx)(cz,{});case 2:return(0,u.jsx)(cD,{});case 3:return(0,u.jsx)(cB,{});default:return null}},[t]);return(0,u.jsxs)(q.Z,{bordered:!1,children:[(0,u.jsxs)(x.Z,{vertical:!0,align:"center",children:[(0,u.jsx)(v(),{src:"/onboarding-robot.svg",alt:"Onboarding Robot",width:80,height:80}),(0,u.jsx)(cO,{children:"Pearl"})]}),r]})},{Title:cq,Text:cU}=m.default,cY=()=>{let{selectedAgentType:e}=(0,k.S)(),t=n1.J9.find(t=>t.agentType===e);return t?(0,u.jsx)(or.ZP,{theme:iH.l,children:(0,u.jsxs)(G,{gap:10,styles:{body:{padding:"12px 24px"}},noBorder:!0,children:[(0,u.jsx)(iW,{prev:sO.Q.AgentIntroduction}),(0,u.jsx)(cq,{level:3,className:"mb-0",children:"Set up your agent"}),e===rn.b.Supafund&&(0,u.jsx)(i6,{serviceTemplate:t})]})}):(0,u.jsx)(ee,{type:"error",showIcon:!0,message:(0,u.jsx)(cU,{children:"Please select an agent type first!"}),className:"mb-8"})},{Title:cG}=m.default,cQ=()=>(0,u.jsx)(G,{style:{height:400,textAlign:"center"},$noBorder:!0,children:(0,u.jsx)(cG,{level:4,className:"m-0",children:"Something went wrong!"})}),c$=()=>{let{setupObject:e}=(0,p.useContext)(tt.U);return(0,p.useMemo)(()=>{switch(e.state){case sO.Q.Welcome:return(0,u.jsx)(cH,{});case sO.Q.SetupPassword:return(0,u.jsx)(cS,{});case sO.Q.SetupSeedPhrase:return(0,u.jsx)(cZ,{});case sO.Q.SetupBackupSigner:return(0,u.jsx)(de,{});case sO.Q.SetupEoaFunding:case sO.Q.SetupEoaFundingIncomplete:return(0,u.jsx)(dM,{});case sO.Q.SetupCreateSafe:return(0,u.jsx)(dd,{});case sO.Q.AgentIntroduction:return(0,u.jsx)(oX,{});case sO.Q.EarlyAccessOnly:return(0,u.jsx)(cI,{});case sO.Q.SetupYourAgent:return(0,u.jsx)(cY,{});case sO.Q.SetupBridgeOnboardingScreen:return(0,u.jsx)(dr,{});case sO.Q.SetupOnRamp:return(0,u.jsx)(cc,{});case sO.Q.Restore:return(0,u.jsx)(c_,{});case sO.Q.RestoreViaSeed:return(0,u.jsx)(cA,{});case sO.Q.RestoreSetPassword:return(0,u.jsx)(cL,{});case sO.Q.RestoreViaBackup:return(0,u.jsx)(cF,{});default:return(0,u.jsx)(cQ,{})}},[e.state])},cK=()=>(0,u.jsx)(lc,{children:(0,u.jsx)(or.ZP,{theme:iH.l,children:(0,u.jsx)(lx,{})})}),cX=()=>(0,u.jsx)(V.Z,{message:"Oops!",description:"This feature is not enabled for your current agent type.",type:"error",showIcon:!0,style:{border:"none"}});function cV(){let e=(0,H._)(["\n  > div:not(:last-child) {\n    margin-bottom: 16px;\n  }\n  .ant-card-body {\n    padding: 16px;\n  }\n"]);return cV=function(){return e},e}let cJ=U.ZP.div(cV()),c0={gap:8},{Paragraph:c1,Text:c2,Title:c6}=m.default,c4=e=>{let{signerAddress:t,middlewareChain:n}=e;return(0,u.jsxs)(u.Fragment,{children:["Signer\xa0",(0,u.jsxs)(tA,{children:[(0,u.jsx)(c1,{className:"text-sm",children:"Your wallet and agent's wallet use Safe, a multi-signature wallet. The app is designed to trigger transactions on these Safe wallets via Signers."}),(0,u.jsx)(c1,{className:"text-sm",children:"This setup enables features like the backup wallet."}),(0,u.jsx)(c1,{className:"text-sm m-0",children:(0,u.jsxs)(x.Z,{gap:4,vertical:!0,children:[(0,u.jsx)(c2,{className:"text-sm",children:"Your wallet signer address:"}),(0,u.jsx)(lZ.N,{address:t,middlewareChain:n})]})})]})]})},c5=()=>(0,u.jsxs)(x.Z,{align:"center",children:[(0,u.jsx)(c6,{level:5,className:"m-0 text-sm",children:"OLAS"}),"\xa0",(0,u.jsx)(tA,{children:(0,u.jsx)(c1,{className:"text-sm m-0",children:"Agent rewards accumulate in the staking contract. The agent is designed to claim rewards periodically. Withdrawal of claimed rewards isn't available yet."})})]}),c8=()=>(0,u.jsxs)(c2,{className:"text-sm text-light",children:["Ownership NFT\xa0",(0,u.jsx)(tA,{children:(0,u.jsxs)(x.Z,{gap:4,vertical:!0,children:[(0,u.jsx)(c2,{strong:!0,className:"text-sm",children:"You own your agent"}),(0,u.jsx)(c1,{className:"text-sm m-0",children:"Agents are minted through the Olas Registry. Each agent has an NFT that gives its owner control over the agent's settings."})]})})]}),c3=()=>(0,u.jsxs)(c2,{className:"text-sm text-light",children:["ID\xa0",(0,u.jsx)(tA,{placement:"topRight",children:(0,u.jsx)(c1,{className:"text-sm m-0",children:"Each minted agent gets a unique ID. Technically, agents are referred to as 'services'."})})]}),c9=()=>{let{selectedAgentConfig:e,selectedService:t}=(0,k.S)(),{serviceSafes:n}=(0,ny.G)(null==t?void 0:t.service_config_id),{isLoading:r,masterSafes:a}=(0,eb.Q)(),s=null==e?void 0:e.evmHomeChainId,i=(0,p.useMemo)(()=>null==a?void 0:a.find(e=>{let{evmChainId:t}=e;return t===s}),[a,s]),l=(0,p.useMemo)(()=>null==n?void 0:n.find(e=>{let{evmChainId:t}=e;return t===s}),[n,s]);return{middlewareChain:null==e?void 0:e.middlewareHomeChainId,evmHomeChainId:s,isMasterSafeLoading:r,masterSafeAddress:null==i?void 0:i.address,serviceSafe:l}};var c7=n(1469),ue=n.n(c7),ut=n(11162),un=n(8695);let ur=["ba","bi","bu","ka","ke","ki","ko","ku","da","de","di","do","du","fa","fe","fi","fo","fu","ga","ge","gi","go","gu","ha","he","hi","ho","hu","ja","je","ji","jo","ju","ka","ke","ki","ko","ku","la","le","li","lo","lu","ma","me","mi","mo","mu","na","ne","ni","no","nu","pa","pe","pi","po","pu","ra","re","ri","ro","ru","sa","se","si","so","su","ta","te","ti","to","tu","va","ve","vi","vo","vu","wa","we","wi","wo","wu","ya","ye","yi","yo","yu","za","ze","zi","zo","zu","bal","ben","bir","bom","bun","cam","cen","cil","cor","cus","dan","del","dim","dor","dun","fam","fen","fil","fon","fur","gar","gen","gil","gon","gus","han","hel","him","hon","hus","jan","jel","jim","jon","jus","kan","kel","kim","kon","kus","lan","lel","lim","lon","lus","mar","mel","min","mon","mus","nar","nel","nim","nor","nus","par","pel","pim","pon","pus","rar","rel","rim","ron","rus","sar","sel","sim","son","sus","tar","tel","tim","ton","tus","var","vel","vim","von","vus","war","wel","wim","won","wus","yar","yel","yim","yon","yus","zar","zel","zim","zon","zus","zez","zzt","bzt","vzt","kzt","mek","tek","nek","lek","tron","dron","kron","pron","bot","rot","not","lot","zap","blip","bleep","beep","wire","byte","bit","chip"],ua=e=>ur[e%ur.length],us=(e,t,n)=>Array.from({length:n},(n,r)=>{let a=parseInt(e.slice(t+8*r,t+(r+1)*8),16);return isNaN(a)?ur[0]:ua(a)}).join("").toLowerCase(),ui=e=>{let t=us(e,2,2),n=us(e,18,2),r=parseInt(e.slice(-4),16)%100;return"".concat(t,"-").concat(n).concat(r.toString().padStart(2,"0"))},{Text:ul,Paragraph:uo}=m.default,ud=e=>{let{address:t}=e;return(0,u.jsx)(x.Z,{vertical:!0,gap:12,children:(0,u.jsxs)(x.Z,{gap:12,children:[(0,u.jsx)(v(),{width:36,height:36,alt:"Agent wallet",src:"/agent-wallet.png"}),(0,u.jsxs)(x.Z,{vertical:!0,className:"w-full",children:[(0,u.jsx)(ul,{className:"m-0 text-sm",type:"secondary",children:"Your agent"}),(0,u.jsx)(x.Z,{justify:"space-between",children:(0,u.jsx)(tE.Z,{arrow:!1,title:(0,u.jsx)(uo,{className:"text-sm m-0",children:"This is your agent's unique name"}),placement:"top",children:(0,u.jsx)(ul,{strong:!0,children:t?ui(t):er.NA})})})]})]})})},uc=e=>{let{currentStakingContractInfo:t}=e,[n,r]=(0,p.useState)();return(0,rl.Yz)(()=>{if(!t||!("serviceStakingStartTime"in t)||!("minimumStakingDuration"in t))return;let{serviceStakingStartTime:e,minimumStakingDuration:n}=t;if(ex()(n)||ex()(e))return;let a=n-(Math.round(Date.now()/1e3)-e);if(a<0){r(0);return}r(a)},1e3),ex()(n)?"Loading...":nH(n)},uu=()=>(0,u.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,u.jsx)("path",{d:"M10 6.31965V2.63965H6.32005M0.800049 11.8396H2.64005M17.36 11.8396H19.2M12.76 10.9196V12.7596M7.24005 10.9196V12.7596M4.48005 6.31965H15.52C16.5363 6.31965 17.36 7.14344 17.36 8.15965V15.5196C17.36 16.5359 16.5363 17.3596 15.52 17.3596H4.48005C3.46384 17.3596 2.64005 16.5359 2.64005 15.5196V8.15965C2.64005 7.14344 3.46384 6.31965 4.48005 6.31965Z",stroke:"currentColor","stroke-width":"1.4","stroke-linecap":"round","stroke-linejoin":"round"})});var up=n(9379);let uh=e=>{let{renderContainer:t}=e,{serviceSafe:n}=c9(),{selectedService:r}=(0,k.S)(),{goto:a,show:s}=(0,up.r)(),{deploymentStatus:i}=(0,ny.G)(null==r?void 0:r.service_config_id),l=(0,p.useCallback)(async()=>{if(!a||!s){es.ZP.error("Agent UI browser IPC methods are not available");return}if(i!==tv.E.DEPLOYED){es.ZP.open({type:"error",content:" Supafund ",style:{maxWidth:nN.ur,margin:"0 auto"}});return}try{await a("http://127.0.0.1:8716"),s()}catch(e){es.ZP.error(""),console.error(e)}},[i,a,s]);if(!(null==n?void 0:n.address))return null;let o=(0,u.jsx)(f.ZP,{type:"default",size:"large",icon:(0,u.jsx)(uu,{}),onClick:l,style:{height:"28px",display:"flex",alignItems:"center"}});return t?t({onClick:l}):(0,u.jsx)("a",{onClick:l,className:"text-sm",href:"#",children:o})},{Text:um}=m.default,ux=()=>(0,u.jsx)(x.Z,{align:"center",justify:"center",style:{height:100},children:(0,u.jsx)(g.Z,{})}),ug=e=>{let{chainName:t}=e;return(0,u.jsxs)(x.Z,{gap:8,align:"center",children:[(0,u.jsx)(v(),{src:"/chains/".concat(N()((0,I.KP)(t).name),"-chain.png"),width:20,height:20,alt:"chain logo"}),(0,u.jsx)(um,{children:(0,I.KP)(t).displayName})]})},uf=e=>e===j.x.ETH?"/chains/ethereum-chain.png":"/tokens/".concat(N()(e),"-icon.png"),uy=()=>{let{accruedServiceStakingRewards:e}=(0,ri.D)(),{isLoading:t,totalStakedOlasBalance:n}=(0,eo.AE)(),{masterEoaBalance:r,masterSafeNativeBalance:a,masterSafeOlasBalance:s,masterSafeErc20Balances:i}=(0,eo.PU)(),{isLoading:l,selectedAgentConfig:o,selectedService:d}=(0,k.S)(),{serviceSafeOlas:c,serviceSafeNativeBalances:u,serviceEoaNativeBalance:p,serviceSafeErc20Balances:h}=(0,eo.Lz)(null==d?void 0:d.service_config_id),m=o.middlewareHomeChainId,x=Object.entries(tb.vP[o.evmHomeChainId]).map(t=>{let[l]=t,o=(()=>{var t;if(l===j.x.OLAS){let t=lN()([n,s,null==c?void 0:c.balance,e]);return"".concat((0,M.mT)(t,4))}let o=null==u?void 0:u.find(e=>e.symbol===l);if(l===(0,I.KP)(m).symbol){let e=lN()([a,r,null==o?void 0:o.balance,null==p?void 0:p.balance]);return(0,M.mT)(e,4)}let d=null==h?void 0:h.find(e=>e.symbol===l),x=null!==(t=null==i?void 0:i[l])&&void 0!==t?t:0,g=lN()([x,null==d?void 0:d.balance]);return(0,M.mT)(g,4)})();return{symbol:l,imageSrc:uf(l),value:o}});return{isLoading:l||t,middlewareChain:m,balances:x}},uv=e=>{let{onNext:t,onCancel:n}=e,{isLoading:r,middlewareChain:a,balances:s}=uy();return(0,u.jsxs)(x.Z,{vertical:!0,gap:16,children:[(0,u.jsx)(um,{className:"text-sm text-light",children:"Available funds to withdraw"}),(0,u.jsx)(q.Z,{size:"small",title:(0,u.jsx)(ug,{chainName:a}),children:r?(0,u.jsx)(ux,{}):(0,u.jsx)(lY,{list:s.map(e=>({left:(0,u.jsxs)(x.Z,{gap:8,align:"center",children:[(0,u.jsx)(v(),{src:e.imageSrc,width:20,height:20,alt:"".concat(e.symbol," logo")}),(0,u.jsx)(um,{children:e.symbol})]}),leftClassName:"text-light text-sm",right:e.value})),parentStyle:{gap:12}})}),(0,u.jsx)(um,{className:"text-sm text-light",children:'By clicking "Withdraw", you\'ll only receive the above amount.'}),(0,u.jsxs)(x.Z,{gap:8,children:[(0,u.jsx)(f.ZP,{onClick:n,block:!0,className:"w-1/4",children:"Cancel"}),(0,u.jsx)(f.ZP,{type:"primary",onClick:t,block:!0,children:"Proceed"})]})]})},{Text:uj}=m.default,ub="Your agent will not be able to run again until it is refunded.",uw={FUNDS_MAY_BE_LOCKED:"FUNDS_MAY_BE_LOCKED",SHOW_BALANCES:"SHOW_BALANCES",WITHDRAW_FUNDS:"WITHDRAW_FUNDS"},uS=()=>{let{selectedAgentConfig:e}=(0,k.S)(),t=tb.vP[e.evmHomeChainId],n=(0,p.useMemo)(()=>{let e=t4(t);if(!e)return"This will withdraw all funds from your account. ".concat(ub);let n=e.pop(),r="".concat(e.join(", ")," and ").concat(n);return"This will withdraw all ".concat(r," from your account. ").concat(ub)},[t]);return(0,u.jsx)(ee,{type:"warning",showIcon:!0,message:(0,u.jsx)(uj,{className:"text-sm",children:n})})},uk=()=>(0,u.jsx)(uj,{className:"text-sm text-light",children:"Ensure this is an EVM-compatible address you can access on all relevant chains."}),uT=e=>{let{onNext:t,onCancel:n}=e,{selectedAgentConfig:r}=(0,k.S)();return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(uj,{children:"Your agent could have funds in external smart contracts. Withdrawing Pearl funds now means you won't be able to access those agent funds until a Pearl refund and agent rerun.\xa0Withdraw funds from your agent's profile first to ensure access."}),(0,u.jsxs)(x.Z,{vertical:!0,gap:8,children:[(0,u.jsx)(uh,{renderContainer:e=>{let{onClick:t}=e;return(0,u.jsx)(f.ZP,{disabled:!r.hasExternalFunds,onClick:t,type:"primary",className:"w-full",children:"Withdraw locked funds"})}}),(0,u.jsx)(f.ZP,{onClick:t,type:"primary",ghost:!0,children:"I have withdrawn my locked funds"}),(0,u.jsx)(f.ZP,{onClick:n,children:"Cancel"})]})]})},uC=e=>{let{isWithdrawing:t,onWithdraw:n,onClose:r}=e,{selectedAgentConfig:a}=(0,k.S)(),[s,i]=(0,p.useState)(""),[l,o]=(0,p.useState)(a.hasExternalFunds?uw.FUNDS_MAY_BE_LOCKED:uw.WITHDRAW_FUNDS),d=(0,p.useCallback)(()=>{l===uw.FUNDS_MAY_BE_LOCKED?o(uw.SHOW_BALANCES):l===uw.SHOW_BALANCES?o(uw.WITHDRAW_FUNDS):l===uw.WITHDRAW_FUNDS&&n(s)},[l,s,n]),c=(0,p.useCallback)(()=>{i(""),r()},[r]),h=(0,p.useMemo)(()=>l===uw.FUNDS_MAY_BE_LOCKED?"Part of funds may be locked":"Withdraw funds to user wallet",[l]),m=(0,p.useMemo)(()=>t?"Loading...":"Proceed",[t]);return(0,u.jsx)(nZ.Z,{title:h,onCancel:c,footer:null,width:400,open:!0,destroyOnClose:!0,children:(0,u.jsxs)(x.Z,{vertical:!0,gap:16,style:{marginTop:12},children:[l===uw.FUNDS_MAY_BE_LOCKED&&(0,u.jsx)(uT,{onNext:d,onCancel:c}),l===uw.SHOW_BALANCES&&(0,u.jsx)(uv,{onNext:d,onCancel:c}),l===uw.WITHDRAW_FUNDS&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(uS,{}),(0,u.jsxs)(x.Z,{vertical:!0,gap:8,children:[(0,u.jsx)(uj,{className:"text-sm text-light",children:"Withdrawal address"}),(0,u.jsx)(iQ.Z,{value:s,onChange:e=>i(e.target.value),placeholder:"0x...",size:"small",className:"text-base",style:{padding:"6px 12px"}})]}),(0,u.jsx)(uk,{}),(0,u.jsx)(f.ZP,{disabled:!s,loading:t,onClick:()=>n(s),block:!0,type:"primary",className:"text-base",children:m})]})]})})},{Text:uZ}=m.default,uE=()=>(0,u.jsxs)("div",{className:"mt-8",children:[(0,u.jsx)($.Z,{style:{color:P.r.TEXT_LIGHT}}),"\xa0",(0,u.jsx)(uZ,{className:"text-sm text-light",children:"Proceeding with withdrawal will stop your running agent."})]}),uN=()=>{let e=rs("withdraw-funds"),{selectedService:t,refetch:n}=(0,k.S)(),{refetch:r}=(0,eb.Q)(),{updateBalances:a}=(0,eo.AE)(),{service:s,isServiceRunning:i}=(0,ny.G)(null==t?void 0:t.service_config_id),{isServiceStakedForMinimumDuration:l,selectedStakingContractDetails:o}=(0,nL.S9)(),d=uc({currentStakingContractInfo:o}),[c,h]=(0,p.useState)(!1),[m,x]=(0,p.useState)(!1),g=(0,p.useCallback)(()=>{h(!0)},[]),y=(0,p.useCallback)(()=>{h(!1)},[]),v=(0,p.useCallback)(async()=>{try{await (null==n?void 0:n()),await (null==r?void 0:r()),await a()}catch(e){console.error("Failed to refetch details after withdrawal",e)}},[n,r,a]),j=(0,p.useCallback)(async e=>{if(e&&(null==t?void 0:t.service_config_id)){if(!(0,n2.isAddress)(e)){es.ZP.error("Please enter a valid address");return}x(!0),es.ZP.loading("Withdrawal pending. It may take a few minutes.");try{let n=await n8.ServicesService.withdrawBalance({withdrawAddress:e,serviceConfigId:t.service_config_id});n.error?es.ZP.error(n.error):(es.ZP.success("Transaction complete."),await v(),y())}catch(e){es.ZP.error("Failed to withdraw funds. Please try again."),console.error(e)}finally{x(!1)}}},[null==t?void 0:t.service_config_id,v,y]),b=(0,p.useMemo)(()=>e?l?null:"".concat("You have not reached the minimum duration of staking. Keep running your agent and you'll be able to withdraw in"," ").concat(d):"Available soon!",[d,l,e]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(tE.Z,{title:b?(0,u.jsx)(uZ,{className:"text-sm",children:b}):null,children:(0,u.jsx)(f.ZP,{onClick:g,disabled:!s||!l||!e,block:!0,size:"large",children:"Withdraw all funds"})}),!i&&(0,u.jsx)(uE,{}),c&&(0,u.jsx)(uC,{isWithdrawing:m,onClose:y,onWithdraw:j})]})};function uP(){let e=(0,H._)(["\n  .ant-card-body {\n    padding: 0;\n    img {\n      border-radius: 8px;\n    }\n  }\n"]);return uP=function(){return e},e}let uI=(0,U.ZP)(q.Z)(uP()),uM=e=>{let{address:t}=e,{middlewareChain:n}=c9();return(0,u.jsx)(x.Z,{vertical:!0,gap:8,children:(0,u.jsx)(lY,{list:[{left:"Wallet Address",leftClassName:"text-light text-sm",right:(0,u.jsx)(lZ.N,{address:t,middlewareChain:n}),rightClassName:"font-normal text-sm"}],parentStyle:c0})})},u_=e=>{let{serviceNftTokenId:t}=e,{middlewareChain:n,evmHomeChainId:r}=c9(),a=ut.q[r][un.R.ServiceRegistryL2].address;return(0,u.jsx)(uI,{children:(0,u.jsxs)(x.Z,{children:[(0,u.jsx)(x.Z,{children:(0,u.jsx)(v(),{width:78,height:78,alt:"NFT",src:"/NFT.png"})}),(0,u.jsxs)(x.Z,{style:{padding:"16px 12px"},align:"center",justify:"space-between",flex:1,children:[(0,u.jsxs)(x.Z,{vertical:!0,children:[(0,u.jsx)(c8,{}),(0,u.jsxs)("a",{href:"".concat(ea._B[n],"/token/").concat(a,"/instance/").concat(t),target:"_blank",children:[(0,rz.F)(a)," ",er.$.EXTERNAL_LINK]})]}),(0,u.jsxs)(x.Z,{vertical:!0,children:[(0,u.jsx)(c3,{}),(0,u.jsxs)("a",{href:"https://marketplace.olas.network/".concat((0,I.KP)(n).name,"/ai-agents/").concat(t),target:"_blank",children:[t," ",er.$.EXTERNAL_LINK]})]})]})]})})},uA=()=>{let{isLoaded:e}=(0,eo.AE)(),{selectedService:t}=(0,k.S)(),{serviceNftTokenId:n,serviceEoa:r}=(0,ny.G)(null==t?void 0:t.service_config_id),{serviceSafeErc20Balances:a,serviceEoaNativeBalance:s,serviceSafeNativeBalances:i,serviceSafeOlas:l}=(0,eo.Lz)(null==t?void 0:t.service_config_id),{serviceSafe:o,middlewareChain:d}=c9(),{availableRewardsForEpochEth:c,isEligibleForRewards:h,accruedServiceStakingRewards:m}=(0,ri.D)(),g=(0,p.useMemo)(()=>e?h?"~".concat((0,M.mT)(c,2)," OLAS"):"Not yet earned":(0,u.jsx)(eH.Z.Input,{size:"small",active:!0}),[e,h,c]),f=(0,p.useMemo)(()=>{var e;return[{title:"Claimed rewards",value:"".concat((0,M.mT)(null!==(e=null==l?void 0:l.balance)&&void 0!==e?e:0,2)," OLAS")},{title:"Unclaimed rewards",value:"".concat((0,M.mT)(m,2)," OLAS")},{title:"Current epoch rewards",value:g}]},[m,g,l]);return o?(0,u.jsx)(q.Z,{title:(0,u.jsx)(ud,{address:o.address}),children:(0,u.jsxs)(cJ,{children:[(0,u.jsx)(uM,{address:o.address}),!eh()(f)&&(0,u.jsxs)(x.Z,{vertical:!0,gap:8,children:[(0,u.jsx)(c5,{}),(0,u.jsx)(lY,{list:f.map(e=>({left:e.title,leftClassName:"text-light text-sm",right:e.value})),parentStyle:c0})]}),(!ex()(i)||!ex()(s))&&(0,u.jsxs)(x.Z,{vertical:!0,gap:8,children:[ue()(i)&&(0,u.jsx)(lY,{list:i.map(e=>{let{balance:t,symbol:n}=e;return{left:(0,u.jsx)("strong",{children:n}),leftClassName:"text-sm",right:"".concat((0,M.mT)(t,4)," ").concat(n)}}),parentStyle:c0}),ue()(a)&&(0,u.jsx)(lY,{list:a.map(e=>{let{balance:t,symbol:n}=e;return{left:(0,u.jsx)("strong",{children:n}),leftClassName:"text-sm",right:"".concat((0,M.mT)(t,4)," ").concat(n)}}),parentStyle:c0}),!ex()(r)&&(0,u.jsx)(lY,{list:[{left:r.address&&d&&(0,u.jsx)(c4,{signerAddress:r.address,middlewareChain:d}),leftClassName:"text-sm",right:"".concat((0,M.mT)(null==s?void 0:s.balance,4)," ").concat(null==s?void 0:s.symbol)}],parentStyle:c0})]}),n&&(0,n3.qV)(n)&&(0,u.jsx)(u_,{serviceNftTokenId:n})]})}):null},uL=()=>(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(uA,{}),(0,u.jsx)(uN,{})]}),{Text:uF}=m.default,uO={components:{Card:{paddingLG:16}}},uR=()=>{let{isMasterSafeLoading:e,masterSafeAddress:t,middlewareChain:n}=c9();return e?(0,u.jsx)(eH.Z,{}):(0,u.jsx)(x.Z,{vertical:!0,gap:8,children:(0,u.jsx)(lY,{list:[{left:"Address",leftClassName:"text-light",right:t&&(0,u.jsx)(lZ.N,{address:t,middlewareChain:n}),rightClassName:"font-normal"}],parentStyle:c0})})},uD=()=>{let{selectedAgentConfig:e}=(0,k.S)(),{totalStakedOlasBalance:t}=(0,eo.AE)(),{masterWalletBalances:n}=(0,eo.PU)(),{middlewareChain:r}=c9(),a=null==n?void 0:n.filter(t=>t.symbol===tS.W.OLAS&&e.requiresMasterSafesOn.includes(t.evmChainId)).reduce((e,t)=>e+t.balance,0),s=(0,p.useMemo)(()=>[{title:"Available",value:(0,M.mT)(null!=a?a:0,2)},{title:"Staked",value:(0,M.mT)(null!=t?t:0,2)}],[a,t]);return ex()(a)?(0,u.jsx)(eH.Z,{}):(0,u.jsxs)(x.Z,{vertical:!0,gap:8,children:[(0,u.jsxs)(uF,{strong:!0,children:[tS.W.OLAS," (",(0,I.KP)(r).displayName,")"]}),(0,u.jsx)(lY,{list:s.map(e=>({left:e.title,leftClassName:"text-light",right:"".concat(e.value," ").concat(tS.W.OLAS)})),parentStyle:c0})]})},uB=()=>{let{evmHomeChainId:e,masterSafeAddress:t,middlewareChain:n}=c9(),{masterSafeBalances:r}=(0,eo.PU)(),a=(0,tb.Ro)(e),s=(0,p.useMemo)(()=>{if(!ex()(t)&&!ex()(r))return r.filter(n=>{let{walletAddress:r,evmChainId:a,isNative:s,isWrappedToken:i}=n;return a===e&&s&&!i&&r===t}).reduce((e,t)=>{let{balance:n}=t;return e+n},0)},[r,t,e]);return(0,u.jsx)(x.Z,{vertical:!0,gap:8,children:(0,u.jsx)(lY,{list:[{left:(0,u.jsxs)(uF,{strong:!0,children:[a," (",(0,I.KP)(n).displayName,")"]}),leftClassName:"text-light",right:"".concat((0,M.mT)(s,4)," ").concat(a)}],parentStyle:c0})})},uz=()=>{let{evmHomeChainId:e,masterSafeAddress:t,middlewareChain:n}=c9(),{masterSafeBalances:r}=(0,eo.PU)(),a=(0,p.useMemo)(()=>{if(!ex()(t)&&!ex()(r))return r.filter(n=>{let{walletAddress:r,evmChainId:a,symbol:s,isNative:i,isWrappedToken:l}=n;return a===e&&!i&&!l&&s!==tS.W.OLAS&&r===t}).reduce((e,t)=>{let{balance:n,symbol:r}=t;return e[r]||(e[r]=0),e[r]+=n,e},{})},[r,t,e]);return a?(0,u.jsx)(x.Z,{vertical:!0,gap:8,children:Object.entries(a).map(e=>{let[t,r]=e;return(0,u.jsx)(lY,{list:[{left:(0,u.jsxs)(uF,{strong:!0,children:[t," (",(0,I.KP)(n).displayName,")"]}),leftClassName:"text-light",right:"".concat((0,M.mT)(r,2)," ").concat(t)}],parentStyle:c0},t)})}):null},uW=()=>{let{masterEoa:e}=(0,eb.Q)(),{masterEoaBalance:t}=(0,eo.PU)(),{evmHomeChainId:n,middlewareChain:r}=c9(),a=(0,tb.Ro)(n);return(0,u.jsx)(x.Z,{vertical:!0,gap:8,children:(0,u.jsx)(lY,{list:[{left:(null==e?void 0:e.address)&&r&&(0,u.jsx)(c4,{signerAddress:null==e?void 0:e.address,middlewareChain:r}),leftClassName:"text-light",right:"".concat((0,M.mT)(t,4)," ").concat(a)}],parentStyle:c0})})},uH=()=>{let e=rs("manage-wallet"),{selectedService:t}=(0,k.S)();return(0,u.jsx)(or.ZP,{theme:uO,children:(0,u.jsx)(G,{bordered:!1,title:(0,u.jsx)(B,{title:"Your wallets"}),extra:(0,u.jsx)(W,{}),children:e?(0,u.jsxs)(cJ,{style:{margin:8},children:[(0,u.jsx)(uR,{}),(0,u.jsx)(uD,{}),(0,u.jsx)(uB,{}),(0,u.jsx)(uz,{}),(0,u.jsx)(uW,{}),t&&(0,u.jsx)(uL,{})]}):(0,u.jsx)(cX,{})})})};function uq(){let{pageState:e,goto:t}=(0,S.a)(),n=(0,ei.Z)(),{hasEnoughNativeTokenForInitialFunding:r,hasEnoughOlasForInitialFunding:a,hasEnoughAdditionalTokensForInitialFunding:s,isInitialFunded:i}=n6(void 0);return(0,p.useEffect)(()=>{var e;function t(){let e=document.querySelector("body");if(e){var t;let r=e.scrollHeight;null==n||null===(t=n.setAppHeight)||void 0===t||t.call(n,Math.min(700,r))}}null==n||null===(e=n.setIsAppLoaded)||void 0===e||e.call(n,!0);let r=new ResizeObserver(t);return r.observe(document.body),t(),()=>{r.unobserve(document.body)}},[n]),(0,p.useEffect)(()=>{let n=!0===r&&!0===a&&!0===s;e!==b.i.SupafundDashboard||i||n||t(b.i.Main)},[e,t,r,a,s,i]),(0,p.useMemo)(()=>{switch(e){case b.i.Setup:return(0,u.jsx)(c$,{});case b.i.Main:return(0,u.jsx)(lC,{});case b.i.Settings:return(0,u.jsx)(oB,{});case b.i.HelpAndSupport:return(0,u.jsx)(ot,{});case b.i.ManageStaking:return(0,u.jsx)(l2,{});case b.i.ManageWallet:return(0,u.jsx)(uH,{});case b.i.RewardsHistory:return(0,u.jsx)(ok,{});case b.i.AddBackupWalletViaSafe:return(0,u.jsx)(l5,{});case b.i.AgentActivity:return(0,u.jsx)(nC,{});case b.i.UpdateAgentTemplate:return(0,u.jsx)(cK,{});case b.i.SupafundConfiguration:return(0,u.jsx)(lT,{});case b.i.SupafundDashboard:return(0,u.jsx)(iz,{});case b.i.SupafundMainSettings:return(0,u.jsx)(sD,{onNavigateToDashboard:()=>t(b.i.SupafundDashboard),showBackToMain:!0});case b.i.AddFundsToMasterSafeThroughBridge:return(0,u.jsx)(nd,{});case b.i.LowOperatingBalanceBridgeFunds:return(0,u.jsx)(nu,{});case b.i.LowSafeSignerBalanceBridgeFunds:return(0,u.jsx)(np,{});default:return(0,u.jsx)(lC,{})}},[e,t])}}},function(e){e.O(0,[130,20,584,888,774,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);